
$gradientDirectionWebkit: (
    'to bottom':       'top',
    'to top':          'bottom',
    'to right':        'left',
    'to left':         'right',
    'to bottom right': 'left top',
    'to bottom left':  'right top',
    'to top right':    'left bottom',
    'to top left':     'right bottom',
);


@mixin oj-webkit-linear-gradient($gradient) 
{
  $gradientDirection: null;

  $gradientToStartIndex: str_index($gradient, 'to ');
  $gradientWebkit: null;

  @if ($gradientToStartIndex != null)
  {

    $gradientToEndIndex: str_index($gradient, ',');
    $gradientDirection: str_slice($gradient, $gradientToStartIndex, $gradientToEndIndex - 1);


    $gradientWebkit: unquote("-webkit-" + str-slice($gradient, 0, $gradientToStartIndex - 1) + 
          map-get($gradientDirectionWebkit, $gradientDirection) + 
          str-slice($gradient, $gradientToEndIndex));

    //@debug($gradientWebkit);
  }

  // we only support prefixes that we require for our supported browsers
  // don't use ms- prefix: http://blogs.msdn.com/b/ie/archive/2012/06/06/moving-the-stable-web-forward-in-ie10-release-preview.aspx
  // See: http://www.css3files.com/gradient/
  // don't need -moz-linear-gradient, that's for FF 15 and older. 
  // don't need -webkit-gradient, use -webkit-linear-gradient

  background-image: $gradientWebkit;

}




//*****************************************************************************
//
// Usage Example:
//
//      .oj-foo .oj-binky {
//       
//        @include oj-background-image(linear-gradient(to bottom, $headerBgColor 0%,#f0f0f0 100%));
//      }
//
//*****************************************************************************

@mixin oj-background-image($bgImage)
{
  @if ($bgImage != null)
  {
    $linearIndex: str-index($bgImage, 'linear-gradient');

    @if ($linearIndex != null)
    {
      @include oj-webkit-linear-gradient($bgImage);
    }

    @if ($linearIndex == null or $gradientGeneration != none)
    {
      background-image: $bgImage; 
    }

    @if ($linearIndex != null and $gradientGeneration == slowOverride)
    {
      html.oj-slow-cssgradients & {
        background-image: none; 
      }
    }
  }
}
