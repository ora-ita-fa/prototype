define(['./DvtToolkit'], function() {
  // Internal use only.  All APIs and functionality are subject to change at any time.
    // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  D.Qb=(0,D.z)();(0,D.ta)("DvtLegend",D.Qb);D.F.o(D.Qb,D.Rb,"DvtLegend");D.ya=function(b,c,d){var e=new D.Qb;e.Init(b,c,d);return e};D.Qb.newInstance=D.ya;D.Qb.getDefaults=function(b){return(0,D.Sb)(new D.Tb,b)};D.Qb.prototype.Init=function(b,c,d){D.Qb.q.Init.call(this,b,c,d);this.setId("legend1000"+window.Math.floor(1E9*window.Math.random()));this.hf=new D.Tb;this.Ga=new D.Ub(this);this.Ga.bf(this);this.Bh=[];this.xT=[];this.Pa=D.r};
D.Qb.prototype.te=function(b){b?this.W=this.hf.sg(b):this.W||(this.W=(0,D.Vb)(this))};D.Qb.prototype.yz=function(b,c,d){this.te(b);this.Fa().isLayout=D.o;b=D.Wb.L(this,new D.I(0,0,c,d));this.Fa().isLayout=D.u;return b};D.Qb.prototype.L=function(b,c,d){this.te(b);this.Fa().isLayout=D.u;this.Qi();D.Wb.L(this,new D.I(0,0,c,d))};D.Qb.prototype.render=D.Qb.prototype.L;D.Qb.prototype.Hm=function(b){(0,D.Xb)(b,this.Bh)};D.Qb.prototype.highlight=D.Qb.prototype.Hm;D.E=D.Qb.prototype;
D.E.Pf=function(b,c){var d=b.Ba();if("categoryRollOver"==d||"categoryRollOut"==d){"dim"==this.Fa().hoverBehavior&&(0,D.Ob)(b,this.Bh);for(var e=0;e<this.xT.length;e++)for(var f=this.xT[e],g=b.km,g=g[0]?g[0]:g,h=0;h<f.Bh.length;h++){var k=f.Bh[h];if(k&&k.Og&&-1<D.Ib.Ea(k.Og(),g)){f.scrollIntoView(h);break}}}(this==c||"showPopup"==d||"hidePopup"==d)&&this.ib(b)};D.E.Fa=(0,D.C)("W");D.E.Sa=(0,D.C)("Ga");D.E.EZ=function(b){this.Bh.push(b)};
D.E.V=function(){this.Ga&&(this.Ga.Es(this),this.Ga.V(),this.Ga=D.r);D.Qb.q.V.call(this)};D.E.FZ=(0,D.B)("Pa");D.E.Eq=function(){return new D.Yb(this)};D.Qb.prototype.getAutomation=D.Qb.prototype.Eq;
D.Zb={};(0,D.ta)("DvtLegendConstants",D.Zb);D.F.o(D.Zb,D.F,"DvtLegendConstants");D.Zb.JD="background";D.Zb.BACKGROUND=D.Zb.JD;D.Zb.VD="legendItem";D.Zb.LEGEND_ITEM=D.Zb.VD;D.Zb.yp="title";D.Zb.TITLE=D.Zb.yp;
D.Yb=function(b){this.Ua=b;this.sd=this.Ua.Fa()};(0,D.ta)("DvtLegendAutomation",D.Yb);D.F.o(D.Yb,D.qn,"DvtLegendAutomation");D.Yb.prototype.qx=function(b){if((b=(0,D.Ac)(this.Ua.Sa(),b))&&b instanceof D.Lv)if(b=b.getData(),b=(0,D.Mv)(this,b,this.sd))return"item"+b;return D.r};
D.Mv=function(b,c,d){if(d.sections&&0<d.sections.length){for(var e=0;e<d.sections.length;e++){var f=(0,D.Mv)(b,c,d.sections[e]);if(f)return"["+e+"]"+f}return D.r}if(d.items&&0<d.items.length){for(b=0;b<d.items.length;b++)if(d.items[b]==c)return"["+b+"]";return D.r}};
D.Nv=function(b,c,d){if(d.sections&&0<d.sections.length){for(var e=0;e<d.sections.length;e++){var f=(0,D.Nv)(b,c,d.sections[e]);if(f)return"["+e+"]"+f}return D.r}if(d.items&&0<d.items.length){for(b=0;b<d.items.length;b++)if(d.items[b].text==c.name)return"["+b+"]";return D.r}};D.Ov=function(b,c,d){var e=d.indexOf("["),f=d.indexOf("]");if(0<=e&&0<=f)return e=d.substring(e+1,f),d=d.substring(f+1),f=d.indexOf("]"),0<=d.indexOf("[")&&0<=f?(0,D.Ov)(b,c.sections[e],d):c.items[e]};
D.Yb.prototype.ns=function(b){b=(0,D.Ov)(this,this.sd,b);for(var c=this.Ua.Bh,d=0;d<c.length;d++){var e=c[d].getData();if(b==e)return c[d].Ie()[0].Da()}return D.r};D.Yb.prototype.getDomElementForSubId=D.Yb.prototype.ns;
D.Tb=function(){this.Init({skyros:D.Qv,alta:D.Rv})};D.F.o(D.Tb,D.Mg,"DvtLegendDefaults");D.Rv={skin:"alta",textStyle:new D.P("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"),titleStyle:new D.P("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 11px; color: #333333;"),colors:D.sl};
D.Qv={skin:"skyros",orientation:"vertical",position:D.r,backgroundColor:D.r,borderColor:D.r,textStyle:new D.P("font-size: 11px; color: #333333;"),titleStyle:new D.P("font-size: 12px; color: #003d5b;"),titleHalign:"start",hideAndShowBehavior:"none",hoverBehavior:"none",scrolling:"asNeeded",colors:D.rl,markerShape:"square",lineWidth:3,layout:{gapRatio:1,outerGapWidth:3,outerGapHeight:3,titleGap:3,markerSize:10,markerGap:5,rowGap:0,columnGap:8,sectionGap:6},isLayout:D.u};
D.Jv=function(b,c){return window.Math.ceil(c*b.layout.gapRatio)};
D.Ub=function(b){this.Init(b.e,b.Pf,b);this.Ua=b};D.F.o(D.Ub,D.xc,"DvtLegendEventManager");D.E=D.Ub.prototype;D.E.Qs=function(b,c){var d=D.r;c instanceof D.pc&&c.Ol()!=D.r?d=c.Ol():c instanceof D.Lv&&(d=c.getId(),d={type:D.Zb.VD,id:d});this.Yg(new D.xo(b,d),this.Ua)};D.E.zg=function(b){D.Ub.q.zg.call(this,b);var c=(0,D.Ac)(this,b.target);if(c){var d=this.fT(c),c=(0,D.Pv)(this,c);(d||c)&&b.stopPropagation()}};
D.E.fo=function(b){D.Ub.q.fo.call(this,b);var c=(0,D.Ac)(this,b.target);c&&this.$y(c,D.o)&&b.stopPropagation()};D.E.gk=function(b){D.Ub.q.gk.call(this,b);var c=(0,D.Ac)(this,b.target);c&&this.$y(c,D.u)&&b.stopPropagation()};D.E.bv=function(b){var c=(0,D.Ac)(this,b.target);if(c){b=b.Roa;var d=this.fT(c),c=(0,D.Pv)(this,c);(d||c)&&b&&b.preventDefault()}};D.E.WX=function(b){var c=(0,D.Ac)(this,b.target);this.$y(c,D.o)&&b.stopPropagation()};
D.E.UX=function(b){var c=(0,D.Ac)(this,b.target);this.$y(c,D.u)&&b.stopPropagation()};D.E.RO=function(b){var c=(0,D.Ac)(this,b.target);this.$y(c,D.o)&&b.stopPropagation()};D.E.VX=function(b){var c=(0,D.Ac)(this,b.target);this.$y(c,D.u)&&b.stopPropagation()};
D.E.fT=function(b){if("none"==this.Ua.Fa().hideAndShowBehavior)return D.u;var c=b.Og?b.Og():D.r;if(!c||0>=c.length)return D.u;for(var d=b.Ie(),e=0;e<d.length;e++){var f=d[e];f instanceof D.Kb&&f.tD(b.Lb())}c=c[0];b=b.getData();"hidden"==b.categoryVisibility?(b.categoryVisibility="visible",this.Yg(new D.wo(D.wo.fE,c),this.Ua)):(b.categoryVisibility="hidden",this.Yg(new D.wo(D.wo.Ex,c),this.Ua));return D.o};D.Pv=function(b,c){return c&&c.Hw&&c.fg?(b.Yg(new D.Dm("action",c.fg,c.getId()),b.Ua),D.o):D.u};
D.Ub.prototype.$y=function(b,c){if("none"==this.Ua.Fa().hoverBehavior)return D.u;var d=b&&b.Og?b.Og():D.r;if(!d||0>=d.length)return D.u;this.Yg(new D.Mb(c?"categoryRollOver":"categoryRollOut",d[0]),this.Ua);return D.o};
D.Lv=function(b,c,d,e){this.Init(b,c,d,e)};D.F.o(D.Lv,D.F,"DvtLegendObjPeer");D.Lv.prototype.Init=function(b,c,d,e){this.Ua=b;this.Vh=c;this.Dga=d;this.Qa=d.id?d.id:d.text;this.fg=d.action;this.iAa=d._spb;this.Se=e;if(this.fg)for(b=0;b<this.Vh.length;b++)this.Vh[b].setCursor("pointer")};D.Kv=function(b,c,d,e){if(!b||!d)return D.r;d=new D.Lv(c,b,d,e);c.EZ(d);for(e=0;e<b.length;e++)c.Sa().ma(b[e],d);return d};D.E=D.Lv.prototype;D.E.getData=(0,D.C)("Dga");D.E.Lb=function(){return this.Dga.color};
D.E.getId=(0,D.C)("Qa");D.E.Ie=(0,D.C)("Vh");D.E.Og=function(){return[this.Qa]};D.E.fe=(0,D.C)("Se");D.E.Hw=(0,D.C)("fg");D.E.yd=(0,D.C)("iAa");
D.Wb={};D.F.o(D.Wb,D.F,"DvtLegendRenderer");D.Wb.Wba=10;D.Wb.Nsa=5;D.Wb.Osa=2;D.Wb.Lsa=6;
D.Wb.L=function(b,c){var d=b.Fa(),e=(0,D.Jv)(d,d.layout.outerGapWidth),f=(0,D.Jv)(d,d.layout.outerGapHeight),g=new D.I(c.x+e,c.y+f,c.g-2*e,c.j-2*f);b.FZ(g.clone());if(0>=g.g)return new D.kl(0,0);var h;d.isLayout||(h=D.Wb.c0(b,c));var k="vertical"==d.orientation?D.u:D.o,m=D.Wb.lT(b,d.title,g,D.r);g.y+=m.j;g.j-=window.Math.floor(m.j);var p=D.Wb.Mwa(b),q="off"!==d.scrolling,g=k?D.Wb.tza(b,g,p):D.Wb.Lza(b,g,p,q),k=(0,D.wb)(m,g);if(0>=b.xT.length){for(p=new D.H(b.e);0<b.Aa();)p.k(b.ca(0));b.k(p);p.F((c.g-
k.g)/2-k.x)}h&&b.Ha(h,0);return d.isLayout?new D.kl(window.Math.max(m.g,g.g)+2*e,k.j+2*f):new D.kl(k.g+2*e,k.j+2*f)};D.Wb.c0=function(b,c){var d=b.Fa(),e;d.backgroundColor&&(e=e?e:new D.td(b.e,c.x,c.y,c.g,c.j),e.na(d.backgroundColor));d.borderColor&&(e=e?e:new D.td(b.e,c.x,c.y,c.g,c.j),e.Ma(d.borderColor),(0,D.ic)(e));e&&b.Sa().ma(e,new D.pc(D.r,D.r,D.r,{type:D.Zb.JD,id:D.n}));return e};
D.Wb.lT=function(b,c,d,e){var f=b.Fa();if(!c)return new D.I(d.x,d.y,0,0);c=new D.nc(b.e,c,d.x,d.y);var g=e&&e.titleStyle?new D.P(e.titleStyle):f.titleStyle;c.Ia(g);if(D.oc.Vb(c,d.g,d.j,b)){b.Sa().ma(c,new D.pc(c.Uo,D.r,D.r,{type:D.Zb.yp,id:D.n}));var g=c.Ub(),h=(0,D.Jv)(f,f.layout.titleGap);f.isLayout?b.removeChild(c):(0,D.ro)(d,e&&e.titleHalign?e.titleHalign:f.titleHalign,c,g.g);g.j+=h;return g}return new D.I(d.x,d.y,0,0)};
D.Wb.vR=function(b,c){var d=b.sections;c.push(b);if(d)for(var e=0;e<d.length;e++)D.Wb.vR(d[e],c)};D.Wb.Lza=function(b,c,d,e){for(var f=b.Fa(),g=D.Wb.Nua(b,c,d,e),h=[],k=0;k<f.sections.length;k++)D.Wb.vR(f.sections[k],h);var m=h.length,f=(0,D.Jv)(f,f.layout.sectionGap);c=c.clone();for(var p=D.r,q,k=0;k<h.length;k++)c.j=g[k],q=D.Wb.OL(b,h[k],k,c,d,e),k!=m-1&&h[k].items&&(c.y+=q.j+f),p=p?(0,D.wb)(p,q):q;return p};
D.Wb.tza=function(b,c,d){for(var e=b.Fa(),f=D.J.S(b.e),g=0,h=[],k=0;k<e.sections.length;k++)D.Wb.vR(e.sections[k],h);for(var m=h.length,p=0,k=0;k<h.length;k++)h[k].items&&(p+=h[k].items.length);var q=(0,D.Jv)(e,e.layout.sectionGap),t=c.g-q*(m-1),v,w;if(e.sections)for(var A=0,D$=0,k=0;k<m;k++)e=c.clone(),(v=h[k].items)?(v=window.Math.round(v.length/p*t),e.g=v,e.x=f?c.x+c.g-g-e.g:c.x+g,0<A&&(e.y+=D$,e.j-=D$),v=D.Wb.OL(b,h[k],k,e,d,D.u),0<A&&(e.j+=D$,A--),g+=v.g,k!=m-1&&(g+=q)):(e.g=c.g-g,e.x=f?c.x:
c.x+g,v=D.Wb.OL(b,h[k],k,e,d,D.u),D$=v.j,A=h[k].sections.length),w=w?(0,D.wb)(w,v):v;return w};
D.Wb.OL=function(b,c,d,e,f,g){if(c){var h=e.clone(),k=b.Fa(),m=b.e,p=h.y,q=k.layout.markerSize,t=(0,D.Jv)(k,k.layout.markerGap),v=(0,D.Jv)(k,k.layout.rowGap),w=(0,D.Jv)(k,k.layout.columnGap),A=D.Wb.lT(b,c.title,h,c);h.y+=A.j;if(c.items){h.j-=A.j;var p=p+A.j,D$=D.Wb.Oua(b,h,f,c.items,g),K=D$.numCols,G=D$.numRows,M=D$.width;h.j=window.Math.ceil(window.Math.min(h.j,G*(f+v)-v)+A.j);h.g=M*K+w*(K-1);if(k.isLayout){if(1==G){for(d=e=0;d<c.items.length;d++)g=c.items[d],M=window.Math.ceil(D.Wb.dF(b,g.text)),
e+=M+q+t+w;h.g=e-w}return h}if(0==G||0==K)return h;var O=D.r,T=b,Q=G*(f+v)-v+A.j,D$=c.items.length;"vertical"===k.orientation&&(g&&Q>h.j)&&(T=D.Wb.lva(b,m,h,d),O=D.Wb.rva(b,m,h,T,Q,D$),b.xT.push(O));var Q=M-q-t,V=D.J.S(b.e),aa=0,oa=1;if(1==G){for(d=O=0;d<D$;d++)g=c.items[d],M=window.Math.ceil(D.Wb.dF(b,g.text)),M<Q&&(O+=Q-M);for(d=0;d<D$;d++){g=c.items[d];var sa=V?h.x+h.g-q:h.x,ra=V?h.x+h.g-q-t:h.x+q+t,Za=D.Wb.vea(b,sa,h.y,f,q,g,d),Ra=g.text,M=window.Math.ceil(D.Wb.dF(b,g.text)),db=D.r;Ra&&(M<Q?db=
D.Wb.f0(b,m,h,Q,Ra,k.textStyle):(db=D.Wb.f0(b,m,h,Q+O,Ra,k.textStyle),db!=D.r&&(M=window.Math.ceil(D.Wb.dF(b,db.oe())),O-=Q-M)),M=db!=D.r?window.Math.ceil(D.Wb.dF(b,db.oe())):0,db&&(db.fa(ra),db.ua(h.y+f/2),V&&db.Fi()));b.k(Za);M=M+q+t;sa=window.Math.min(sa,ra);ra=oa==K?M:M+w;sa=new D.td(m,sa,h.y,ra,f);(0,D.vd)(sa);T.k(sa);ra=db!=D.r?db.Uo:D.r;db=(0,D.Kv)([sa,Za,db],b,g,ra);"hidden"==g.categoryVisibility&&db&&Za.tD(db.Lb());h.y+=f+v;aa++;aa===G&&oa!==K&&(h.y=p,V?h.g-=M+w:h.x+=M+w,aa=0,oa++)}}else for(d=
0;d<D$;d++){g=c.items[d];sa=V?h.x+h.g-q:h.x;ra=V?h.x+h.g-q-t:h.x+q+t;Za=D.Wb.vea(b,sa,h.y,f,q,g,d);Ra=g.text;db=D.r;if(Ra&&(db=D.Wb.f0(T,m,h,Q,Ra,k.textStyle)))db.fa(ra),db.ua(h.y+f/2),V&&db.Fi();T.k(Za);sa=window.Math.min(sa,ra);ra=oa==K?M:M+w;sa=new D.td(m,sa,h.y,ra,f);(0,D.vd)(sa);T.k(sa);ra=db!=D.r?db.Uo:D.r;db=(0,D.Kv)([sa,Za,db],b,g,ra);O&&db instanceof D.Lv&&O.EZ(db);"hidden"==g.categoryVisibility&&db&&Za.tD(db.Lb());h.y+=f+v;aa++;aa===G&&oa!==K&&(h.y=p,V?h.g-=M+w:h.x+=M+w,aa=0,oa++)}h.y=p+
h.j-A.height;return new D.I(e.x,p-A.height,e.g,h.j)}h.j=A.j}};
D.Wb.Nua=function(b,c,d,e){var f=b.Fa(),g=f.isLayout;f.isLayout=D.o;for(var h=0,k=0,m=c.x,p=c.y,q=[],t=0;t<f.sections.length;t++)D.Wb.vR(f.sections[t],q);for(var v=q.length,w=(0,D.Jv)(f,f.layout.sectionGap),A=c.j-w*(v-1),D$=c.g,K=[],G,t=0;t<v;t++)c.j=A,c.g=D$,G=D.Wb.OL(b,q[t],t,c,d,e),K[t]=G.j;window.arSectionSpaceNeeded=[];window.extraSpace=window.numShortSections=0;G=A/v;for(t=0;t<v;t++)A=K[t]-G,0>=A?(window.arSectionSpaceNeeded[t]=0,window.extraSpace-=A):(K[t]=G,window.arSectionSpaceNeeded[t]=
A,window.numShortSections++);for(;0<window.extraSpace&&0<window.numShortSections;){G=window.extraSpace/window.numShortSections;for(t=0;t<v;t++)0<window.arSectionSpaceNeeded[t]&&(A=window.arSectionSpaceNeeded[t]-G,0>=A?(K[t]+=window.arSectionSpaceNeeded[t],window.arSectionSpaceNeeded[t]=0,window.extraSpace-=G+A,window.numShortSections--):(K[t]+=G,window.extraSpace-=G,window.arSectionSpaceNeeded[t]=A))}c.x=m;c.y=p;c.g=D$;for(t=0;t<v;t++)c.j=K[t],D.Wb.OL(b,q[t],t,c,d,e),c.x=m,k=window.Math.max(c.g,k),
h+=c.j,t!=v-1&&(c.y=c.j+p+w,h+=w);c.g=k;c.j=h;c.x=m;c.y=p;f.isLayout=g;return K};
D.Wb.Oua=function(b,c,d,e,f){for(var g=b.Fa(),h=0,k=0;k<e.length;k++){var m=D.Wb.dF(b,e[k].text);m>h&&(h=m)}b=g.layout.markerSize;var p=(0,D.Jv)(g,g.layout.markerGap),k=(0,D.Jv)(g,g.layout.rowGap),m=(0,D.Jv)(g,g.layout.columnGap),h=g.isLayout?window.Math.ceil(b+p+h):c.g;"vertical"==g.orientation?f?(g=1,f=e.length):(f=window.Math.min(window.Math.floor((c.j+k)/(d+k)),e.length),g=window.Math.ceil(e.length/f)):(g=window.Math.min(window.Math.floor(c.g/h),e.length),f=window.Math.ceil(((h+m)*e.length-m)/
c.g),f*(d+k)-k>c.j&&(f=window.Math.floor(window.Math.ceil(c.j+k)/(d+k)),g=window.Math.ceil(e.length/f)));c=window.Math.min(h,(c.g-m*(g-1))/g);return c<b?{width:0,height:0,numCols:0,numRows:0}:{width:c,numCols:g,numRows:f}};D.Wb.Mwa=function(b){var c=b.Fa();b=new D.nc(b.e,"Test");b.Ia(c.textStyle);b.Fe();b=D.oc.ak(b);return window.Math.ceil(window.Math.max(b.j,c.layout.markerSize))};D.Wb.dF=function(b,c){var d=b.Fa(),e=new D.nc(b.e,c);e.Ia(d.textStyle);return e.Ub().g};
D.Wb.f0=function(b,c,d,e,f,g){c=new D.nc(c,f);c.Fe();c.Ia(g);return c=D.oc.Vb(c,e,d.j,b)?c:D.r};
D.Wb.vea=function(b,c,d,e,f,g,h){var k=b.Fa();g.markerShape||(g.markerShape=k.markerShape);if(!g.color){var m=k.colors;g.color=m[h%m.length]}g.lineWidth||(g.lineWidth=k.lineWidth);"line"==g.type?(g.lineWidth=window.Math.min(g.lineWidth,D.Wb.Nsa),f=D.Wb.wea(b.e,c,d,e,g)):"lineWithMarker"==g.type?(g.lineWidth=window.Math.min(g.lineWidth,D.Wb.Osa),f=D.Wb.wea(b.e,c,d,e,g),"hidden"!=g.categoryVisibility&&f.k(D.Wb.yea(b,c,d,e,D.Wb.Lsa,g))):f=D.Wb.yea(b,c,d,e,f,g);return f};
D.Wb.yea=function(b,c,d,e,f,g){var h=b.e,k=b.Fa();b=g.markerShape;var m=g.markerColor?g.markerColor:g.color,p=g.pattern;d+=(e-f)/2;c="lineWithMarker"==g.type?c+(D.Wb.Wba-f)/2:c;p?(f=new D.Kb(h,b,k.skin,0,0,f,f),f.G(new D.wc(p,m,"#FFFFFF")),(0,D.Xa)(f,c,d)):(f=new D.Kb(h,b,k.skin,c,d,f,f),f.na(m));g.borderColor&&f.Ma(g.borderColor,D.r,g._borderWidth?g._borderWidth:1);"square"==b&&(0,D.ic)(f);return f};
D.Wb.wea=function(b,c,d,e,f){d+=e/2;b=new D.hc(b,c,d,c+D.Wb.Wba,d);c=new D.Ud(f.color,1,f.lineWidth);f=f.lineStyle;"dashed"==f?c.Ti((0,D.mi)(f),"4,2,4"):"dotted"==f&&c.Ti((0,D.mi)(f),"2");b.Y(c);(0,D.ic)(b);return b};D.Wb.lva=function(b,c,d,e){var f=[d.x,d.y,d.x+d.g,d.y+d.j];d=d.clone();e=b.getId()+"_"+e;c=new D.Pg(c,"legendHandler",f,d,e);b.k(c);return c};D.Wb.rva=function(b,c,d,e,f,g){c=new D.ih(c,d.x,d.y,d.g,d.j,f,e,g);c.eI(b.Sa().Ql());b.k(c);e.L();return c};
});