define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojvalidation","ojs/ojpopup"],function(b,e){b.hb=function(a){this.Init(a)};b.Ja.uu(b.Ja.jd.Rm,b.hb);b.a.fa(b.hb,b.Qa,"oj.PopupMessagingStrategy");b.hb.$m={ojRadioset:{open:"focusin mouseover",close:"mouseout"},ojCheckboxset:{open:"focusin mouseover",close:"mouseout"},"default":{open:"focusin"}};b.hb.prototype.Init=function(a){b.hb.j.Init.call(this,a)};b.hb.prototype.Zg=function(a,d,c){b.hb.j.Zg.call(this,a,d,c);this.PK();this.update(c)};b.hb.prototype.update=
function(a){b.hb.j.update.call(this,a)};b.hb.prototype.eh=function(a){var d=b.hb.$m[this.Cb.widgetName]||b.hb.$m["default"];d.open&&this.bb.off(d.open,this.fA);d.close&&this.bb.off(d.close,this.xx);this.rI();b.hb.j.eh.call(this,a)};b.hb.prototype.fA=function(a){a=a.data&&a.data.strategy;var b=a.nH();a.ps()&&b&&(a.Ie.empty(),a.Ie.append(b),a.Ie.ojPopup("open",a.bb))};b.hb.prototype.xx=function(a){a=a.data&&a.data.strategy;a.Ie.ojPopup("close",a.bb)};b.hb.prototype.PK=function(){if(!this.ps()){var a=
this.bb,d=b.hb.$m[this.Cb.widgetName]||b.hb.$m["default"];this.Ie=e("\x3cdiv class\x3d'oj-messaging-popup-container'\x3e\x3c/div\x3e");e("body").append(this.Ie);this.Ie.ojPopup({initialFocus:"none",tail:"simple",autoDismiss:"focusLoss",position:{my:"start bottom",at:"end top",collision:"flipfit"}});if(d.open)a.on(d.open,{strategy:this},this.fA);if(d.close)a.on(d.close,{strategy:this},this.xx)}};b.hb.prototype.rI=function(){this.ps()&&this.Ie&&(this.Ie.ojPopup("destroy"),this.Ie.remove())};b.hb.prototype.nH=
function(){var a="",b=this.Cb.document[0],c=[],f=!1,h=this;this.VE()&&c.push(this.mH());(this.Yp()||this.cv())&&c.push(this.lH(b));this.XE()&&c.push(this.qH(b));e.each(c,function(c,e){e&&(f?a=a.concat(h.GJ(b)):f=!0,a=a.concat(e))});return a};b.hb.prototype.mH=function(){var a,d="",c,f,h,e,k;f=this.Uu();var l,m={};a=[];if(this.Xu()){a=this.Vu();for(c=0;c<a.length;c++)k=a[c],k=k instanceof b.C?k:new b.C(k.summary,k.detail,k.severity),e=b.C.Xj(k.severity),m[e]||(m[e]=[]),m[e].push(k);for(c=f;c>=b.C.Ha.CONFIRMATION;c--)for(a=
m[c]||[],f=0;f<a.length;f++)k=a[f],b.f.Fb(k,b.C),e=b.C.Xj(k.severity),h=this.IJ(e),l=k.summary||h,k=k.detail||"",d=d.concat("\x3cdiv class\x3d'oj-message'\x3e").concat("\x3cspan class\x3d'"+this.HJ(e)+"' title\x3d'"+h+"' role\x3d'img'\x3e\x3c/span\x3e").concat("\x3cspan class\x3d'oj-message-content'\x3e").concat("\x3cdiv class\x3d'oj-message-summary'\x3e"+l+"\x3c/div\x3e"),k&&(d=d.concat("\x3cdiv class\x3d'oj-message-detail'\x3e"+k+"\x3c/div\x3e")),d=d.concat("\x3c/div\x3e")}return d};b.hb.prototype.lH=
function(a){var b=[],c,f;this.Yp()&&(b=b.concat(this.Tu()));this.cv()&&(b=b.concat(this.HE()));if(b&&0<b.length)for(c=e(a.createElement("div")),c.addClass("oj-form-control-hint"),f=0;f<b.length;f++)c.append(this.Iy(a,b[f]));return c?c.get(0).outerHTML:""};b.hb.prototype.qH=function(a){var b=this.GE(),c;b&&(c=e(a.createElement("div")),c.addClass("oj-form-control-title"),c.append(this.Iy(a,b)));return c?c.get(0).outerHTML:""};b.hb.prototype.Iy=function(a,d){var c=null;b.xa.HP(d)?c=b.xa.yO(d.substring(6,
d.length-7)):(c=e(a.createElement("div")),c.text(d),c=c.get(0));return c};b.hb.prototype.GJ=function(a){return(a=e(a.createElement("hr")))?a.get(0).outerHTML:""};b.hb.prototype.IJ=function(a){var d;switch(a){case b.C.Ha.FATAL:d=b.L.q("oj-message.fatal");break;case b.C.Ha.ERROR:d=b.L.q("oj-message.error");break;case b.C.Ha.WARNING:d=b.L.q("oj-message.warning");break;case b.C.Ha.INFO:d=b.L.q("oj-message.info");break;case b.C.Ha.CONFIRMATION:d=b.L.q("oj-message.confirmation")}return d};b.hb.prototype.HJ=
function(a){var d;switch(a){case b.C.Ha.FATAL:d="oj-message-error-icon";break;case b.C.Ha.ERROR:d="oj-message-error-icon";break;case b.C.Ha.WARNING:d="oj-message-warning-icon";break;case b.C.Ha.INFO:d="oj-message-info-icon";break;case b.C.Ha.CONFIRMATION:d="oj-message-confirmation-icon"}return"oj-widget-icon "+d};b.hb.prototype.ps=function(){return this.Ie?this.Ie.is(":oj-popup"):!1};b.cS=e.widget("oj.editableValue",e.oj.baseComponent,{widgetEventPrefix:"oj",options:{converter:void 0,disabled:void 0,
help:{definition:null,source:null},messages:void 0,messagingDisplayOptions:void 0,required:void 0,title:void 0,placeholder:void 0,validators:void 0,value:void 0,optionChange:void 0},option:function(a,b){var c,f,h,g=!1,k,l=!1;c=!1;var m=!0,n=!1;if("string"===typeof a&&void 0!==b)switch(a){case "value":g=!0;f=this.options.value;break;case "messages":l=!0;h=this.options.messages||[];break;case "messagingDisplayOptions":e.extend({},this.options.messagingDisplayOptions);break;case "placeholder":n=!0}else"object"===
typeof a&&a&&(void 0!==a.value&&(g=!0,f=this.options.value,c=!0),void 0!==a.messages&&(l=!0,h=this.options.messages,c=!0),a.messagingDisplayOptions&&e.extend({},this.options.messagingDisplayOptions),a.placeholder&&(n=!0,m=a._oj_messaging_update?!1:!0,delete a._oj_messaging_update),c&&(k=a._oj_originalEvent,delete a._oj_originalEvent));c=this._superApply(arguments);g&&(g=this.options.value,this.sq(f,g)||this.rq("value",f,k||null));l&&(this.zL(h,this.options.messages)||this.rq("messages",h,k||null));
n&&(m?(this.un=!0,this.Co()):this.un=!1);return c},isValid:o_c("Fh"),refresh:function(){this._super();this.Yx(!0)},validate:function(a){this.Zx(this.options.value,void 0,a?this.Nf.av:this.Nf.Um);return this.isValid()?!0:!1},Nf:{Ru:1,Um:2,av:3,NONE:4},Ic:function(){var a=this.element,b=this.cn(a);this._super();"boolean"===typeof this.options.disabled&&a.prop("disabled",this.options.disabled);this.options.placeholder&&(this.un=!0);e.each(["required","title"],function(c,f){f in b&&a.removeAttr(f)})},
xh:function(){this._super();this.QH();this.Yx(!1);this.Co();this.rq("messages",this.options.messages,null);this.widget().addClass("oj-form-control")},_destroy:function(){var a=this.widget();this.tx(void 0,!0);this.Mh().eh(this.Ph());e.each(this.pn,function(){a.removeClass(this.toString())});a.removeClass("oj-form-control");this.element.removeAttr("aria-required");this.vb&&this.vb._ojLabel("destroy");return this._super()},_setOption:function(a,d){var c=this._superApply(arguments),f=!0,h;h=0;switch(a){case "converter":this.uq=
null;this.Mh().update(this.Ph(this.Qd.Pu));break;case "validators":this.vk();f=!1;break;case "messages":(h=d&&0!==d.length)?(this.Qi=0,h=this.qJ(),this.Fh=h>=b.C.Ha.ERROR?!1:!0):(this.Qi=0,this.Fh=!0);this.Mh().update(this.Ph());break;case "messagingDisplayOptions":this.XQ=null;this.Co();break;case "placeholder":this._SetPlaceholder(d);f=!1;break;case "title":this.Mh().update(this.Ph(this.Qd.dv))}f&&(this.mq(a,d),this.zA(a,d),this.HA(a,d));return c},Lf:o_c("element"),oF:function(){var a=this.ty(this.element);
if(null!==a&&0!==a.length)return a;a=this.element.prop("id");if(void 0!==a&&(a=e("label[for\x3d'"+a+"']"),0!==a.length))return a;a=this.element.closest("[aria-labelledby]");return 0!==a.length&&(a=this.ty(a),null!==a&&0!==a.length)?a:null},Ji:function(){return this.element.val()},_GetMessagingLauncherElement:function(){return this.Lf()},Bd:function(){this.uq||(this.uq=b.Ec.getConverterInstance(this.options.converter));return this.uq||null},bn:function(){this.uw||(this.uw={});return this.uw},Ah:function(){return this.Lf().val()},
tv:function(){if(!this.zk){var a=[],d=this.options.validators,c,f=!0,h=this.bn(),g=[],k,l;for(l in h)h.hasOwnProperty(l)&&g.push(h[l]);a=a.concat(g);if(d){g=[];for(l=0;l<d.length;l++)c=d[l],"object"===typeof c?(c.validate&&"function"===typeof c.validate||(f=!1),f||(k=c.type)&&"string"===typeof k&&((h=b.R.rg(k))?(c=e.extend({},c.options)||{},c.converter=c.converter||this.Bd(),c.label=c.label||this.Lr(),c=h.createValidator(c)):b.F.error("Unable to locate a validatorFactory for the requested type: "+
k)),g.push(c)):b.F.error("Unable to parse the validator provided:"+c);a=a.concat(g)}this.zk=a}return this.zk||[]},vk:function(){this.zk&&(this.zk.length=0);this.zk=null;this.Mh().update(this.Ph(this.Qd.ev))},Bv:function(){return"required"===this.options.required},en:function(a){var b=this.Ah();this.Ne(b,a)},mq:function(a,b,c){switch(a){case "converter":b=this.options.value;this.BA(b,!0);break;case "value":this.BA(b,c);break;case "required":this.vb&&this.vb._ojLabel("option","required",b);break;case "help":a=
this.options.help.definition,b=this.options.help.source,c=this.Nw(b),this.vb&&(this.vb._ojLabel("option","describedById",c),this.vb._ojLabel("option","help",{definition:a,source:b}))}},nq:function(a){var b=this.Lf();(a="required"==a?!0:!1)&&b?b.attr("aria-required",a):b.removeAttr("aria-required")},Ch:function(a){this.Lf().val(a)},Ne:function(a,d,c){var f=this.options.value,h=!0;if(void 0===a)return b.F.warn("Attempt to set a value of undefined"),!1;if(this.pv()){c=c&&c.Mu?c.Mu:this.Nf.Ru;if(h=c!==
this.Nf.NONE)if(a!==this.ww){if(this.vB(a),this.tx(d),a=this.Zx(a,d,c),!this.isValid())return!1}else return b.F.zp>b.F.vh&&b.F.info("Validation was skipped because the display value "+a.toString?a.toString():a+" as the previous."),!1;this.sq(f,a)?(this.cC(a,d),b.F.zp>b.F.vh&&b.F.info("The value was not set on the component as it's the same as the current value - "+a.toString?a.toString():a)):this.bO(a,d)}return!0},pv:function(){return this.options.disabled?!1:!0},_SetPlaceholder:function(a){this.Lf().attr("placeholder",
a)},rq:function(a,d,c){b.f.rC(a,"");d={option:a,previousValue:d,value:this.options[a],optionMetadata:{writeback:"shouldWrite"}};switch(a){case "messages":this._trigger("optionChange",c||null,d);this.Mh().update(this.Ph());break;case "value":this._trigger("optionChange",c||null,d)}},sq:function(a,d){return b.a.compareValues(a,d)},_GetDefaultStyleClass:o_d("oj-editablevalue"),pn:{disabled:"oj-disabled",required:"oj-required",readOnly:"oj-read-only"},Qd:{jk:1,fv:2,Pu:3,ev:4,dv:5},tx:function(a,b){if(b)this.options.messages=
[];else{var c={messages:[]};a&&(c._oj_originalEvent=a);this.option(c)}},Mf:function(){var a=this.element,b=this.cn(a),c;this._super();void 0===this.options.disabled&&(this.options.disabled=void 0!==this.element.attr("disabled")?!!this.element.prop("disabled"):null);this.nt("disabled");void 0===this.options.placeholder&&(this.options.placeholder=this.element.prop("placeholder"));this.options.placeholder&&(this.un=!0);void 0===this.options.required&&(c=void 0!==this.element.attr("required")?!!this.element.prop("required"):
null,this.options.required=c?"required":"optional");this.nt("required");void 0===this.options.title&&(this.options.title=this.element.prop("title"));void 0===this.options.value&&(this.options.value=void 0!==this.element.attr("value")?this.element.val():null);this.options.messages||(this.options.messages=[]);e.each(["required","title"],function(c,h){h in b&&a.removeAttr(h)})},Yx:function(a){if(a=a||!1)this.vb&&this.vb._ojLabel("refresh"),this.gw(),this.Co();this.mq("value",this.options.value,a);this.zA("required",
this.options.required);this.HA("required",this.options.required)},lR:o_c("xw"),kR:o_c("ww"),ty:function(a){a=a.attr("aria-labelledby");return void 0!==a?e("label[id\x3d'"+a+"']"):null},QH:function(){if(this.vb=this.oF()){var a=this.options.help.definition,b=this.options.help.source,c=this.Nw(b);this.vb._ojLabel({rootAttributes:{"class":this._GetDefaultStyleClass()+"-label"},describedById:c,required:this.options.required,help:{definition:a,source:b}})}},Nw:function(a){var b=this.element.prop("id")+
"Icons";a&&this.Lf().each(function(){var a=e(this).attr("aria-describedby");a?e(this).attr("aria-describedby",a+" "+b):e(this).attr("aria-describedby",b)});return b},Lr:function(){if(this.vb)return this.vb.text()},qJ:function(){this.Qi||(this.Qi=b.C.Xl(this.options.messages));return this.Qi},OJ:function(){if(this.wq){var a=e.extend([],this.options.messages);this.wq.update(this.Fh,a,this.Qi)}else"undefined"===typeof this.Fh&&(this.Fh=!0),this.wq=new b.tg(this.Fh,this.options.messages,this.Qi);return this.wq},
Co:function(){var a=this.Mh(),b=this._GetMessagingLauncherElement(),c=this.Ph(this.Qd.jk);this.un||(this.options.placeholder="");a.Zg(b,c)},nN:o_b("xw"),vB:o_b("ww"),$N:function(a,d){var c=this.options.messages.slice(),f={};b.f.Fb(a,b.C);c.push(a);f.messages=c;d&&(f._oj_originalEvent=d);this.option(f)},bO:function(a,b){var c={};c.value=a;b&&(c._oj_originalEvent=b);this.option(c)},nt:function(a){var b=this.options[a],c=!1;switch(a){case "required":b?(b=""+b,"required"!==b&&"optional"!==b&&(c=!0)):
this.options[a]="optional";break;case "disabled":null!==b&&"boolean"!==typeof b&&(c=!0)}if(c)throw"Option '"+a+" 'has an invalid value set: "+b;},Zx:function(a,b,c){var f=a;try{c===this.Nf.Ru&&(f=this.jA(a)),this.fO(f,c===this.Nf.av)}catch(h){this.sA(h,b)}return f},QI:function(a){var d=a,c=this.Bd();c&&"object"===typeof c&&(c.format&&"function"===typeof c.format?d=c.format(a):b.F.zp>b.F.vh&&b.F.info("converter does not support the format method."));return d},Mh:function(){this.rw||(this.rw=new b.Ja(this));
return this.rw},Dy:function(){var a;this.tw={label:this.Lr()};return(a=b.R.rg(b.Rb.VALIDATOR_TYPE_REQUIRED))?a.createValidator(this.tw):null},iJ:function(a){var b,c=[];b="";var f;this.Bv()&&(b=this.jz(a),b||(b=this.Dy(),b.getHint&&"function"===typeof b.getHint&&(b=b.getHint())&&c.push(b)));for(f=0;f<a.length;f++)b=a[f],"object"===typeof b&&b.getHint&&"function"===typeof b.getHint&&(b=b.getHint())&&c.push(b);return c},Ph:function(a){var b={},c=this.Bd(),f=[];a=a||this.Qd.fv;if(a===this.Qd.jk||a===
this.Qd.fv)b.validityState=this.OJ();(a===this.Qd.jk||a===this.Qd.Pu)&&(c&&"object"===typeof c&&c.getHint&&"function"===typeof c.getHint)&&(c=c.getHint()||"",b.converterHint=c);if(a===this.Qd.jk||a===this.Qd.ev)c=this.tv(),f=this.iJ(c)||[],b.validatorHint=f;if(a===this.Qd.jk||a===this.Qd.dv)b.title=this.options.title||"";return b},jz:function(a){var d=null,c,f=null;for(c=0;c<a.length;c++)if(d=a[c],d instanceof b.vc){f=d;break}return f},zL:function(a,d){var c=-1,f,h=!0,g=e.extend([],a),k=e.extend([],
d);if(g===k)return!0;if(null==g||null==k||g.length!==k.length)return!1;e.each(g,function(a,d){f=d instanceof b.C?d:new b.C(d.summary,d.detail,d.severity);c=-1;e.each(k,function(a,b){f.Tj(b)&&(c=a)});-1<c?k.splice(c,1):h=!1});return h},jA:function(a){var d=this.Bd(),c=a;d&&"object"===typeof d&&(d.parse&&"function"===typeof d.parse?c=d.parse(a):b.F.zp>b.F.vh&&b.F.info("converter does not support the parse method."));return c},sA:function(a,d){var c,f,h,e={};a instanceof b.Rc||a instanceof b.Nd?(c=a.Vj(),
b.f.Fb(c,b.C),h=c.severity,f=c.summary,c=c.detail):(h=b.C.Ha.ERROR,f=b.L.q("oj-message.error"),c=a.message||b.L.q("oj-converter.detail"));e.summary=f;e.severity=h;e.detail=c;this.$N(e,d)},zA:function(a,b){this.Lf();switch(a){case "required":this.nq(b)}},BA:function(a,b){var c=a||this.options.value,f;f=this.xw;(b||c!==f)&&this.cC(c)},gw:function(){this.tw={};this.vk()},HA:function(a,b){this.pn.hasOwnProperty(a)&&("required"!==a?this.widget().toggleClass(this.pn[a],!!b):this.widget().toggleClass(this.pn[a],
"required"===b))},cC:function(a,b){var c;this.nN(a);c=a;try{c=this.QI(a)}catch(f){this.sA(f,b)}this.Ch(c);this.vB(this.Ah())},RR:o_a(),fO:function(a,d){if(this.Fh){var c=this.tv(),f,h,e=!1;this.Bv()&&((f=this.jz(c))||(f=this.Dy()),f.validate(a),e=!0);if(!d)for(h=0;h<c.length;h++)f=c[h],"object"===typeof f&&(f.validate&&"function"===typeof f.validate?f instanceof b.vc&&e||f.validate(a):b.F.zp>b.F.vh&&b.F.info("validator does not support the validate method."))}}});b.Components.dE({editableValue:{messagingDisplayOptions:b.Components.BC(function(){return{messages:["notewindow"],
converterHint:["placeholder","notewindow"],validatorHint:["notewindow"],title:["notewindow"]}})}});b.ta("oj._ojLabel",e.oj.baseComponent,{version:"1.0.0",defaultElement:"\x3clabel\x3e",widgetEventPrefix:"oj",options:{describedById:null,help:{definition:null,source:null},required:null,rootAttributes:void 0},Aa:{CG:"tooltipHelp",EG:"tooltipRequired"},widget:o_c("Di"),refresh:function(){this._super();this.EA();this.CA()},_create:function(){this._super();this.rr()},rr:function(){this.Di=this.element.wrap(this.UN()).closest(".oj-component");
this.JL();if(this.options.help.definition||this.options.help.source)this.vz(),this.zw();"required"===this.options.required&&this.element.before(this.ZA())},JL:function(){var a=this.element.attr("class");this.nu=[];if(a)for(var a=a.split(/\s+/),b=a.length,c=0;c<b;c++){var f=a[c];0<f.indexOf("-label")&&(this.Di.addClass(f),this.element.removeClass(f),this.nu.push(f))}},UN:function(){var a;this.options.rootAttributes&&(a=this.options.rootAttributes["class"]);return null!==a?"\x3cdiv class\x3d'oj-label oj-component "+
a+"'\x3e\x3cdiv class\x3d'oj-label-group'\x3e\x3c/div\x3e\x3c/div\x3e":"\x3cdiv class\x3d'oj-label oj-component'\x3e\x3cdiv class\x3d'oj-label-group'\x3e\x3c/div\x3e\x3c/div\x3e"},ZA:function(){return"\x3cspan class\x3d'oj-label-required-icon oj-component-icon' title\x3d'"+this.q(this.Aa.EG)+"'\x3e\x3c/span\x3e"},GK:function(a,b,c){if(b){var f;f="\x3cspan id\x3d'"+c+"'\x3e"+("\x3ca href\x3d'"+b+"' target\x3d'_blank'\x3e\x3cspan class\x3d");f+="'oj-label-help-icon oj-component-icon oj-clickable-icon' title\x3d'";
a||(a=this.q(this.Aa.CG));f+=a;f+="' role\x3d'img'\x3e\x3c/span\x3e";f+="\x3c/a\x3e\x3c/span\x3e"}return f},zw:function(){var a=this.options.help.definition;if(a){this.element.addClass("oj-label-help-def");var b=this.element.attr("title");b?this.element.attr("title",b+" "+a):this.element.attr("title",a)}},QA:function(){this.element.removeClass("oj-label-help-def");this.element.attr("title","")},vz:function(){var a=this.options.help.source;if(a){var b=this.options.help.definition;this.Di.find(".oj-label-group").prepend(this.GK(b,
a,this.options.describedById))}},CA:function(){null!==this.options.describedById&&this.Di.find("#"+this.options.describedById).remove();this.QA();this.vz();this.zw()},EA:function(){"required"===this.options.required?0===this.Di.find(".oj-label-required-icon").length&&this.element.before(this.ZA()):this.Di.find(".oj-label-required-icon").remove()},_setOption:function(a,b){this._super(a,b);"required"===a&&this.EA();"help"===a&&this.CA()},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:
null;a=a.subId;return"oj-label-help-icon"===a?this.widget().find(".oj-label-help-icon")[0]:"oj-label-help-icon-anchor"===a?this.widget().find(".oj-label-help-icon").parent()[0]:"oj-label-required-icon"===a?this.widget().find(".oj-label-required-icon")[0]:null},_destroy:function(){this._super();for(var a=0;a<this.nu.length;a++)this.element.addClass(this.nu[a]);this.QA();this.Di.replaceWith(this.element)}})});
//# sourceMappingURL=oj-modular.map