define(["ojs/ojcore","jquery","knockout"],function(b,e,a){function d(a,b){var c={};c.value=b.value;return c}function c(a,b){var c={},d=b.optionMetadata;d&&"shouldWrite"===d.writeback&&(c[b.option]=b.value);return c}function f(){this.Init()}function h(a,b,c){this.Init(a,b,c)}function g(b,c){return function(d){var f,e;f=d.parentElement;e=b.createChildContext(d.data,null,function(a){a.$key=d.key;a.$metadata=d.metadata;a.$headerContext=d});a.renderTemplate(c,e,null,f);return null}}function k(b,c){return function(d){var f,
e;f=d.parentElement;e=b.createChildContext(d.data,null,function(a){a.$keys=d.keys;a.$metadata=d.metadata;a.$cellContext=d});a.renderTemplate(c,e,null,f);return null}}function l(b,c,d){var f={};(function(c,d){f=function(f){var e=null,h=null;"header"==d?(e=b.extend({$column:f.column,$headerContext:f.headerContext}),h=f.headerContext.parentElement):"cell"==d&&(e=b.createChildContext(f.row,null,function(a){a.$column=f.column;a.$cellContext=f.cellContext}),h=f.cellContext.parentElement);"footer"==d&&(e=
b.extend({$column:f.column,$footerContext:f.footerContext}),h=f.footerContext.parentElement);a.renderTemplate(c,e,null,h,"replaceNode")}})(d,c);return f}function m(b,c){return function(d){var f=b.createChildContext(d.row,null,function(a){a.$rowContext=d.rowContext});a.renderTemplate(c,f,null,d.rowContext.parentElement,"replaceNode")}}b.T=function(a,b){this.Init(a,b)};o_("ComponentBinding",b.T,b);b.a.fa(b.T,b.a,"oj.ComponentBinding");b.T.create=function(c,d){if(null==c)throw"Binding name is required!";
var f=new b.T(c,d),e=a.bindingHandlers,h,g=Array.isArray(c)?c:[c];for(h=0;h<g.length;h++)e[g[h]]=f;return f};o_("ComponentBinding.create",b.T.create,b);b.T.Nc=function(){return b.T.uF};o_("ComponentBinding.getDefaultInstance",b.T.Nc,b);b.T.prototype.Qc=function(a){var c=a["for"],c=null==c?"@global":c;b.F.option("level")>=b.F.Pm&&this.Lo[c]&&b.F.error("Managed Attributes for '%s' are redefined",c);this.Lo[c]=a};b.a.b("ComponentBinding.prototype.setupManagedAttributes",{Qc:b.T.prototype.Qc});b.T.Et=
function(){b.T.hx.Et()};o_("ComponentBinding.deliverChanges",b.T.Et,b);b.T.prototype.Init=function(a,c){b.T.j.Init.call(this);"string"===typeof c&&(c={componentName:c});this.Eq=c||{};this.jH=Array.isArray(a)?a:[a];this.init=b.a.Ul(this,this._init);this.update=b.a.Ul(this,this.XN);this.Lo={}};b.T.lq="_ojNeedsJUIBInit";b.T.prototype._init=function(c,d,f,h,g){a.applyBindingsToDescendants(g,c);e(c).data(b.T.lq,!0);return{controlsDescendantBindings:!0}};b.T.prototype.XN=function(a,c,d,f,h){f=e(a);f.data(b.T.lq)&&
(f.data(b.T.lq,null),this.pz(a,f,c,d,h))};b.T.prototype.pz=function(f,e,g,p,m){var k=g(),l=null,y=!1,w=[],z=null,x=null,B=b.T.TI(this.jH,f,m),t=0,C={},A=this.Eq.componentName;if(null==A){l="component";if(!B[l]&&(l="role",!B[l])){b.F.error("component attribute is required for the ojComponent binding");return}var M=k[l];if(null==M){b.F.error("non-null component attribute is required for the ojComponent binding");return}a.computed(function(){b.T.ur(B[l],l,C,m);if(0==t)A=a.utils.unwrapObservable(M);else{y=
!0;B=null;b.T.WN(e);if(x){z.JC();z=null;var c=this.Eq.beforeDestroy;c&&c(f,x,g,p,m);x("destroy");x=null;for(c=0;c<w.length;c++)w[c].JC();w=null}this.pz(f,e,g,p,m)}return null},this,{disposeWhenNodeIsRemoved:f})}if(null!=A)if(x=e[A],"function"===typeof x){var x=x.bind(e),E=b.T.bB(this.Lo,B,A),I=b.T.Nc();this!==I&&(I=I.nJ(B,A),b.ac.vf(I,E),E=I);var G={},z=new h(x,f,b.T.hx),I={"^slider$":[{event:"slidechange",getter:d}],"^oj*":[{event:"ojoptionchange",getter:c}]},K=function(){var a=this.lM,c=B[a];c&&
b.T.ur(c,a,C,m);if(0===t){var d=b.T.fp(k[a]);null!=E[a]?(c=E[a].wP,null!=c&&(a=c(a,d,f,x,g,p,m)||{},b.ac.vf(G,a))):G[a]=d}else if(!y)if(c=b.T.fp(g()[a]),null!=E[a]){var e=E[a].update;if(null!=e)for(d in a=e(a,c,f,x,g,p,m)||{},a)a.hasOwnProperty(d)&&z.lC(d,a[d])}else z.lC(a,c);return null},H;for(H in k)k.hasOwnProperty(H)&&H!==l&&w.push(a.computed(K,{lM:H},{disposeWhenNodeIsRemoved:f}));b.T.CM(e,A,I,g,B,z,m);x(G);(H=this.Eq.afterCreate)&&H(f,x,g,p,m);G=null}else b.F.error("Component %s is not found",
A);t=1};b.T.TI=function(b,c,d){var f={},e=null,e=a.bindingProvider.instance,h;h=null;var g,e=e.YO?e.YO(c,d):c.getAttribute("data-bind");if(!e)return f;c=a.jsonExpressionRewriting.parseObjectLiteral(e);d=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;for(e=0;e<c.length;e+=1){g=c[e];var m=g.key.replace(d,"");if(0<=b.indexOf(m)){h=g.value;break}}if(!h)return f;c=a.jsonExpressionRewriting.parseObjectLiteral(h);for(b=0;b<c.length;b+=1)h=c[b],f[h.key.replace(d,"")]=h.value.replace(d,"");return f};b.T.ur=function(a,b,c,
d){var f=c[b];void 0===f&&("string"!==typeof a&&(a=a()),f=null,null!==a&&(f=new Function("$context","with($context){with($data||{}){return "+a+";}}")),c[b]=f);return f?f(d):null};b.T.prototype.nJ=function(a,c){return b.T.bB(this.Lo,a,c)};b.T.bB=function(a,b,c){function d(b){b=a[b];if(null!=b){e.push(b);b=b.use;var c;if(null!=b)for(b=Array.isArray(b)?b:[b],c=0;c<b.length;c++)d(b[c])}}var f={},e=[];d(c);c=a["@global"];var h;c&&e.push(c);if(0<e.length)for(h in b)if(b.hasOwnProperty(h))for(c=0;c<e.length;c++){var g=
e[c],m=g.attributes;if(null!=m&&0<=m.indexOf(h)){f[h]={wP:g.init,update:g.update};break}}return f};b.T.vv=".ojWriteback";b.T.WN=function(a){a&&a.off(b.T.vv)};b.T.CM=function(a,c,d,f,e,h,g){var m={},k;for(k in d)if(c.match(k)){c=d[k];for(d=0;d<c.length;d++)k=c[d],a.on(k.event+b.T.vv,{pP:k.getter},function(a,c){a.stopPropagation();var d=a.data.pP(a,c);h.xQ();try{for(var k in d)b.T.iO(k,f()[k],d[k],e[k],g,m)}finally{h.iQ()}});break}};b.T.AJ=function(a){var b=["true","false","null","undefined"];if(null==
a||0<=b.indexOf(a))return null;b=a.match(/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i);return null===b?null:"function(v){"+(b[1]?"Object("+b[1]+")"+b[2]:a)+"\x3dv;}"};b.T.iO=function(c,d,f,e,h,g){null!=d&&a.isObservable(d)?a.isWriteableObservable(d)&&d(f):(c=b.T.ur(function(){return b.T.AJ(e)},c,g,h))&&c(f)};b.T.fp=function(c){c=a.utils.unwrapObservable(c);(Array.isArray(c)||b.ac.isPlainObject(c))&&c.ojConvertToJS&&(c=a.toJS(c));return c};b.a.fa(f,b.a,"ComponentBinding.GlobalChangeQueue");
f.prototype.Init=function(){f.j.Init.call(this);this.Ih=[]};f.prototype.dQ=function(a){-1===this.Ih.indexOf(a)&&(this.Ih.push(a),this.Tn||(this.Tn=setTimeout(b.a.Ul(this,this.Rx),1)))};f.prototype.eQ=function(a){a=this.Ih.indexOf(a);0<=a&&this.Ih.splice(a,1)};f.prototype.Et=function(){this.Tn&&clearTimeout(this.Tn);this.Rx()};f.prototype.Rx=function(){var a;this.Tn=null;try{for(a=0;a<this.Ih.length;a+=1)this.Ih[a]()}finally{this.Ih=[]}};b.a.fa(h,b.a,"ComponentBinding.ComponentChangeTracker");h.prototype.Init=
function(a,c,d){h.j.Init.call(this);this.Cb=a;this.yI=c;this.vA=d;this.bC=b.a.Ul(this,this.$G);this.Pq={};this.Gj=0};h.prototype.lC=function(a,b){this.fL()||this.tI||(this.Pq[a]=b,this.vA.dQ(this.bC))};h.prototype.JC=function(){this.vA.eQ(this.bC);this.tI=!0};h.prototype.iQ=function(){b.f.assert(0<this.Gj,"ComponentChangeTracker._suspendCount underflow");this.Gj-=1};h.prototype.xQ=function(){this.Gj-=1};h.prototype.fL=function(){return 1<=this.Gj};h.prototype.$G=function(){try{null!=b.Components.Vt(this.yI)&&
this.Cb("option",this.Pq)}finally{this.Pq={}}};b.T.hx=new f;b.T.uF=b.T.create(["ojComponent","jqueryUI"]);b.gu={};o_("koStringTemplateEngine",b.gu,b);b.gu.BP=function(){function b(a){this.Hj=a;this.text=function(a){if(!a)return c[this.Hj];c[this.Hj]=a};this.data=function(a,b){d[this.Hj]||(d[this.Hj]={});if(1===arguments.length)return d[this.Hj][a];d[this.Hj][a]=b}}var c={},d={},f=new a.nativeTemplateEngine;f.makeTemplateSource=function(c,d){if("string"==typeof c){d=d||document;var f=d.getElementById(c);
return f?new a.templateSources.domElement(f):new b(c)}if(c&&1==c.nodeType||8==c.nodeType)return new a.templateSources.anonymousTemplate(c)};a.templates=c;a.setTemplateEngine(f)};o_("koStringTemplateEngine.install",b.gu.BP,b);b.T.Nc().Qc({attributes:["header","cell"],init:function(a,b,c,d,f,e,h){"header"===a?(a=b.row,null!=a&&(c=a.template,null!=c&&(a.renderer=g(h,c))),a=b.column,null!=a&&(c=a.template,null!=c&&(a.renderer=g(h,c))),d({header:b})):"cell"===a&&(a=b.template,null!=a&&(b.renderer=k(h,
a)),d({cell:b}))},update:function(a,b,c,d,f,e,h){return"header"===a?(a=b.row,null!=a&&(c=a.template,null!=c&&(a.renderer=g(h,c))),a=b.column,null!=a&&(c=a.template,null!=c&&(a.renderer=g(h,c))),{header:b}):"cell"===a?(a=b.template,null!=a&&(b.renderer=k(h,a)),{cell:b}):null},"for":"ojDataGrid"});a.bindingHandlers.ojContextMenu={update:function(b,c){e(b).off(".ojContextMenu");var d=a.utils.unwrapObservable(c());"string"!==e.type(d)&&(d=b.getAttribute("contextmenu"))&&(d="#"+d);d&&(d=e(d).data("oj-ojMenu"));
if(d){var f=e(b);f.on("keydown.ojContextMenu contextmenu.ojContextMenu",function(a){return"contextmenu"===a.type||121==a.which&&a.shiftKey?(d.show(a,{launcher:f,focus:"menu"}),!1):!0})}}};b.T.Nc().Qc({attributes:["columns","columnsDefault","rowTemplate"],init:function(a,b,c,d,f,e,h){if("columns"==a||"columnsDefault"==a){var g;for(c=0;c<b.length;c++){var k=b[c];f=k.template;e=k.footerTemplate;g=k.headerTemplate;null!=f&&(k.renderer=l(h,"cell",f));null!=e&&(k.footerRenderer=l(h,"footer",e));null!=g&&
(k.headerRenderer=l(h,"header",g))}"columns"==a?d({columns:b}):d({columnsDefault:b})}else"rowTemplate"==a&&d({rowRenderer:m(h,b)})},update:function(a,b,c,d,f,e,h){if("columns"==a||"columnsDefault"==a){var g;for(c=0;c<b.length;c++){var k=b[c];f=k.template;e=k.footerTemplate;g=k.headerTemplate;null!=f&&(k.renderer=l(h,"cell",f));null!=e&&(k.footerRenderer=l(h,"footer",e));null!=g&&(k.headerRenderer=l(h,"header",g))}"columns"==a?d({columns:b}):d({columnsDefault:b})}else if("rowTemplate"==a)return{rowRenderer:m(h,
b)};return null},"for":"ojTable"})});
//# sourceMappingURL=oj-modular.map