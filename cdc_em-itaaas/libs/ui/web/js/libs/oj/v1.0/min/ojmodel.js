define(["ojs/ojcore","jquery"],function(b,e){b.N=window.oj.Events={on:function(a,b,c){return this.Kf(a,b,c,!1,!1)},off:function(a,b,c){return this.Fs(a,b,c,!1)},trigger:function(a){var d=Array.prototype.slice.call(arguments);d.unshift(!1);return b.N.pb.apply(this,d)},once:function(a,b,c){return this.dA(a,b,c,!1)},listenTo:function(a,d,c){var f,h,g,e,l={};d.constructor===String?l[d]=c:l=d;for(e in l)if(l.hasOwnProperty(e))for(d=b.N.Nh(e),c=0;c<d.length;c+=1)f=d[c].event,h=d[c].qb,g={event:f,qb:h,object:a,
Gb:l[e]},this.Rq(this.xb,g,b.N.Jz),f=h?f+":"+h:f,void 0===this.xb&&(this.xb=[]),this.xb.push(g),a.Kf(f,l[e],null,!0,!1);return this},listenToOnce:function(a,d,c){var f,h,g,e,l={};d.constructor===String?l[d]=c:l=d;for(e in l)if(l.hasOwnProperty(e))for(d=b.N.Nh(e),c=0;c<d.length;c+=1)f=d[c].event,h=d[c].qb,g={event:f,qb:h,object:a,Gb:l[e]},this.Rq(this.xb,g,b.N.Jz),f=h?f+":"+h:f,void 0===this.xb&&(this.xb=[]),this.xb.push(g),a.dA(f,l[e],null,!0);return this},stopListening:function(a,d,c){var f,h={},
g,e,l,m,n,q,r,p,s;if(null==arguments||0==arguments.length){n=this.xb?this.xb.length:0;for(p=0;p<n;p++)q=this.xb[p].object.Fs,q.apply(this.xb[p].object,[this.xb[p].event,this.xb[p].Gb,this.xb[p].context,!0]);this.xb=[];return this}f=d;a&&a.constructor===String&&(f=a);f.constructor===String?h[f]=c:h=f;for(s in h)if(h.hasOwnProperty(s))for(f=b.N.Nh(s),g=0;g<f.length;g+=1)for(e=f[g].event,l=f[g].qb,n=this.xb?this.xb.length:0,p=n-1;0<=p;p-=1)m=this.xb[p],n=a?a===m.object:!0,q=e?e===m.event:!0,r=c?h[s]===
m.Gb:!0,m=l?l===m.qb:!0,n&&(q&&r&&m)&&(q=this.xb[p].object.Fs,q.apply(this.xb[p].object,[this.xb[p].event,this.xb[p].Gb,this.xb[p].context,!0]),this.xb.splice(p,1));return this}};b.N.bind=b.N.on;b.N.unbind=b.N.off;b.N.l={ADD:"add",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",SORT:"sort",CHANGE:"change",DESTROY:"destroy",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",ALL:"all"};o_("Events.EventType",b.N.l,b);b.N.Qm=function(a,b){var c,f=b||this;for(c in f)"function"===typeof f[c]&&
(a[c]=f[c]);a.Hb={};a.xb=[]};b.N.dA=function(a,b,c,f){var h,g,e,l;e=this.Gr(a,b);for(l in e)if(e.hasOwnProperty(l))for(a=this.Nh(l),b=0;b<a.length;b+=1)h=a[b].event,g=a[b].qb,void 0===this.Hb&&(this.Hb=[]),void 0===this.Hb[h]&&(this.Hb[h]=[]),this.Hb[h].push({Gb:e[l],context:c,qb:g,mg:!0,fired:!1,jh:f});return this};b.N.FB=function(a){return a.mg?a.fired?!1:a.fired=!0:!0};b.N.pb=function(a,d){var c=this.Nh(d),f,h,g,e,l,m;e=[];for(f=0;f<c.length;f+=1)h=c[f].event,g=c[f].qb,e.push({event:h,qb:g});for(f=
0;f<e.length;f+=1){l=this.mo(this.Hb,b.N.l.ALL);c=b.N.mo(this.Hb,e[f].event,!1);for(h=0;h<(c?c.length:0);h+=1)c[h].qb===e[f].qb&&c[h].Gb&&(g=Array.prototype.slice.call(arguments),c&&(c[h]&&c[h].mg)&&this.PA(b.N.mo(this.Hb,e[f].event,!0),c[h]),c&&(c[h]&&this.FB(c[h]))&&(m=c[h].Gb,a&&!c[h].wD||m.apply(c[h].context||this,g.slice(2))));for(h=0;h<(l?l.length:0);h+=1)g=Array.prototype.slice.call(arguments),0<g.length&&(g[1]=e[f].qb?e[f].event+":"+e[f].qb:e[f].event),l&&(l[h]&&l[h].Gb&&this.FB(l[h]))&&(m=
l[h].Gb,a&&!l[h].wD||m.apply(l[h].context||this,g.slice(1))),l&&(l[h]&&l[h].mg)&&this.PA(this.mo(this.Hb,b.N.l.ALL,!0),l[h])}return this};b.N.Kf=function(a,d,c,f,h){var g,e,l,m;a=this.Gr(a,d);for(g in a)if(a.hasOwnProperty(g))for(d=this.Nh(g),e=0;e<d.length;e+=1)l=d[e].event,m=d[e].qb,void 0===this.Hb&&(this.Hb=[]),void 0===this.Hb[l]&&(this.Hb[l]=[]),m={Gb:a[g],context:c,qb:m,jh:f,wD:h},-1===this.Rq(this.Hb[l],m,b.N.DK)&&this.Hb[l].push(m);return this};b.N.Fs=function(a,b,c,f){var h,g;if(null==arguments||
0==arguments.length)return this.Hb={},this;if(null==a)return this.OA(a,b,c,f),this;h=this.Gr(a,b);for(g in h)h.hasOwnProperty(g)&&this.OA(g,h[g],c,f);return this};b.N.Gr=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};b.N.OA=function(a,d,c,f){var h=[],g,e,l,m,n,q,r,p;if(a)h=b.N.Nh(a);else if(void 0!==this.Hb)for(e in this.Hb)this.Hb.hasOwnProperty(e)&&h.push({event:e});for(a=0;a<h.length;a+=1)if(e=h[a].event,l=h[a].qb,void 0!==this.Hb&&this.Hb[e]instanceof Array){m=this.Hb[e];for(g=
m.length-1;0<=g;g-=1)n=void 0===d||null===d||m[g].Gb==d,q=void 0===c||null===c||m[g].context==c,r=void 0===l||null===l||m[g].qb==l,p=void 0===f||null===f||m[g].jh==f,n&&(q&&r&&p)&&m.splice(g,1);0===m.length&&delete this.Hb[e]}};b.N.PA=function(a,b){var c,f,h,g,e,l;for(c=a.length-1;0<=c;c-=1)f=void 0===b.Gb||null===b.Gb||a[c].Gb==b.Gb,h=void 0===b.context||null===b.context||a[c].context==b.context,g=void 0===b.qb||null===b.qb||a[c].qb==b.qb,e=void 0===b.jh||null===b.jh||a[c].jh==b.jh,l=void 0===b.mg||
null===b.mg||a[c].mg==b.mg,f&&(h&&g&&e&&l)&&a.splice(c,1)};b.N.Nh=function(a){a=a?a.split(" "):[];var b=[],c,f,h;for(c=0;c<a.length;c+=1)f=a[c].split(":"),h=f[0],f=1<f.length?f[1]:null,b.push({event:h,qb:f});return b};b.N.DK=function(a,b){return a.Gb===b.Gb&&a.qb===b.qb&&a.context===b.context&&a.jh===b.jh&&a.mg===b.mg};b.N.Jz=function(a,b){return a.event===b.event&&a.qb===b.qb&&a.context===b.context&&a.object===b.object};b.N.Rq=function(a,b,c){var f;if(void 0===a)return-1;for(f=0;f<a.length;f+=1)if(c(a[f],
b))return f;return-1};b.N.mo=function(a,b,c){if(a&&a[b]instanceof Array){if(c)return a[b];c=[];var f;for(f=0;f<a[b].length;f++)c.push(a[b][f]);return c}return null};b.i=function(a,d){b.i._init(this,a,d,null)};o_("Model",b.i,b);b.a.fa(b.i,b.a,"Model.Model");b.i.prototype.Init=function(){b.i.j.Init.call(this)};b.i.prototype.attributes={};b.a.b("Model.prototype.attributes",{attributes:b.i.prototype.attributes});b.i.prototype.Vb={};b.a.b("Model.prototype.defaults",{Vb:b.i.prototype.Vb});b.i.prototype.id=
null;b.a.b("Model.prototype.id",{id:b.i.prototype.id});b.i.prototype.$d=null;b.a.b("Model.prototype.idAttribute",{$d:b.i.prototype.$d});b.i.prototype.sE=null;b.a.b("Model.prototype.urlRoot",{sE:b.i.prototype.sE});b.i.prototype.Ye=null;b.a.b("Model.prototype.customURL",{Ye:b.i.prototype.Ye});b.i.hs=0;b.i._init=function(a,d,c,f){var h=null,g;if(!b.i.ml){a.Init();b.N.Qm(a);a.Ti();a.Ip={};a.Ep=!1;a.index=-1;c=c||{};a.attributes={};a.defaults&&(a.attributes=b.i.Cg(b.i.Fc(a.defaults)?a.defaults():a.defaults,
null));for(h in f)f.hasOwnProperty(h)&&(a[h]=f[h]);if(d)if(f=c.parse,b.i.Fc(f)&&(a.parse=f),g=b.i.Cg(d,a.attributes),g=f?a.parse(g):g,null==g||void 0===g)a.attributes={};else for(h in g)g.hasOwnProperty(h)&&a.Dj(h,g[h],c);a.Sm();a.ok(c.collection);c.customURL&&(a.customURL=c.customURL);c.url&&(a.url=c.url);c.urlRoot&&(a.urlRoot=c.urlRoot);a.initialize&&a.initialize(d,c);a.mf()}};b.i.extend=function(a,d){b.i.ml=!0;var c,f;c=new b.i;b.i.ml=!1;b.N.Qm(c,this.prototype);a=a||{};for(f in a)a.hasOwnProperty(f)&&
(c[f]=a[f]);var h;h=a&&a.constructor&&a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.i._init(this,d,c,a)};h.prototype=c;h.extend=b.i.extend;h.prototype.constructor=h;b.N.Qm(h,this);if(d)for(f in d)d.hasOwnProperty(f)&&(h[f]=d[f]);return h};o_("Model.extend",b.i.extend,b);b.i.prototype.pb=o_a();b.i.prototype.Sm=function(){this.Gi()||(this.cid="id"+b.i.hs,b.i.hs+=1)};b.i.prototype.Gi=o_c("cid");b.i.prototype.Wp=o_b("index");b.i.prototype.Xp=o_b("next");b.i.prototype.FE=o_c("next");b.i.prototype.Tm=
function(a){var b=this.previous;this.previous=a;return b};b.i.prototype.Wu=o_c("previous");b.i.prototype.ro=function(a){return b.i.Fc(this[a])?this[a]():this[a]};b.i.prototype.LE=function(a,d){var c,f=!1,h=b.nb.Ae(d),g;for(c in a.attributes)a.attributes.hasOwnProperty(c)&&(g=this.attributes[c]!=a.attributes[c],h?c===d&&g&&(f=!0):g&&(f=!0),g&&(this.attributes[c]=a.attributes[c],this.yq(c,a.attributes[c])));this.mf();return f};b.i.Xh=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;
return!1};b.i.prototype.ok=function(a){null==a?delete this.collection:this.collection=a};b.i.prototype.lk=o_c("collection");b.i.prototype.ao=function(a,d,c,f){null!=a&&this.pb(f,b.N.l.CHANGE+":"+a,this,d,c)};b.i.prototype.bo=function(a,d){var c;this.pb(d,b.N.l.CHANGE,this,a,null);(c=this.lk())&&c.pb(d,b.N.l.CHANGE,this,c,a,null)};b.i.prototype.mf=function(){this.id=this.attributes[this.Kr()]};b.i.prototype.$s=function(a,d){return b.a.vi(this.attributes[a],d)?!1:(this.attributes[a]=d,this.mf(),!0)};
b.i.prototype.Ti=function(){this.changed={}};b.i.prototype.yq=function(a,b){this.changed[a]=b};b.i.prototype.Dj=function(a,d,c){if(null==a)return!0;var f={},h,g=this.Ep,e,l;l=b.i.Nn(c);if(2<arguments.length)f[a]=d;else{for(h in a)a.hasOwnProperty(h)&&(f[h]=a[h]);l=d}l=l||{};e=[];if(!this.Fk(f,{validate:l.validate},!1))return!1;g||this.Ti();this.Ep||(this.Ip=b.i.Cg(this.attributes,null));this.Ep=!0;for(h in f)f.hasOwnProperty(h)&&(this.$s(h,f[h])?(this.yq(h,f[h]),e.push(h)):delete f[h]);var m=l.silent;
for(h in f)f.hasOwnProperty(h)&&(e.length&&!m&&(this.QD=!0),this.ao(h,f[h],l,m));if(g)return!0;if(!m)for(;this.QD;)this.QD=!1,this.bo(l,m);this.Ep=!1;return!0};b.i.prototype.clear=function(a){var d,c={silent:!0},f;a=a||{};f=a.silent;c.validate=a.validate;this.Ti();for(d in this.attributes)if(this.attributes.hasOwnProperty(d)){if(!this.hp(d,c,!0))return!1;this.pb(f,b.N.l.CHANGE+":"+d,this,void 0,null)}this.attributes={};this.mf();this.ao(null,null,null,f);this.bo(null,f);return this};b.a.b("Model.prototype.clear",
{clear:b.i.prototype.clear});b.i.Cg=function(a,d){var c;d=d||{};for(c in a)a.hasOwnProperty(c)&&("object"!==typeof a[c]?d.hasOwnProperty(c)?void 0!==a[c]&&(d[c]=a[c]):d[c]=a[c]:d[c]=b.i.Cg(a[c],null));return d};b.i.prototype.clone=function(){var a=new this.constructor,d;for(d in this)this.hasOwnProperty(d)&&this[d]!==this.attributes&&(a[d]=this[d]);a.attributes=b.i.Cg(this.attributes,null);delete a.cid;a.Sm();a.mf();return a};b.a.b("Model.prototype.clone",{clone:b.i.prototype.clone});b.i.prototype.mk=
function(a,b){var c=this.he();if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};b.i.prototype.set=function(a,d,c){var f={},h=!1,g,e=!0;if(arguments&&0<arguments.length)if(1<arguments.length&&arguments[arguments.length-1]&&(h=!0,f=arguments[arguments.length-1]||{}),b.i.Xh(a))if(f.unset)for(g in a)a.hasOwnProperty(g)&&this.hp(g,null,!1);else this.Dj(a,f)||(e=!1);else for(g=0;g<arguments.length;g+=2)if(void 0!==arguments[g]||g<arguments.length-1||!h&&g===arguments.length-1)f.unset?
this.hp(arguments[g],null,!1):this.Dj(arguments[g],arguments[g+1],f)||(e=!1);return e?this:!1};b.a.b("Model.prototype.set",{set:b.i.prototype.set});b.i.prototype.qE=function(a,b){return this.hp(a,b,!1)};b.a.b("Model.prototype.unset",{qE:b.i.prototype.qE});b.i.prototype.hp=function(a,b,c){b=b||{};var f=b.silent,h={};if(this.has(a)){if(!this.Fk(h,b,!1))return!1;c||this.Ti();delete this.attributes[a];this.yq(a,void 0);this.ao(a,null,null,f);this.bo(null,f)}this.mf();return!0};b.i.prototype.get=function(a){return this.attributes[a]};
b.a.b("Model.prototype.get",{get:b.i.prototype.get});b.i.prototype.has=function(a){return void 0!==this.attributes[a]&&null!==this.attributes[a]};b.a.b("Model.prototype.has",{has:b.i.prototype.has});b.i.prototype.fetch=function(a){a=a||{};var d=a.success,c=a.error,f=this,h;h=b.i.Nn(a);h.error=function(d,h,e){f.pb(!1,b.N.l.ERROR,f,d,a);c&&c.call(f,arguments)};h.success=function(c){b.i.co(f,c,h);b.i.Fc(this.parse)&&this.set(this.parse(c),h);d&&d.call(f,this,c,a)};b.i.kl("read",this,h)};b.a.b("Model.prototype.fetch",
{fetch:b.i.prototype.fetch});b.i.prototype.parse=function(a){this.attributes=a;this.mf();return this.attributes};b.i.prototype.url=function(){var a=this.ez(),d=this.he();if(a)return d?a+"/"+encodeURIComponent(d):a;if(a=this.collection)return a=b.i.Fc(a.url)?a.url():a.url,d&&a?(d="/"==b.i.kJ(a)?"":"/",a+d+encodeURIComponent(this.he())):a;throw"No URL defined";};b.a.b("Model.prototype.url",{url:b.i.prototype.url});b.i.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
b.push(a);return b};b.a.b("Model.prototype.keys",{keys:b.i.prototype.keys});b.i.prototype.He=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};b.a.b("Model.prototype.values",{He:b.i.prototype.He});b.i.prototype.Oc=function(){var a,b={};for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(b[a]=this.get(a));return b};b.a.b("Model.prototype.pairs",{Oc:b.i.prototype.Oc});b.i.prototype.PD=function(a){var b=[],c,f,h={};if(a instanceof
Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Oc();for(f in this.attributes)this.attributes.hasOwnProperty(f)&&-1==b.indexOf(f)&&(h[f]=this.get(f));return h};b.a.b("Model.prototype.omit",{PD:b.i.prototype.PD});b.i.prototype.RD=function(a){var b=[],c,f={};if(a instanceof Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Oc();for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(f[b[c]]=this.get(b[c]));
return f};b.a.b("Model.prototype.pick",{RD:b.i.prototype.RD});b.i.prototype.zD=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=this.get(a),b[c]=a);return b};b.a.b("Model.prototype.invert",{zD:b.i.prototype.zD});b.i.kJ=function(a){return a.charAt(a.length-1)};b.i.prototype.$M=function(){var a=this.ez();return a?a:this.lk()?this.lk().url:null};b.i.prototype.ez=function(){return b.i.Fc(this.urlRoot)?this.urlRoot():this.urlRoot};b.i.prototype.parseSave=function(a){return a};
b.i.prototype.isValid=function(){var a={};a.validate=this.validate;return this.Fk(this.attributes,a,!1)};b.a.b("Model.prototype.isValid",{isValid:b.i.prototype.isValid});b.i.hL=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};b.i.prototype.Fk=function(a,d,c){var f=this.validate;return f&&b.i.hL(d,c)&&(this.validationError=f.call(this,a,d))?(this.pb(!1,b.N.l.INVALID,this,this.validationError,d),!1):!0};b.i.eM=function(a){var d=!1,c={},f,h={};if(a&&0<a.length){1<a.length&&
(a[a.length-1]&&b.i.Xh(a[a.length-1]))&&(d=!0,c=a[a.length-1]||{});if(null==a[0])return{attributes:null,options:c};if(b.i.Xh(a[0]))for(f in a[0])a[0].hasOwnProperty(f)&&(h[f]=a[0][f]);else for(f=0;f<a.length;f+=2)if(void 0!==a[f]||f<a.length-1||!d&&f===a.length-1)h[a[f]]=a[f+1]}return{attributes:h,options:c}};b.i.Nn=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.i.prototype.save=function(a,d){var c,f,h,g,e,l;c=b.i.eM(arguments);var m,n,q;q=void 0===a?void 0:
c.attributes;m=b.i.Nn(c.options);m.wait||this.set(q);if(!this.Fk(this.attributes,m,!0))return!1;c=void 0===m.forceNew?!1:m.forceNew;g=this;e=m.error;l=m.patch;m.error=function(a,c,f){g.pb(!1,b.N.l.ERROR,g,a,d);e&&e.call(g,arguments)};m.saveAttrs=m.wait?this.cH(q):this.attributes;n=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.yp())return f=m.success,m.success=function(a){var c;a&&(c=b.i.Fc(this.parse)?this.parse(a):a,g.attributes=c,g.mf());b.i.co(g,
a,m);f&&f.call(b.i.If(m,g),g,a,d);g.Ti()},m.attrs=void 0===q?void 0:l?q:m.saveAttrs,b.i.kl(l?"patch":"update",this,m);h=b.i.Zy(m);m.success=function(a){var c;if(a){c=b.i.Fc(g.parse)?g.parse(a):a;if(!g.Fk(c,m,!0))return;g.attributes=c;g.mf()}m.wait&&g.set(q);b.i.co(g,a,m);h&&h.call(b.i.If(m,g),g,a,d);g.Ti()};m.attrs=m.saveAttrs;m.parse=!0;return b.i.kl("create",this,m)};b.a.b("Model.prototype.save",{save:b.i.prototype.save});b.i.prototype.cH=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&
(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.i.Om=function(a){return a.constructor===Array};b.i.Fc=function(a){return a instanceof Function};b.i.Yu=function(a){return a&&a.hasOwnProperty("value")&&a.hasOwnProperty("comparator")};b.i.prototype.EK=function(a){for(var d in a)if(a.hasOwnProperty(d)){if(!this.attributes.hasOwnProperty(d))return!1;for(var c=b.i.Om(a[d])?a[d]:[a[d]],f=0;f<c.length;f++)if(b.i.Yu(c[f])){var h=c[f].comparator,g=c[f].value;if(b.nb.Ae(h))throw Error("String comparator invalid for local where/findWhere");
if(!h(this,d,g))return!1}else if(a[d]!==this.attributes[d])return!1}return!0};b.i.prototype.yE=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.EK(a[b]))return!0;return!1};b.i.Zy=function(a){return null!=a&&a.success?a.success:null};b.i.If=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};b.i.prototype.yp=function(){return void 0==this.he()};b.a.b("Model.prototype.isNew",{yp:b.i.prototype.yp});b.i.prototype.Kr=function(){return this.idAttribute||"id"};
b.i.prototype.he=o_c("id");b.i.prototype.xt=function(a){if(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(b.a.vi(a[c],this.attributes[c])||(d[c]=a[c]));return b.a.isEmpty(d)?!1:d}return b.a.isEmpty(this.changed)?!1:this.changed};b.a.b("Model.prototype.changedAttributes",{xt:b.i.prototype.xt});b.i.prototype.Xt=function(a){return void 0!==a?b.i.Xh(this.changed)&&this.changed.hasOwnProperty(a):b.i.Xh(this.changed)};b.a.b("Model.prototype.hasChanged",{Xt:b.i.prototype.Xt});b.i.prototype.change=function(){for(var a in this.changed)this.changed.hasOwnProperty(a)&&
(this.ao(a,this.get(a),null,!1),this.bo(null,!1))};b.a.b("Model.prototype.change",{change:b.i.prototype.change});b.i.prototype.destroy=function(a){a=a||{};var d=a.wait,c,f=a.error,h=this,g,e;e=b.i.Nn(a);c=b.i.Zy(e);e.success=function(f){d&&h.xr();b.i.co(h,f,e);c&&c.call(b.i.If(e,h),h,f,a)};e.error=function(a,d,c){h.pb(!1,b.N.l.ERROR,h,a,e);f&&f.call(h,arguments)};if(!this.yp())return g=b.i.kl("delete",this,e),d||this.xr(),g;d||this.xr();c&&c.call(b.i.If(e,h),h,null,a);return!1};b.a.b("Model.prototype.destroy",
{destroy:b.i.prototype.destroy});b.i.prototype.xr=function(){this.pb(!1,b.N.l.DESTROY,this,this.collection,null)};b.i.co=function(a,d,c){a.pb(!1,b.N.l.SYNC,a,d,c)};b.i.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};b.a.b("Model.prototype.toJSON",{toJSON:b.i.prototype.toJSON});b.i.prototype.previous=function(a){return this.Ip[a]};b.a.b("Model.prototype.previous",
{previous:b.i.prototype.previous});b.i.prototype.VD=o_c("Ip");b.a.b("Model.prototype.previousAttributes",{VD:b.i.prototype.VD});b.i.prototype.WD=o_c("Ip");b.a.b("Model.prototype.previousChanges",{WD:b.i.prototype.WD});b.i.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.i.kl=function(a,b,c){c=c||{};b.oauth&&(c.oauthHeader=b.oauth.getHeader());!c.dataType&&b.dataType&&(c.dataType=b.dataType);!c.jsonpCallback&&b.jsonpCallback&&(c.jsonpCallback=b.jsonpCallback);if("create"===a||"patch"===
a||"update"===a)c.ru=b.parseSave.call(b,"patch"===a?b.changed:c.saveAttrs);return b.sync(a,b,c)};b.yQ=function(a,d,c){c=c||{};var f,h=c.success,g=c.error;f=d.customURL;if("create"===a.valueOf())return f=new b.ib(d.$M(),f),f.kO(c.ru,g,c,d);if("read"===a.valueOf()){if(d instanceof b.i)return f=new b.ib(d.url(),f),f.iP(h,g,d.he(),c,b.i.If(c,d));f=new b.ib(d.EE(c),f);return f.jP(h,g,c,d)}f=new b.ib(d.url(),f);var e=null;d instanceof b.i&&(e=d.he());return"update"===a.valueOf()?f.rE(h,e,c.ru,g,c,d,!1):
"patch"===a.valueOf()?f.rE(h,e,c.ru,g,c,d,!0):"delete"===a.valueOf()?f.QO(e,g,c,d):null};o_("sync",b.yQ,b);b.ajax=function(){return e.ajax.apply(window.oj,arguments)};b.g=function(a,d){b.g.ml||b.g._init(this,a,d,null)};o_("Collection",b.g,b);b.g.prototype.ed=null;b.a.b("Collection.prototype.model",{ed:b.g.prototype.ed});b.g.prototype.length=0;b.a.b("Collection.prototype.length",{length:b.g.prototype.length});b.g.prototype.KD=[];b.a.b("Collection.prototype.models",{KD:b.g.prototype.KD});b.g.prototype.url=
null;b.a.b("Collection.prototype.url",{url:b.g.prototype.url});b.g.prototype.Ye=o_d(null);b.a.b("Collection.prototype.customURL",{Ye:b.g.prototype.Ye});b.g.prototype.GC=o_d(null);b.a.b("Collection.prototype.customPagingOptions",{GC:b.g.prototype.GC});b.g.prototype.GD=0;b.a.b("Collection.prototype.lastFetchSize",{GD:b.g.prototype.GD});b.g.prototype.hasMore=!1;b.a.b("Collection.prototype.hasMore",{hasMore:b.g.prototype.hasMore});b.g.prototype.Ju=0;b.a.b("Collection.prototype.totalResults",{Ju:b.g.prototype.Ju});
b.g.prototype.FD=0;b.a.b("Collection.prototype.lastFetchCount",{FD:b.g.prototype.FD});b.g.prototype.JD=-1;b.a.b("Collection.prototype.modelLimit",{JD:b.g.prototype.JD});b.g.prototype.offset=0;b.a.b("Collection.prototype.offset",{offset:b.g.prototype.offset});b.g.prototype.Ht=-1;b.a.b("Collection.prototype.fetchSize",{Ht:b.g.prototype.Ht});b.g.prototype.Eu=1;b.a.b("Collection.prototype.sortDirection",{Eu:b.g.prototype.Eu});b.g.prototype.ue=null;b.a.b("Collection.prototype.comparator",{ue:b.g.prototype.ue});
b.g.prototype.df=!0;b.a.b("Collection.prototype.sortSupported",{df:b.g.prototype.df});b.a.fa(b.g,b.a,"Collection.Collection");b.g.prototype.Init=function(){b.g.j.Init.call(this)};b.g.extend=function(a){b.g.ml=!0;var d=new b.g;b.g.ml=!1;var c;c=a&&a.constructor&&a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.g._init(this,d,c,a)};c.prototype=d;return c.prototype.constructor=c};o_("Collection.extend",b.g.extend,b);b.g._init=function(a,d,c,f){var h,g;a.Init();b.N.Qm(a);if(f)for(h in f)f.hasOwnProperty(h)&&
(a[h]=f[h]);c=c||{};g=["url","comparator","model",b.g.Jc,"modelLimit","customURL"];for(h=0;h<g.length;h++)c.hasOwnProperty(g[h])&&void 0!==c[g[h]]&&(a[g[h]]=c[g[h]]);void 0===a.Vk(null)&&a.Mp(-1);void 0===a.modelLimit&&a.Bu(-1);a.hasMore=!1;a.Be=0;a.Wg([]);c.parse&&(d=a.parse(d));if(null!=d&&void 0!==d)for(g=d instanceof Array?d:[d],h=0;h<g.length;h+=1)a.add(g[h],c);a.ji();f&&f.initialize&&f.initialize.call(a,d,c)};b.g.prototype.on=o_a();b.g.prototype.Kf=o_a();b.g.prototype.pb=o_a();b.g.prototype.Wg=
o_b("models");b.g.prototype.Vc=o_c("models");b.g.prototype.$a=function(){return this.Vc().length};b.g.prototype.SL=function(a){return a<this.$a()||this.Ia()&&(!this.gl()||0===this.$a())?!1:!0};b.g.prototype.gl=function(){return void 0!==this.totalResults&&null!=this.totalResults};b.g.prototype.mM=function(a){this.ys(a);this.Vc().push(a);this.Be++;a.Wp(this.$a()-1)};b.g.prototype.xA=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.Be--};b.g.prototype.JB=function(a,b,c){for(var f=a;f<a+b;f++)this.WA(this.Vc()[f]);
void 0===c?this.xA(this.Vc().splice(a,b)):(this.xA(this.Vc().splice(a,b,c)),this.ys(c));0>this.Be&&(this.Be=0);this.wA(a)};b.g.prototype.sa=function(a){return this.Vc()[a]};b.g.prototype.wA=function(a){for(var b=a;b<this.$a();b++)(a=this.sa(b))&&a.Wp(b)};b.g.prototype.WA=function(a){if(a){var b=a.Wu();a=a.FE();b?b.Xp(a):this.head=a;a?a.Tm(b):this.tail=b}};b.g.prototype.ys=function(a){a.Xp(this.head);this.head?this.head.Tm(a):this.tail=a;a.Tm(null);this.head=a};b.g.prototype.qN=function(a,b){var c=
this.Vc()[a];this.WA(c);c||this.Be++;this.Vc()[a]=b;b.Wp(a);this.ys(b)};b.g.prototype.FH=function(a){var b=this.tail,c,f,h=0;for(this.tail=null;b&&h<a;)c=b.index,(f=this.Vc()[c])&&f.Xt()?(this.tail||(this.tail=b),b=b.Wu()):(this.Be--,-1<c&&(this.Vc()[c]=void 0),b.Xp(null),b=b.Tm(null),h++);this.tail||(this.tail=b);0>this.Be&&(this.Be=0);0===this.Be&&(this.tail=this.head=null)};b.g.prototype.zj=function(){this.Be=0;this.tail=this.head=null};b.g.prototype.Qg=function(a){if(this.Ia()){var b=this.sJ();
-1<b&&this.Be+a>b&&this.FH(this.Be+a-b)}};b.g.prototype.clone=function(){return this.wx(!0)};b.a.b("Collection.prototype.clone",{clone:b.g.prototype.clone});b.g.prototype.wx=function(a){var b=new this.constructor,c;this.Ia()&&(b=this.LH(b),b.$A());if(a)for(a=0;a<this.zc();a+=1)(c=this.Dn(a,null,!0,!1))&&b.Qf(c.clone(),{at:a},!0,!1);return b};b.g.prototype.LH=function(a){var d=["totalResults","hasMore",b.g.Jc],c,f;for(f=0;f<d.length;f++)c=d[f],a[c]=this[c];return a};b.g.prototype.zc=o_c("length");
b.g.prototype.ji=function(){var a=this.$a();this.length=a;this.Ia()||(this.totalResults=a)};b.g.prototype.vl=function(a,d){var c=null,f,c=a instanceof b.i?a:this.model?b.i.Fc(this.model)?new this.model(a,d):new this.model.constructor(a,d):new b.i(a,d);d=d||{};return d.validate&&c.validate&&(f=c.validate(c.attributes))?(d.validationError=f,this.pb(!1,b.N.l.INVALID,this,f,d),null):c};b.g.prototype.add=function(a,b){this.Qg(1);return this.Qf(a,b,!1,(b||{}).deferred)};b.a.b("Collection.prototype.add",
{add:b.g.prototype.add});b.g.prototype.Qf=function(a,d,c,f){function h(a,f,h,g,e){var k;r&&h?s=h.LE(f,a.comparator):(k=a.My(g),void 0===k&&(void 0===l?(a.mM(g),n=a.$a()-1,a.sa(n).Sm()):(n=l,a.Ia()&&c?a.qN(n,g):a.JB(n,0,g),a.sa(n).Sm(),l+=1),void 0===g.lk()&&g.ok(a),a.ji(),a.nL(g),v=!0));c&&(d=d||{},d.fillIn=!0);s&&(void 0===k&&!p&&void 0===l&&1<a.zc())&&(-1<n&&(q=a.sa(n).cid),f={},b.ac.vf(f,d),f.add=!0,a.sort(f),-1<n&&(n=a.indexOf(a.It(q),e)));v&&(g?g.pb(m,b.N.l.ADD,g,a,d):h.pb(m,b.N.l.ADD,h,a,d))}
function g(a,f,g){var e=a.vl(f,d),p=null,m=null;if(null!=e){n=-1;e.mf();p=f instanceof b.i?f:e;if(g)return a.Oh(p,null,g,!0).done(function(b){m=b.m;return h(a,p,m,e,g)});m=c?a.My(p):a.get(p);h(a,p,m,e,g)}}d=d||{};var k=[],l=d.at,m=d.silent,n,q,r=d.merge||!1,p=d.sort,s=!0,v=!1;a instanceof Array?k=a:k.push(a);if(!c&&(this.Ia()||f)){var u=this,y=function(a){var b=e.Deferred();g(u,k[a],!0).done(function(){b.resolve(a)});return b.promise()};f=y(0);var w=function(a){return y(a+1)};for(a=1;a<k.length;a++)f=
f.then(w);return e.when(f).promise()}for(a=0;a<k.length;a++)g(this,k[a],!1)};b.g.prototype.yo=function(){var a=this.comparator;return void 0!==a&&null!==a};b.g.prototype.sort=function(a){a=a||{};var d=a.silent,c=this.comparator,f;this.yo()&&(this.Ia()&&this.FK()?(a=this.totalResults,void 0!==a?this.Wg(Array(a)):(this.Wg([]),this.zj(),this.ji())):(f=this,this.Vc().sort(function(a,d){return b.g.Zp(a,d,c,f,f)}),this.wA(0),this.pb(d,b.N.l.SORT,this,a.add?{add:!0}:null,null)))};b.a.b("Collection.prototype.sort",
{sort:b.g.prototype.sort});b.g.Yk=function(a,d){return a instanceof b.i?a.get(d):b.i.Fc(a[d])?a[d]():a[d]};b.g.Zp=function(a,d,c,f,h){var g,e,l;if(b.i.Fc(c)){if(1===c.length){g=c.call(h,a);e=c.call(h,d);g=b.nb.Ae(g)?g.split(","):[g];var m=b.nb.Ae(e)?e.split(","):[e];for(l=0;l<g.length;l++)if(e=b.g.Jh(g[l],m[l],f.sortDirection),0!==e)return e}return c.call(h,a,d)}if(b.nb.Ae(c))for(c=c.split(","),l=0;l<c.length;l++)if(g=b.g.Yk(a,c[l]),e=b.g.Yk(d,c[l]),e=b.g.Jh(g,e,f.sortDirection),0!==e)return e;return 0};
b.g.prototype.gE=function(a){var d=this.comparator;if(!this.yo())return-1;this.Vd("sortedIndex");return b.g.HI(this.Vc(),a,d)};b.a.b("Collection.prototype.sortedIndex",{gE:b.g.prototype.gE});b.g.HI=function(a,b,c){function f(h,e){var k,l;if(h>e)return-1;k=b.Gi();l=b.he();if(a[h].mk(l,k))return h;if(a[e].mk(l,k))return e;k=Math.floor((e+h)/2);return-1===c(a[k],b)?f(h+1,k):1===c(a[k],b)?f(k,e-1):k}return f(0,a.length-1)};b.g.Jh=function(a,b,c){if(-1===c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;
if(b>a)return-1}return 0};b.g.prototype.unshift=function(a,d){var c={};b.ac.vf(c,d||{});c.at||(c.at=0);this.Qg(1);return this.Qf(a,c,!1,c.deferred)};b.a.b("Collection.prototype.unshift",{unshift:b.g.prototype.unshift});b.g.prototype.shift=function(a){var b=this.md(a);if(this.Ia()||b){var c=this;return this.at(0,a).then(function(b){return c.hi(b,0,a)})}return this.hi(this.at(0),0,a)};b.a.b("Collection.prototype.shift",{shift:b.g.prototype.shift});b.g.prototype.xD=function(a){void 0===a&&(a=1);var b=
[],c;for(c=0;c<this.zc()-a;c+=1)b.push(this.at(c));return b};b.a.b("Collection.prototype.initial",{xD:b.g.prototype.xD});b.g.prototype.md=function(a){return(a||{}).deferred};b.g.prototype.last=function(a,b){var c=this.md(b);void 0===a&&(a=1);if(1===a){var f=this.$a();0===f&&(f=a);return 0<f?this.at(f-1,c):null}var h=[],f=this.zc();if(c||this.Ia())return h=f-a,0>h&&(h=0),0===f&&(f=a),this.Jo(h,f);for(c=f-a;c<f;c+=1)h.push(this.at(c));return h};b.a.b("Collection.prototype.last",{last:b.g.prototype.last});
b.g.prototype.Jo=function(a,b){function c(a){return f(a+1)}function f(a){var b=e.Deferred();k.hr(a,null).done(function(c){h.push(c);b.resolve(a)});return b.promise()}var h=[],g,k=this,l=f(a);for(g=a+1;g<b;g++)l=l.then(c);return e.when(l).then(function(){return h})};b.g.prototype.Cy=function(a){return void 0===a||null===a?this[b.g.Jc]:a};b.g.prototype.vH=function(){var a=this.lastFetchCount;if(void 0===a||null===a)a=this[b.g.Jc];return void 0===this.offset||null===this.offset?a:this.offset+a};b.g.prototype.next=
function(a,d){d=d||{};d[b.g.Jc]=this.Cy(a);var c=this.vH(),f=this.zc();if(0===f&&0<d[b.g.Jc])c=0;else if(c>=f)return d.success&&d.success.call(b.i.If(d,this),this,null,d),null;d.startIndex=c;return this.fetch(d)};b.a.b("Collection.prototype.next",{next:b.g.prototype.next});b.g.prototype.wH=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};b.g.prototype.previous=function(a,d){d=d||{};if(0===this.offset)return d.success&&this.lastFetchCount&&d.success.call(b.i.If(d,this),
this,null,d),null;d[b.g.Jc]=this.Cy(a);var c=this.wH(d[b.g.Jc]);0>c&&(d[b.g.Jc]=this.offset,c=0);d.startIndex=c;return this.fetch(d)};b.a.b("Collection.prototype.previous",{previous:b.g.prototype.previous});b.g.prototype.Bu=function(a){this.modelLimit=a;this.Qg(0)};b.a.b("Collection.prototype.setModelLimit",{Bu:b.g.prototype.Bu});b.g.prototype.sJ=o_c("modelLimit");b.g.prototype.Mp=function(a){this[b.g.Jc]=a};b.a.b("Collection.prototype.setFetchSize",{Mp:b.g.prototype.Mp});b.g.prototype.ZD=function(a,
b){var c=this.md(b);void 0===a&&(a=1);var f=[];if(this.Ia()||c)return this.Jo(a,this.zc());for(c=a;c<this.zc();c+=1)f.push(this.at(c));return f};b.a.b("Collection.prototype.rest",{ZD:b.g.prototype.ZD});b.g.prototype.remove=function(a,b){b=b||{};var c=[],f;a instanceof Array?c=a:c.push(a);for(f=c.length-1;0<=f;f-=1)this.hi(c[f],-1,b)};b.a.b("Collection.prototype.remove",{remove:b.g.prototype.remove});b.g.prototype.hi=function(a,d,c){c=c||{};a=-1==d?this.Oh(a):b.g.Qh(d,a);var f=c.silent;d=a.index;if(-1<
d){var h=a.m;void 0!==h&&h.lk()===this&&h.ok(null);this.JB(d,1);this.ji();var e={};b.ac.vf(e,c);e.index=d;void 0!==h&&h.pb(f,b.N.l.REMOVE,h,this,e);this.ZB(h)}return a.m};b.g.prototype.ZB=function(a){void 0!==a&&a.off(null,null,this)};b.g.prototype.nL=function(a){a.Kf(b.N.l.ALL,this.BL,this,!1,!0)};b.g.prototype.BL=function(a,d,c,f){a===b.N.l.DESTROY&&this.remove(d);if(void 0===c||c===this)Array.prototype.slice.call(arguments),this.pb(f&&f.silent,a,d,c,f)};b.g.prototype.refresh=function(a){a=a||{};
var d=e.Deferred();if(!this.Ia())return this.reset(null,{silent:!0}),this.fetch({success:function(){this.pb(void 0!==a.silent&&a.silent,b.N.l.REFRESH,this,a,null);d.resolve()}}),d;var c=this.totalResults;void 0!==c&&(this.Wg(Array(c)),this.zj());this.pb(void 0!==a.silent&&a.silent,b.N.l.REFRESH,this,a,null);return d.resolve()};b.a.b("Collection.prototype.refresh",{refresh:b.g.prototype.refresh});b.g.prototype.reset=function(a,d){var c;d=d||{};d.previousModels=this.Vc();if(void 0===a||null==a||a instanceof
Array&&0==a.length){for(c=0;c<this.$a();c+=1)this.sa(c)&&this.sa(c).ok(null);this.Wg([]);this.zj()}else if(this.Wg([]),this.zj(),d.parse&&(a=this.parse(a)),a instanceof Array)for(this.Qg(a.length),c=0;c<a.length;c+=1)this.Qf(a[c],d,!0,!1);else this.Qg(1),this.Qf(a,d,!0,!1);this.ji();this.pb(void 0!==d.silent&&d.silent,b.N.l.RESET,this,d,null)};b.a.b("Collection.prototype.reset",{reset:b.g.prototype.reset});b.g.prototype.at=function(a,b){return this.Dn(a,b,!1,this.md(b))};b.a.b("Collection.prototype.at",
{at:b.g.prototype.at});b.g.prototype.Dn=function(a,b,c,f){return 0>a||this.SL(a)?null:c||!this.Ia()&&!f?this.sa(a):this.hr(a,b).promise()};b.g.prototype.hr=function(a,d){function c(){h.resolve(f.sa(a))}var f=this,h=e.Deferred(),g=this.sa(a);return void 0===g?(g={},b.ac.vf(g,d||{}),g.context=this,g.startIndex=a,this.Yn(g,!1).then(c),h):e.Deferred().resolve(g)};b.g.prototype.It=function(a){var b,c;for(b=0;b<this.$a();b+=1)if(c=this.sa(b),void 0!==c&&a===c.cid)return c;if(this.Ia())throw Error("Not found locally and not supported by server for virtual collections");
return null};b.a.b("Collection.prototype.getByCid",{It:b.g.prototype.It});b.g.prototype.get=function(a,b){var c=this.Oh(a,b,this.md(b));if(c){if(e.isFunction(c.promise))return c.then(function(a){return a.m});if(c.hasOwnProperty("m"))return c.m}return null};b.a.b("Collection.prototype.get",{get:b.g.prototype.get});b.g.prototype.My=function(a){return(a=this.Ny(a))?a.m:null};b.g.prototype.Ny=function(a){var d,c=a,f=this.$a(),h;a instanceof b.i?(c=a.Gi(),a=a.he()):void 0!==a&&(null!=a&&void 0!==a.id)&&
(a=a.id);for(d=0;d<f;d+=1)if(h=this.sa(d),void 0!==h&&h.mk(a,c))return b.g.Qh(d,h);return b.g.Qh(-1,void 0)};b.g.prototype.Oh=function(a,d,c,f){var h,g=a;void 0===f&&(f=!1);a instanceof b.i?(g=a.Gi(),a=a.he()):void 0!==a&&(null!=a&&void 0!==a.id)&&(a=a.id);var k;for(h=0;h<this.$a();h+=1)if(k=this.sa(h),void 0!==k&&k.mk(a,g))return a=b.g.Qh(h,k),c?e.Deferred().resolve(a):a;if(this.Ia()){if(void 0===a&&void 0!==g)throw Error("cid not supported on virtual get by ID: only id supported");var l=e.Deferred(),
m=this;c={};b.ac.vf(c,d||{});c.context=this;c.startID=a;this.Yn(c,f).then(function(a){null!=a?(a=m.Rr(),l.resolve(b.g.Qh(a,m.sa(a)))):l.resolve(b.g.Qh(-1,void 0))});return l}a=b.g.Qh(-1,void 0);return c?e.Deferred().resolve(a):a};b.g.Qh=function(a,b){return{index:a,m:b}};b.g.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};b.g.prototype.Np=function(a,d){var c=e.Deferred();if(this.du(a,d))return e.Deferred().resolve();
var f=this.Oy(a,d);this[b.g.Jc]&&this[b.g.Jc]>f-a&&(f=this[b.g.Jc]+a);!this.gl()&&f<a+d&&(f=a+d);this.Yn(this.Ia()?{context:this,startIndex:a,fetchSize:f-a}:{context:this},!1).then(function(){c.resolve()});return c};b.a.b("Collection.prototype.setRangeLocal",{Np:b.g.prototype.Np});b.g.prototype.Oy=function(a,b){var c=this.$a();return a+b>c?c:a+b};b.g.prototype.du=function(a,b){if(!this.Ia())return 0<this.$a();var c=this.Oy(a,b);if(!this.gl()&&c<a+b||0===c)return!1;for(var f=a;f<c;f++)if(void 0===
this.sa(f))return!1;return!0};b.a.b("Collection.prototype.isRangeLocal",{du:b.g.prototype.du});b.g.prototype.fetch=function(a){return this.Yn(a,!1)};b.a.b("Collection.prototype.fetch",{fetch:b.g.prototype.fetch});b.g.prototype.Yn=function(a,d){function c(a,b,c){a.Ia()?c||a.$A():b.add||a.reset()}var f=a||{},h=f.success,e,k;void 0===f.parse&&(f.parse=!0);k=this;f.success=function(l){var m,n;k.rN(l,a);m=k.parse(l,a);var q=null;if(f.add||k.model){if(c(k,f,d),n=b.g.Gx(k),m)for(q=m instanceof Array?m:[m],
r={},p=k.Rr(),k.Qg(q.length),m=0;m<q.length;m+=1)e=n&&f.parse?n.parse(q[m]):q[m],k.Ia()&&(r={at:p+m}),r.silent=!0,k.Qf(e,r,!0,!1)}else if(q=m instanceof Array?m:[m],!d)if(k.Ia()){if(c(k,f,d),m){var r={},p=k.Rr();k.Qg(q.length);for(m=0;m<q.length;m+=1)k.Ia()&&(r={at:p+m}),r.silent=!0,k.Qf(q[m],r,!0,!1)}}else k.reset(m);k.Ia()&&q&&(k.lastFetchCount=q.length);k.pb(!1,b.N.l.SYNC,k,l,f);h&&h.call(b.i.If(a,k),k,l,f)};return this.jy(f)};b.g.prototype.EI=function(a){var d=a||{},c=d.success,f,h;void 0===d.parse&&
(d.parse=!0);h=this;d.success=function(e){var k,l;k=h.parse(e,a);var m=null,n=[];if(d.add||h.model)if(l=b.g.Gx(h),k)for(m=k instanceof Array?k:[k],k=0;k<m.length;k+=1)f=l&&d.parse?l.parse(m[k]):m[k],n.push(h.vl(f));h.pb(!1,b.N.l.SYNC,h,e,d);c&&c.call(b.i.If(a,h),h,n,d)};this.jy(d)};b.g.Gx=function(a){if(a.model)return b.i.Fc(a.model)?new a.model:new a.model.constructor};b.g.prototype.jy=function(a){try{return b.i.kl("read",this,a)}catch(d){throw this.pb(!1,b.N.l.ERROR,this,null,a),d;}};b.g.prototype.$A=
function(){var a=this.totalResults;void 0!==a&&this.$a()!==a&&(this.Wg(Array(a)),this.zj())};b.g.prototype.Vk=function(a){a=a||{};return a[b.g.Jc]||this[b.g.Jc]};b.g.prototype.FK=function(){return void 0!==this.hasMore&&this.hasMore};b.g.prototype.Ia=function(){return-1<this.Vk(null)};b.g.prototype.so=function(a,d,c,f,h){a=parseInt(b.g.ro(a,d,c),10);return void 0===a||null===a||isNaN(a)?f?f:h:a};b.g.prototype.rN=function(a,d){var c={};this.customPagingOptions&&((c=this.customPagingOptions.call(this,
a))||(c={}));d=d||{};this.lastFetchSize=this.so(c,a,"limit",d.fetchSize,this.fetchSize);this.offset=this.so(c,a,"offset",d.startIndex,0);this.lastFetchCount=this.so(c,a,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.so(c,a,"totalResults",this.totalResults,this.totalResults);this.hasMore=this.gJ(b.g.ro(c,a,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);!this.Ia()&&this.lastFetchSize&&this.Mp(this.lastFetchSize)};b.g.prototype.gJ=function(a,b,c,f){return a&&void 0!==
a?a:b+c>f?!1:!0};b.g.ro=function(a,b,c){return a[c]?a[c]:b?b[c]:void 0};b.g.prototype.Rr=function(){return void 0!==this.offset?this.offset:0};b.g.prototype.create=function(a,d){function c(c,f,h,e){return!1===f.save(a instanceof b.i?null:a,e)&&(d.validationError=f.validationError,c.pb(!1,b.N.l.INVALID,c,f.validationError,e),h)?(c.ZB(f),c.remove(f),!1):f}var f=this.md(d);d=d||{};var h=this.vl(a,d),g=d.success,k=d.context,l=d.validate;d.context=this;d.success=function(a,b,c){g&&g.call(null!=k?k:this,
a,b,c)};if(null==h)return!1;d.forceNew=null!=h.he();h.ok(this);var m=this;if(f||this.Ia()){var n=e.Deferred();this.add(h,{merge:!0,deferred:!0}).done(function(){d.success=function(a,b,c){g&&g.call(null!=k?k:this,a,b,c);n.resolve(a)};var a=c(m,h,l,d);a||n.resolve(a)});return n.promise()}this.add(h,{merge:!0});return c(this,h,l,d)};b.a.b("Collection.prototype.create",{create:b.g.prototype.create});b.g.prototype.SD=function(a){var b=[],c;this.Vd("pluck");for(c=0;c<this.zc();c+=1)b.push(this.at(c).get(a));
return b};b.a.b("Collection.prototype.pluck",{SD:b.g.prototype.SD});b.g.prototype.hk=function(a,b){b=b||{};var c=this.md(b);if(this.Ia()){var f=e.Deferred();this.EI({query:a,all:!0,success:function(a,b){f.resolve(b)}});return f.promise()}var h=[],g,k;for(g=0;g<this.zc();g+=1)k=this.at(g),k.yE(a)&&h.push(k);return c?e.Deferred().resolve(h):h};b.a.b("Collection.prototype.where",{hk:b.g.prototype.hk});b.g.prototype.tE=function(a,d){d=d||{};var c=this.md(d),f=this;if(this.Ia()||c){var h=e.Deferred();
this.hk(a,d).done(function(a){a=f.Qz(a);h.resolve(a)});return h.promise()}c=this.hk(a,d);c=this.Qz(c);c[b.g.Jc]=-1;c.ji();return c};b.a.b("Collection.prototype.whereToCollection",{tE:b.g.prototype.tE});b.g.prototype.Qz=function(a){var b=this.wx(!1);b.Wg(a);b.zj();b.ji();return b};b.g.prototype.Vd=function(a){if(this.Ia())throw Error(a+" not valid on a virtual Collection");};b.g.prototype.map=function(a,b){var c=[],f,h;this.Vd("map");for(h=0;h<this.$a();h+=1)f=a.call(b||this,this.sa(h)),c.push(f);
return c};b.a.b("Collection.prototype.map",{map:b.g.prototype.map});b.g.prototype.each=function(a,b){this.Vd("each");this.Vc().forEach(a,b)};b.a.b("Collection.prototype.each",{each:b.g.prototype.each});b.g.prototype.size=function(){return this.zc()};b.a.b("Collection.prototype.size",{size:b.g.prototype.size});b.g.prototype.fE=function(a,d){var c,f=[],h;this.Vd("sortBy");for(c=0;c<this.$a();c+=1)f.push(this.sa(c));h=this;f.sort(function(c,f){var e,m;if(b.i.Fc(a))return e=a.call(d||h,c),m=a.call(d||
h,f),b.g.Jh(e,m,h.sortDirection);e=c.get(a);m=f.get(a);return b.g.Jh(e,m,h.sortDirection)});return f};b.a.b("Collection.prototype.sortBy",{fE:b.g.prototype.fE});b.g.prototype.rD=function(a,d){var c,f={},h;this.Vd("groupBy");for(c=0;c<this.$a();c+=1)h=b.i.Fc(a)?a.call(d||this,this.sa(c)):this.sa(c).get(a),void 0===f[h]&&(f[h]=[]),f[h].push(this.sa(c));return f};b.a.b("Collection.prototype.groupBy",{rD:b.g.prototype.rD});b.g.prototype.min=function(a,b){var c,f={},h,e;this.Vd("min");if(0==this.$a())return null;
f=this.sa(0);h=a.call(b||this,this.sa(0));for(c=1;c<this.$a();c+=1)e=a.call(b||this,this.sa(c)),e<h&&(f=this.sa(c),h=e);return f};b.a.b("Collection.prototype.min",{min:b.g.prototype.min});b.g.prototype.max=function(a,b){var c,f={},h,e;this.Vd("max");if(0==this.$a())return null;f=this.sa(0);h=a.call(b,this.sa(0));for(c=1;c<this.$a();c+=1)e=a.call(b||this,this.sa(c)),e>h&&(f=this.sa(c),h=e);return f};b.a.b("Collection.prototype.max",{max:b.g.prototype.max});b.g.prototype.filter=function(a,b){var c,
f=[];this.Vd("filter");for(c=0;c<this.$a();c+=1)a.call(b||this,this.sa(c))&&f.push(this.sa(c));return f};b.a.b("Collection.prototype.filter",{filter:b.g.prototype.filter});b.g.prototype.uE=function(a){var b=[],c,f,h;this.Vd("without");if(arguments){for(c=0;c<this.$a();c+=1){h=!0;for(f=0;f<arguments.length;f+=1)if(this.sa(c).mk(arguments[f].he(),arguments[f].Gi())){h=!1;break}h&&b.push(this.sa(c))}return b}return this.Vc()};b.a.b("Collection.prototype.without",{uE:b.g.prototype.uE});b.g.prototype.isEmpty=
function(){return 0===this.zc()};b.a.b("Collection.prototype.isEmpty",{isEmpty:b.g.prototype.isEmpty});b.g.prototype.oC=function(a,b){var c;this.Vd("any");for(c=0;c<this.$a();c+=1)if(a.call(b||this,this.sa(c)))return!0;return!1};b.a.b("Collection.prototype.any",{oC:b.g.prototype.oC});b.g.prototype.PC=function(a,b){var c=this.md(b);if(this.Ia()||c){var f=e.Deferred();this.hk(a,b).done(function(a){a&&0<a.length&&f.resolve(a[0]);f.resolve(null)});return f.promise()}c=this.hk(a);return 0<c.length?c[0]:
null};b.a.b("Collection.prototype.findWhere",{PC:b.g.prototype.PC});b.g.prototype.slice=function(a,b,c){var f=this.md(c);c=[];if(void 0===b){if(this.Ia&&!this.gl())throw Error("End must be set for virtual collections with no totalResults");b=this.$a()}if(f||this.Ia())return this.Jo(a,b);for(;a<b;a+=1)c.push(this.sa(a));return c};b.a.b("Collection.prototype.slice",{slice:b.g.prototype.slice});b.g.prototype.set=function(a,b){return this.jN(a,b,this.md(b))};b.a.b("Collection.prototype.set",{set:b.g.prototype.set});
b.g.MA=function(a,b,c,f){if(b)for(b=a.$a()-1;0<=b;b-=1)-1==c.indexOf(b)&&a.hi(a.sa(b),b,f)};b.g.prototype.jN=function(a,d,c){d=d||{};var f=void 0===d.add?!0:d.add,h=void 0===d.remove?!0:d.remove,e=void 0===d.merge?!0:d.merge,k=[],l=null,m;d.parse&&(a=this.parse(a));m=b.i.Om(a)?a:[a];if(this.Ia()||c)return this.mI(m,d,h,f,e);for(a=0;a<m.length;a+=1)l=this.eC(this.vl(m[a],d),f,e,c),-1!==l&&k.push(l);b.g.MA(this,h,k,d)};b.g.prototype.mI=function(a,d,c,f,h){function g(a){return k(a+1)}function k(b){var c=
e.Deferred();n.eC(n.vl(a[b],d),f,h,!0).done(function(a){-1!==a&&l.push(a);c.resolve(b)});return c.promise()}var l=[],m,n=this,q=k(0);for(m=1;m<a.length;m+=1)q=q.then(g);return e.when(q).then(function(){b.g.MA(n,c,l,d)})};b.g.prototype.eC=function(a,b,c,f){function h(f,h,g){var k=h?h.index:-1;if(h&&h.m){if(c){h={merge:c};if(g){var r=e.Deferred();f.Qf(a,h,!1,!0).done(function(){r.resolve(k)});return r.promise()}f.add(a,h)}}else if(b){if(g)return r=e.Deferred(),f.add(a,{deferred:!0}).done(function(){r.resolve(f.zc()-
1)}),r.promise();f.add(a);k=f.zc()-1}return k}if(f||this.Ia()){var g=this,k=e.Deferred();this.Oh(a,null,f).done(function(a){h(g,a,!0).done(function(a){k.resolve(a)})});return k.promise()}f=this.Oh(a);return h(this,f,!1)};b.g.prototype.toJSON=function(){var a=[],b;this.Vd("toJSON");for(b=0;b<this.$a();b+=1)a.push(this.sa(b).toJSON());return a};b.a.b("Collection.prototype.toJSON",{toJSON:b.g.prototype.toJSON});b.g.prototype.first=function(a,b){var c=this.md(b),f=this.zc(),h=[];a?f=a:a=1;c=this.Ia()||
c;if(1===a)return c?this.hr(0,null).promise():0<this.$a()?this.sa(0):null;f>this.$a()&&(!this.Ia()||this.gl())&&(f=this.$a());if(c)return this.Jo(0,f);for(c=0;c<f;c+=1)h.push(this.sa(c));return h};b.a.b("Collection.prototype.first",{first:b.g.prototype.first});b.g.prototype.indexOf=function(a,b){var c=this.md(b);return this.Ia()||c?this.Oh(a,null,!0).then(function(a){return a.index}):this.Oh(a).index};b.a.b("Collection.prototype.indexOf",{indexOf:b.g.prototype.indexOf});b.g.prototype.vL=function(a){a=
this.Ny(a);return void 0!==a?a.index:-1};b.g.prototype.pop=function(a){var b=this.md(a);if(this.Ia()||b){var c=this;return this.at(this.zc()-1,{deferred:b}).then(function(b){c.remove(b,a);return b})}b=this.at(this.zc()-1);this.remove(b,a);return b};b.a.b("Collection.prototype.pop",{pop:b.g.prototype.pop});b.g.prototype.push=function(a,b){var c=this.md(b);this.Qg(1);return this.Qf(a,b,!1,c)};b.a.b("Collection.prototype.push",{push:b.g.prototype.push});b.g.prototype.lastIndexOf=function(a,d){var c;
this.Vd("lastIndexOf");void 0===d&&(d=0);for(c=this.zc()-1;c>=d;c-=1)if(b.a.vi(a,this.at(c)))return c;return-1};b.a.b("Collection.prototype.lastIndexOf",{lastIndexOf:b.g.prototype.lastIndexOf});b.g.prototype.Ur=function(a){return void 0===a?[]:a.split(",")};b.g.BJ=function(a){a=b.i.Om(a)?a:[a];var d="",c,f,h,e;for(h=0;h<a.length;h++){c=a[h];for(e in c)if(c.hasOwnProperty(e))for(var k=b.i.Om(c[e])?c[e]:[c[e]],l=0;l<k.length;l++){if(b.i.Yu(k[l])){f=k[l].value;var m=null,m=k[l].comparator,m=b.i.Fc(m)?
m(null,e,f):m;f=e+m+f}else f=e+"\x3d"+c[e];d+=f+"+"}d=d.substring(0,d.length-1)+","}return","===d.substring(d.length-1)?d.substring(0,d.length-1):d};b.g.prototype.PE=function(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);if(a=this.comparator){a=this.Ur(a);for(c=0;c<a.length;c++)d.sort=0===c?a[c]:d.sort+(","+a[c]);d.sortDir=this.Vr()}this.Ia()&&(d[b.g.Jc]=this.Vk(null));return d};b.g.prototype.EE=function(a){var d=b.i.Fc(this.url)?this.url():this.url;if(this.Ia()){var c=a.all,f=null;f=
c?(f=this.totalResults)?f:this.Vk(a):this.Vk(a);d+="?limit\x3d"+f;c||(a.startIndex&&(d+="\x26offset\x3d"+a.startIndex),a.startID&&(d+="\x26fromID\x3d"+a.startID),a.since&&(d+="\x26since\x3d"+a.since),a.until&&(d+="\x26until\x3d"+a.until));a.query&&(a=b.g.BJ(a.query))&&0<a.length&&(d+="\x26q\x3d"+a);if(a=this.comparator)for(a=this.Ur(a),c=this.Vr(),f=0;f<a.length;f++)d=0===f?d+("\x26orderBy\x3d"+a[f]+":"+c):d+(","+a[f]+":"+c);d+="\x26totalResults\x3dtrue"}return d};b.g.prototype.Vr=function(){return-1===
this.sortDirection?"dsc":"asc"};b.g.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.g.Jc="fetchSize";b.ib=function(a,b){this.Em=a;this.Ye=b;jQuery.support.cors=!0};b.ib.Ki="headers";b.ib.Pl=function(a,d,c){var f;a=e.extend(!0,a,c);for(f in d)d.hasOwnProperty(f)&&"oauthHeader"!==f&&(a.hasOwnProperty(f)||(a[f]=d[f]),f===b.ib.Ki&&(a[f]=e.extend(!0,a[f],d[f])));if(d.oauthHeader)for(f in a[b.ib.Ki]||(a[b.ib.Ki]={}),d.oauthHeader)d.oauthHeader.hasOwnProperty(f)&&(a[b.ib.Ki].hasOwnProperty(f)||
(a[b.ib.Ki][f]=d.oauthHeader[f]));return a};b.ib.prototype.jP=function(a,d,c,f){c=c||{};var h="jsonp"===c.dataType,e=this.fl("read",this.Em,this.Ye,null,f,c);a={crossDomain:c.crossDomain||!h,dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,context:null!==f?f:this,success:a,error:d};a=this.zn(a);a=b.ib.Pl(a,c,e);c.xhr=this.ajax(a);return c.xhr};b.ib.prototype.zn=function(a){a[b.ib.Ki]={"Accept-Language":this.Jd()};return a};b.ib.prototype.iP=function(a,d,c,f,h){f=f||{};var e="jsonp"===f.dataType;
c=this.fl("read",this.Em,this.Ye,c,h,f);a={crossDomain:f.crossDomain||!e,dataType:f.dataType||"json",jsonpCallback:f.jsonpCallback,context:null!==h?h:this,success:a,error:d};a=this.zn(a);a=b.ib.Pl(a,f,c);f.xhr=this.ajax(a);return f.xhr};b.ib.prototype.rE=function(a,d,c,f,h,e,k){h=h||{};var l="jsonp"===h.dataType;d=this.fl(k?"patch":"update",this.Em,this.Ye,d,e,h);a={crossDomain:h.crossDomain||!l,contentType:h.contentType||"application/json",dataType:h.dataType||"json",jsonpCallback:h.jsonpCallback,
data:JSON.stringify(c),success:a,error:f,context:null!==e?e:this};a=this.zn(a);a=b.ib.Pl(a,h,d);h.xhr=this.ajax(a);return h.xhr};b.ib.prototype.Hr=function(a,b){return b.type?b.type:"create"===a?"POST":"delete"===a?"DELETE":"patch"===a?"PATCH":"update"===a?"PUT":"GET"};b.ib.prototype.fN=function(a,d,c){d=d instanceof b.g?d.PE(c):{};a&&(d.recordID=a);return d};b.ib.prototype.fl=function(a,d,c,f,h,e){if(b.i.Fc(c)){c=c.call(this,a,h,this.fN(f,h,e));if(b.nb.Ae(c))return{url:c,type:this.Hr(a,e)};if(c)return c.url=
c.hasOwnProperty("url")?c.url:d,c.type=c.hasOwnProperty("type")?c.type:this.Hr(a,e),c}return{url:d,type:this.Hr(a,e)}};b.ib.prototype.QO=function(a,d,c,f){c=c||{};var h="jsonp"===c.dataType;a=this.fl("delete",this.Em,this.Ye,a,f,c);d={crossDomain:c.crossDomain||!h,success:c.success,error:d,context:null!==f?f:this};d=b.ib.Pl(d,c,a);c.xhr=this.ajax(d);return c.xhr};b.ib.prototype.kO=function(a,d,c,f){c=c||{};var h=JSON.stringify(a),e="jsonp"===c.dataType;a=this.fl("create",this.Em,this.Ye,null,f,c);
d={crossDomain:c.crossDomain||!e,contentType:c.contentType||"application/json",dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,data:h,success:c.success,error:d,context:null!==f?f:this};d=this.zn(d);d=b.ib.Pl(d,c,a);c.xhr=this.ajax(d);return c.xhr};b.ib.prototype.Jd=function(){return b.Wa.Jd()};b.ib.prototype.ajax=function(a){return window.oj.ajax(a)};b.La=function(a,d){d=d||{};b.La._init(this,d,a||"Authorization")};o_("OAuth",b.La,b);b.a.fa(b.La,b.a,"OAuth.OAuth");b.La.prototype.Init=function(){b.La.j.Init.call(this)};
b.La.prototype.getHeader=function(){var a={};this.Yg.access_token||this.zt();a[this.uf.uC]="Bearer "+this.Yg.access_token;return a};b.a.b("OAuth.prototype.getHeader",{getHeader:b.La.prototype.getHeader});b.La.prototype.CD=function(){return this.Yg.SR?!0:!1};b.a.b("OAuth.prototype.isInitialized",{CD:b.La.prototype.CD});b.La.prototype.zt=function(){var a={},d=this;a[d.uf.uC]="Basic "+b.La.gH(d.uf.client_id+":"+d.uf.client_secret);e.ajax({type:"POST",async:!1,url:this.uf.bearer_url,data:"grant_type\x3dclient_credentials",
headers:a,success:function(a){b.La.il(d.Yg,a)},error:function(a){throw Error(a.responseText);}})};b.a.b("OAuth.prototype.clientCredentialGrant",{zt:b.La.prototype.zt});b.La.prototype.cE=function(a){b.La.il(this.Yg,a)};b.a.b("OAuth.prototype.setAccessTokenResponse",{cE:b.La.prototype.cE});b.La.prototype.TC=o_c("Yg");b.a.b("OAuth.prototype.getAccessTokenResponse",{TC:b.La.prototype.TC});b.La.prototype.xC=function(){b.La.mx(this.Yg)};b.a.b("OAuth.prototype.cleanAccessTokenResponse",{xC:b.La.prototype.xC});
b.La.prototype.bE=function(a){b.La.il(this.uf,a)};b.a.b("OAuth.prototype.setAccessTokenRequest",{bE:b.La.prototype.bE});b.La.prototype.SC=o_c("uf");b.a.b("OAuth.prototype.getAccessTokenRequest",{SC:b.La.prototype.SC});b.La.prototype.wC=function(){b.La.mx(this.uf)};b.a.b("OAuth.prototype.cleanAccessTokenRequest",{wC:b.La.prototype.wC});b.La._init=function(a,d,c){a.Init();a.uf={};a.Yg={};d.access_token?b.La.il(a.Yg,d):d.client_id&&(d.client_secret&&d.bearer_url)&&b.La.il(a.uf,d);a.uf.uC=c};b.La.il=
function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};b.La.mx=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};b.La.gH=function(a){var b,c,f,h,e=0,k=0,l=[];do b=a.charCodeAt(e++),c=a.charCodeAt(e++),f=a.charCodeAt(e++),h=b<<16|c<<8|f,b=h>>18&63,c=h>>12&63,f=h>>6&63,h&=63,l[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(h);while(e<a.length);l=l.join("");b=a.length%3;return(b?l.slice(0,b-3):l)+"\x3d\x3d\x3d".slice(b||3)}});
//# sourceMappingURL=oj-modular.map