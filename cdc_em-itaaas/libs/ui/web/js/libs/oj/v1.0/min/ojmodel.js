define(["ojs/ojcore","jquery"],function(b,e){b.N=window.oj.Events={on:function(a,b,c){return this.Mf(a,b,c,!1,!1)},off:function(a,b,c){return this.Qs(a,b,c,!1)},trigger:function(a){var d=Array.prototype.slice.call(arguments);d.unshift(!1);return b.N.sb.apply(this,d)},once:function(a,b,c){return this.pA(a,b,c,!1)},listenTo:function(a,d,c){var f,h,g,e,l={};d.constructor===String?l[d]=c:l=d;for(e in l)if(l.hasOwnProperty(e))for(d=b.N.Uh(e),c=0;c<d.length;c+=1)f=d[c].event,h=d[c].tb,g={event:f,tb:h,object:a,
Hb:l[e]},this.ar(this.Ab,g,b.N.Vz),f=h?f+":"+h:f,void 0===this.Ab&&(this.Ab=[]),this.Ab.push(g),a.Mf(f,l[e],null,!0,!1);return this},listenToOnce:function(a,d,c){var f,h,g,e,l={};d.constructor===String?l[d]=c:l=d;for(e in l)if(l.hasOwnProperty(e))for(d=b.N.Uh(e),c=0;c<d.length;c+=1)f=d[c].event,h=d[c].tb,g={event:f,tb:h,object:a,Hb:l[e]},this.ar(this.Ab,g,b.N.Vz),f=h?f+":"+h:f,void 0===this.Ab&&(this.Ab=[]),this.Ab.push(g),a.pA(f,l[e],null,!0);return this},stopListening:function(a,d,c){var f,h={},
g,e,l,m,n,q,r,p,s;if(null==arguments||0==arguments.length){n=this.Ab?this.Ab.length:0;for(p=0;p<n;p++)q=this.Ab[p].object.Qs,q.apply(this.Ab[p].object,[this.Ab[p].event,this.Ab[p].Hb,this.Ab[p].context,!0]);this.Ab=[];return this}f=d;a&&a.constructor===String&&(f=a);f.constructor===String?h[f]=c:h=f;for(s in h)if(h.hasOwnProperty(s))for(f=b.N.Uh(s),g=0;g<f.length;g+=1)for(e=f[g].event,l=f[g].tb,n=this.Ab?this.Ab.length:0,p=n-1;0<=p;p-=1)m=this.Ab[p],n=a?a===m.object:!0,q=e?e===m.event:!0,r=c?h[s]===
m.Hb:!0,m=l?l===m.tb:!0,n&&(q&&r&&m)&&(q=this.Ab[p].object.Qs,q.apply(this.Ab[p].object,[this.Ab[p].event,this.Ab[p].Hb,this.Ab[p].context,!0]),this.Ab.splice(p,1));return this}};b.N.bind=b.N.on;b.N.unbind=b.N.off;b.N.q={ADD:"add",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",SORT:"sort",CHANGE:"change",DESTROY:"destroy",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",ALL:"all"};o_("Events.EventType",b.N.q,b);b.N.Zm=function(a,b){var c,f=b||this;for(c in f)"function"===typeof f[c]&&
(a[c]=f[c]);a.Ib={};a.Ab=[]};b.N.pA=function(a,b,c,f){var h,g,e,l;e=this.Qr(a,b);for(l in e)if(e.hasOwnProperty(l))for(a=this.Uh(l),b=0;b<a.length;b+=1)h=a[b].event,g=a[b].tb,void 0===this.Ib&&(this.Ib=[]),void 0===this.Ib[h]&&(this.Ib[h]=[]),this.Ib[h].push({Hb:e[l],context:c,tb:g,qg:!0,fired:!1,rh:f});return this};b.N.QB=function(a){return a.qg?a.fired?!1:a.fired=!0:!0};b.N.sb=function(a,d){var c=this.Uh(d),f,h,g,e,l,m;e=[];for(f=0;f<c.length;f+=1)h=c[f].event,g=c[f].tb,e.push({event:h,tb:g});for(f=
0;f<e.length;f+=1){l=this.to(this.Ib,b.N.q.ALL);c=b.N.to(this.Ib,e[f].event,!1);for(h=0;h<(c?c.length:0);h+=1)c[h].tb===e[f].tb&&c[h].Hb&&(g=Array.prototype.slice.call(arguments),c&&(c[h]&&c[h].qg)&&this.$A(b.N.to(this.Ib,e[f].event,!0),c[h]),c&&(c[h]&&this.QB(c[h]))&&(m=c[h].Hb,a&&!c[h].MD||m.apply(c[h].context||this,g.slice(2))));for(h=0;h<(l?l.length:0);h+=1)g=Array.prototype.slice.call(arguments),0<g.length&&(g[1]=e[f].tb?e[f].event+":"+e[f].tb:e[f].event),l&&(l[h]&&l[h].Hb&&this.QB(l[h]))&&(m=
l[h].Hb,a&&!l[h].MD||m.apply(l[h].context||this,g.slice(1))),l&&(l[h]&&l[h].qg)&&this.$A(this.to(this.Ib,b.N.q.ALL,!0),l[h])}return this};b.N.Mf=function(a,d,c,f,h){var g,e,l,m;a=this.Qr(a,d);for(g in a)if(a.hasOwnProperty(g))for(d=this.Uh(g),e=0;e<d.length;e+=1)l=d[e].event,m=d[e].tb,void 0===this.Ib&&(this.Ib=[]),void 0===this.Ib[l]&&(this.Ib[l]=[]),m={Hb:a[g],context:c,tb:m,rh:f,MD:h},-1===this.ar(this.Ib[l],m,b.N.XK)&&this.Ib[l].push(m);return this};b.N.Qs=function(a,b,c,f){var h,g;if(null==arguments||
0==arguments.length)return this.Ib={},this;if(null==a)return this.ZA(a,b,c,f),this;h=this.Qr(a,b);for(g in h)h.hasOwnProperty(g)&&this.ZA(g,h[g],c,f);return this};b.N.Qr=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};b.N.ZA=function(a,d,c,f){var h=[],g,e,l,m,n,q,r,p;if(a)h=b.N.Uh(a);else if(void 0!==this.Ib)for(e in this.Ib)this.Ib.hasOwnProperty(e)&&h.push({event:e});for(a=0;a<h.length;a+=1)if(e=h[a].event,l=h[a].tb,void 0!==this.Ib&&this.Ib[e]instanceof Array){m=this.Ib[e];for(g=
m.length-1;0<=g;g-=1)n=void 0===d||null===d||m[g].Hb==d,q=void 0===c||null===c||m[g].context==c,r=void 0===l||null===l||m[g].tb==l,p=void 0===f||null===f||m[g].rh==f,n&&(q&&r&&p)&&m.splice(g,1);0===m.length&&delete this.Ib[e]}};b.N.$A=function(a,b){var c,f,h,g,e,l;for(c=a.length-1;0<=c;c-=1)f=void 0===b.Hb||null===b.Hb||a[c].Hb==b.Hb,h=void 0===b.context||null===b.context||a[c].context==b.context,g=void 0===b.tb||null===b.tb||a[c].tb==b.tb,e=void 0===b.rh||null===b.rh||a[c].rh==b.rh,l=void 0===b.qg||
null===b.qg||a[c].qg==b.qg,f&&(h&&g&&e&&l)&&a.splice(c,1)};b.N.Uh=function(a){a=a?a.split(" "):[];var b=[],c,f,h;for(c=0;c<a.length;c+=1)f=a[c].split(":"),h=f[0],f=1<f.length?f[1]:null,b.push({event:h,tb:f});return b};b.N.XK=function(a,b){return a.Hb===b.Hb&&a.tb===b.tb&&a.context===b.context&&a.rh===b.rh&&a.qg===b.qg};b.N.Vz=function(a,b){return a.event===b.event&&a.tb===b.tb&&a.context===b.context&&a.object===b.object};b.N.ar=function(a,b,c){var f;if(void 0===a)return-1;for(f=0;f<a.length;f+=1)if(c(a[f],
b))return f;return-1};b.N.to=function(a,b,c){if(a&&a[b]instanceof Array){if(c)return a[b];c=[];var f;for(f=0;f<a[b].length;f++)c.push(a[b][f]);return c}return null};b.i=function(a,d){b.i._init(this,a,d,null)};o_("Model",b.i,b);b.a.ga(b.i,b.a,"Model.Model");b.i.prototype.Init=function(){b.i.j.Init.call(this)};b.i.prototype.attributes={};b.a.c("Model.prototype.attributes",{attributes:b.i.prototype.attributes});b.i.prototype.Wb={};b.a.c("Model.prototype.defaults",{Wb:b.i.prototype.Wb});b.i.prototype.id=
null;b.a.c("Model.prototype.id",{id:b.i.prototype.id});b.i.prototype.be=null;b.a.c("Model.prototype.idAttribute",{be:b.i.prototype.be});b.i.prototype.GE=null;b.a.c("Model.prototype.urlRoot",{GE:b.i.prototype.GE});b.i.prototype.Ye=null;b.a.c("Model.prototype.customURL",{Ye:b.i.prototype.Ye});b.i.ss=0;b.i._init=function(a,d,c,f){var h=null,g;if(!b.i.yl){a.Init();b.N.Zm(a);a.bj();a.Rp={};a.Np=!1;a.index=-1;c=c||{};a.attributes={};a.defaults&&(a.attributes=b.i.Vf(b.i.Hc(a.defaults)?a.defaults():a.defaults,
null));for(h in f)f.hasOwnProperty(h)&&(a[h]=f[h]);if(d)if(f=c.parse,b.i.Hc(f)&&(a.parse=f),g=b.i.Vf(d,a.attributes),g=f?a.parse(g):g,null==g||void 0===g)a.attributes={};else for(h in g)g.hasOwnProperty(h)&&a.Lj(h,g[h],!1,!1,c);a.an();a.yk(c.collection);c.customURL&&(a.customURL=c.customURL);c.url&&(a.url=c.url);c.urlRoot&&(a.urlRoot=c.urlRoot);a.initialize&&a.initialize(d,c);a.mf()}};b.i.extend=function(a,d){b.i.yl=!0;var c,f;c=new b.i;b.i.yl=!1;b.N.Zm(c,this.prototype);a=a||{};for(f in a)a.hasOwnProperty(f)&&
(c[f]=a[f]);var h;h=a&&a.constructor&&a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.i._init(this,d,c,a)};h.prototype=c;h.extend=b.i.extend;h.prototype.constructor=h;b.N.Zm(h,this);if(d)for(f in d)d.hasOwnProperty(f)&&(h[f]=d[f]);return h};o_("Model.extend",b.i.extend,b);b.i.prototype.sb=o_a();b.i.prototype.an=function(){this.Oi()||(this.cid="id"+b.i.ss,b.i.ss+=1)};b.i.prototype.Oi=o_c("cid");b.i.prototype.gq=o_b("index");b.i.prototype.hq=o_b("next");b.i.prototype.TE=o_c("next");b.i.prototype.bn=
function(a){var b=this.previous;this.previous=a;return b};b.i.prototype.hv=o_c("previous");b.i.prototype.yo=function(a){return b.i.Hc(this[a])?this[a]():this[a]};b.i.prototype.ZE=function(a,d){var c,f=!1,h=b.pb.Ce(d),g;for(c in a.attributes)a.attributes.hasOwnProperty(c)&&(g=this.attributes[c]!=a.attributes[c],h?c===d&&g&&(f=!0):g&&(f=!0),g&&(this.attributes[c]=a.attributes[c],this.Iq(c,a.attributes[c])));this.mf();return f};b.i.ci=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;
return!1};b.i.prototype.yk=function(a){null==a?delete this.collection:this.collection=a};b.i.prototype.vk=o_c("collection");b.i.prototype.jo=function(a,d,c,f){null!=a&&this.sb(f,b.N.q.CHANGE+":"+a,this,d,c)};b.i.prototype.ko=function(a,d){var c;this.sb(d,b.N.q.CHANGE,this,a,null);(c=this.vk())&&c.sb(d,b.N.q.CHANGE,this,c,a,null)};b.i.prototype.mf=function(){this.id=this.attributes[this.Ur()]};b.i.prototype.mt=function(a,d,c){var f=b.a.Ci(this.attributes[a],d);return c||!f?(this.attributes[a]=d,this.mf(),
!f):!1};b.i.prototype.bj=function(){this.changed={}};b.i.prototype.Iq=function(a,b){this.changed[a]=b};b.i.prototype.Lj=function(a,d,c,f,h){if(null==a)return!0;var g={},e,l=this.Np;h=b.i.Un(h);if(f)for(e in a)a.hasOwnProperty(e)&&(g[e]=a[e]);else g[a]=d;h=h||{};if(!this.Rk(g,{validate:h.validate},!1))return!1;l||(this.bj(),this.Kt=[]);this.Np||(this.Rp=b.i.Vf(this.attributes,null));this.Np=!0;for(e in g)g.hasOwnProperty(e)&&(this.mt(e,g[e],c)?(this.Iq(e,g[e]),this.Kt.push(e)):delete g[e]);a=h.silent;
for(e in g)g.hasOwnProperty(e)&&(!a&&(0<this.Kt.length||l&&-1===this.Kt.indexOf(e))&&(this.eE=!0),this.jo(e,g[e],h,a));if(l)return!0;if(!a&&!l)for(;this.eE;)this.eE=!1,this.ko(h,a);this.Np=!1;return!0};b.i.prototype.clear=function(a){var d,c={silent:!0},f;a=a||{};f=a.silent;c.validate=a.validate;this.bj();for(d in this.attributes)if(this.attributes.hasOwnProperty(d)){if(!this.qp(d,c,!0))return!1;this.sb(f,b.N.q.CHANGE+":"+d,this,void 0,null)}this.attributes={};this.mf();this.jo(null,null,null,f);
this.ko(null,f);return this};b.a.c("Model.prototype.clear",{clear:b.i.prototype.clear});b.i.Vf=function(a,d){var c;if(null===a)return null;d=d||{};for(c in a)if(a.hasOwnProperty(c))if("object"!==typeof a[c])d.hasOwnProperty(c)?void 0!==a[c]&&(d[c]=a[c]):d[c]=a[c];else if(b.i.wk(a[c]))if(null===a[c])d[c]=null;else if(d[c]=[],0===a[c].length)d[c]=a[c];else for(var f=0;f<a[c].length;f++)d[c].push(b.i.Vf(a[c][f],null));else d[c]=b.i.Vf(a[c],null);return d};b.i.prototype.clone=function(){var a=new this.constructor,
d;for(d in this)this.hasOwnProperty(d)&&this[d]!==this.attributes&&(a[d]=this[d]);a.attributes=b.i.Vf(this.attributes,null);delete a.cid;a.an();a.mf();return a};b.a.c("Model.prototype.clone",{clone:b.i.prototype.clone});b.i.prototype.Pi=function(a,b){var c=this.je();if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};b.i.prototype.set=function(a,d,c){var f={},h=!1,g,e=!0;if(arguments&&0<arguments.length)if(1<arguments.length&&arguments[arguments.length-1]&&(h=!0,f=arguments[arguments.length-
1]||{}),b.i.ci(a))if(f.unset)for(g in a)a.hasOwnProperty(g)&&this.qp(g,null,!1);else this.Lj(a,null,!0,!0,f)||(e=!1);else for(g=0;g<arguments.length;g+=2)if(void 0!==arguments[g]||g<arguments.length-1||!h&&g===arguments.length-1)f.unset?this.qp(arguments[g],null,!1):this.Lj(arguments[g],arguments[g+1],!1,!1,f)||(e=!1);return e?this:!1};b.a.c("Model.prototype.set",{set:b.i.prototype.set});b.i.prototype.EE=function(a,b){return this.qp(a,b,!1)};b.a.c("Model.prototype.unset",{EE:b.i.prototype.EE});b.i.prototype.qp=
function(a,b,c){b=b||{};var f=b.silent,h={};if(this.has(a)){if(!this.Rk(h,b,!1))return!1;c||this.bj();delete this.attributes[a];this.Iq(a,void 0);this.jo(a,null,null,f);this.ko(null,f)}this.mf();return!0};b.i.prototype.get=function(a){return this.attributes[a]};b.a.c("Model.prototype.get",{get:b.i.prototype.get});b.i.prototype.has=function(a){return void 0!==this.attributes[a]&&null!==this.attributes[a]};b.a.c("Model.prototype.has",{has:b.i.prototype.has});b.i.prototype.fetch=function(a){a=a||{};
var d=a.success,c=a.error,f=this,h;h=b.i.Un(a);h.error=function(d,h,e){f.sb(!1,b.N.q.ERROR,f,d,a);c&&c.call(f,arguments)};h.success=function(c){b.i.lo(f,c,h);b.i.Hc(this.parse)&&this.set(this.parse(c),h);d&&d.call(f,this,c,a)};b.i.vl("read",this,h)};b.a.c("Model.prototype.fetch",{fetch:b.i.prototype.fetch});b.i.prototype.parse=function(a){this.attributes=a;this.mf();return this.attributes};b.i.prototype.url=function(){var a=this.qz(),d=this.je();if(a)return d?a+"/"+encodeURIComponent(d):a;if(a=this.collection)return a=
b.i.Hc(a.url)?a.url():a.url,d&&a?(d="/"==b.i.BJ(a)?"":"/",a+d+encodeURIComponent(this.je())):a;throw"No URL defined";};b.a.c("Model.prototype.url",{url:b.i.prototype.url});b.i.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(a);return b};b.a.c("Model.prototype.keys",{keys:b.i.prototype.keys});b.i.prototype.Ie=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};b.a.c("Model.prototype.values",
{Ie:b.i.prototype.Ie});b.i.prototype.Rc=function(){var a,b={};for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(b[a]=this.get(a));return b};b.a.c("Model.prototype.pairs",{Rc:b.i.prototype.Rc});b.i.prototype.dE=function(a){var b=[],c,f,h={};if(a instanceof Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Rc();for(f in this.attributes)this.attributes.hasOwnProperty(f)&&-1==b.indexOf(f)&&(h[f]=this.get(f));return h};b.a.c("Model.prototype.omit",
{dE:b.i.prototype.dE});b.i.prototype.fE=function(a){var b=[],c,f={};if(a instanceof Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Rc();for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(f[b[c]]=this.get(b[c]));return f};b.a.c("Model.prototype.pick",{fE:b.i.prototype.fE});b.i.prototype.PD=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=this.get(a),b[c]=a);return b};b.a.c("Model.prototype.invert",{PD:b.i.prototype.PD});
b.i.BJ=function(a){return a.charAt(a.length-1)};b.i.prototype.tN=function(){var a=this.qz();return a?a:this.vk()?this.vk().url:null};b.i.prototype.qz=function(){return b.i.Hc(this.urlRoot)?this.urlRoot():this.urlRoot};b.i.prototype.parseSave=function(a){return a};b.i.prototype.isValid=function(){var a={};a.validate=this.validate;return this.Rk(this.attributes,a,!1)};b.a.c("Model.prototype.isValid",{isValid:b.i.prototype.isValid});b.i.BL=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?
a.validate:b};b.i.prototype.Rk=function(a,d,c){var f=this.validate;return f&&b.i.BL(d,c)&&(this.validationError=f.call(this,a,d))?(this.sb(!1,b.N.q.INVALID,this,this.validationError,d),!1):!0};b.i.xM=function(a){var d=!1,c={},f,h={};if(a&&0<a.length){1<a.length&&(a[a.length-1]&&b.i.ci(a[a.length-1]))&&(d=!0,c=a[a.length-1]||{});if(null==a[0])return{attributes:null,options:c};if(b.i.ci(a[0]))for(f in a[0])a[0].hasOwnProperty(f)&&(h[f]=a[0][f]);else for(f=0;f<a.length;f+=2)if(void 0!==a[f]||f<a.length-
1||!d&&f===a.length-1)h[a[f]]=a[f+1]}return{attributes:h,options:c}};b.i.Un=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.i.prototype.save=function(a,d){var c,f,h,g,e,l;c=b.i.xM(arguments);var m,n,q;q=void 0===a?void 0:c.attributes;m=b.i.Un(c.options);m.wait||this.set(q);if(!this.Rk(this.attributes,m,!0))return!1;c=void 0===m.forceNew?!1:m.forceNew;g=this;e=m.error;l=m.patch;m.error=function(a,c,f){g.sb(!1,b.N.q.ERROR,g,a,d);e&&e.call(g,arguments)};m.saveAttrs=
m.wait?this.qH(q):this.attributes;n=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.Gp())return f=m.success,m.success=function(a){var c;a&&(c=b.i.Hc(this.parse)?this.parse(a):a,g.attributes=c,g.mf());b.i.lo(g,a,m);f&&f.call(b.i.Kf(m,g),g,a,d);g.bj()},m.attrs=void 0===q?void 0:l?q:m.saveAttrs,b.i.vl(l?"patch":"update",this,m);h=b.i.kz(m);m.success=function(a){var c;if(a){c=b.i.Hc(g.parse)?g.parse(a):a;if(!g.Rk(c,m,!0))return;g.attributes=c;g.mf()}m.wait&&
g.set(q);b.i.lo(g,a,m);h&&h.call(b.i.Kf(m,g),g,a,d);g.bj()};m.attrs=m.saveAttrs;m.parse=!0;return b.i.vl("create",this,m)};b.a.c("Model.prototype.save",{save:b.i.prototype.save});b.i.prototype.qH=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.i.wk=function(a){return null!=a&&a.constructor===Array};b.i.Hc=function(a){return a instanceof Function};b.i.jv=function(a){return a&&a.hasOwnProperty("value")&&
a.hasOwnProperty("comparator")};b.i.prototype.YK=function(a){for(var d in a)if(a.hasOwnProperty(d)){if(!this.attributes.hasOwnProperty(d))return!1;for(var c=b.i.wk(a[d])?a[d]:[a[d]],f=0;f<c.length;f++)if(b.i.jv(c[f])){var h=c[f].comparator,g=c[f].value;if(b.pb.Ce(h))throw Error("String comparator invalid for local where/findWhere");if(!h(this,d,g))return!1}else if(a[d]!==this.attributes[d])return!1}return!0};b.i.prototype.ME=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.YK(a[b]))return!0;
return!1};b.i.kz=function(a){return null!=a&&a.success?a.success:null};b.i.Kf=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};b.i.prototype.Gp=function(){return void 0==this.je()};b.a.c("Model.prototype.isNew",{Gp:b.i.prototype.Gp});b.i.prototype.Ur=function(){return this.idAttribute||"id"};b.i.prototype.je=o_c("id");b.i.prototype.Jt=function(a){if(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(b.a.Ci(a[c],this.attributes[c])||(d[c]=a[c]));return b.a.isEmpty(d)?!1:d}return b.a.isEmpty(this.changed)?
!1:this.changed};b.a.c("Model.prototype.changedAttributes",{Jt:b.i.prototype.Jt});b.i.prototype.ku=function(a){return void 0!==a?b.i.ci(this.changed)&&this.changed.hasOwnProperty(a):b.i.ci(this.changed)};b.a.c("Model.prototype.hasChanged",{ku:b.i.prototype.ku});b.i.prototype.change=function(){for(var a in this.changed)this.changed.hasOwnProperty(a)&&(this.jo(a,this.get(a),null,!1),this.ko(null,!1))};b.a.c("Model.prototype.change",{change:b.i.prototype.change});b.i.prototype.destroy=function(a){a=
a||{};var d=a.wait,c,f=a.error,h=this,g,e;e=b.i.Un(a);c=b.i.kz(e);e.success=function(f){d&&h.Hr();b.i.lo(h,f,e);c&&c.call(b.i.Kf(e,h),h,f,a)};e.error=function(a,d,c){h.sb(!1,b.N.q.ERROR,h,a,e);f&&f.call(h,arguments)};if(!this.Gp())return g=b.i.vl("delete",this,e),d||this.Hr(),g;d||this.Hr();c&&c.call(b.i.Kf(e,h),h,null,a);return!1};b.a.c("Model.prototype.destroy",{destroy:b.i.prototype.destroy});b.i.prototype.Hr=function(){this.sb(!1,b.N.q.DESTROY,this,this.collection,null)};b.i.lo=function(a,d,c){a.sb(!1,
b.N.q.SYNC,a,d,c)};b.i.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};b.a.c("Model.prototype.toJSON",{toJSON:b.i.prototype.toJSON});b.i.prototype.previous=function(a){return this.Rp[a]};b.a.c("Model.prototype.previous",{previous:b.i.prototype.previous});b.i.prototype.jE=o_c("Rp");b.a.c("Model.prototype.previousAttributes",{jE:b.i.prototype.jE});
b.i.prototype.kE=o_c("Rp");b.a.c("Model.prototype.previousChanges",{kE:b.i.prototype.kE});b.i.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.i.vl=function(a,b,c){c=c||{};b.oauth&&(c.oauthHeader=b.oauth.getHeader());!c.dataType&&b.dataType&&(c.dataType=b.dataType);!c.jsonpCallback&&b.jsonpCallback&&(c.jsonpCallback=b.jsonpCallback);if("create"===a||"patch"===a||"update"===a)c.Eu=b.parseSave.call(b,"patch"===a?b.changed:c.saveAttrs);return b.sync(a,b,c)};b.TQ=function(a,d,c){c=c||{};
var f,h=c.success,e=c.error;f=d.customURL;if("create"===a.valueOf())return f=new b.kb(d.tN(),f),f.EO(c.Eu,e,c,d);if("read"===a.valueOf()){if(d instanceof b.i)return f=new b.kb(d.url(),f),f.CP(h,e,d.je(),c,b.i.Kf(c,d));f=new b.kb(d.SE(c),f);return f.DP(h,e,c,d)}f=new b.kb(d.url(),f);var k=null;d instanceof b.i&&(k=d.je());return"update"===a.valueOf()?f.FE(h,k,c.Eu,e,c,d,!1):"patch"===a.valueOf()?f.FE(h,k,c.Eu,e,c,d,!0):"delete"===a.valueOf()?f.jP(k,e,c,d):null};o_("sync",b.TQ,b);b.ajax=function(){return e.ajax.apply(window.oj,
arguments)};b.g=function(a,d){b.g.yl||b.g._init(this,a,d,null)};o_("Collection",b.g,b);b.g.prototype.gd=null;b.a.c("Collection.prototype.model",{gd:b.g.prototype.gd});b.g.prototype.length=0;b.a.c("Collection.prototype.length",{length:b.g.prototype.length});b.g.prototype.$D=[];b.a.c("Collection.prototype.models",{$D:b.g.prototype.$D});b.g.prototype.url=null;b.a.c("Collection.prototype.url",{url:b.g.prototype.url});b.g.prototype.Ye=o_d(null);b.a.c("Collection.prototype.customURL",{Ye:b.g.prototype.Ye});
b.g.prototype.RC=o_d(null);b.a.c("Collection.prototype.customPagingOptions",{RC:b.g.prototype.RC});b.g.prototype.WD=0;b.a.c("Collection.prototype.lastFetchSize",{WD:b.g.prototype.WD});b.g.prototype.hasMore=!1;b.a.c("Collection.prototype.hasMore",{hasMore:b.g.prototype.hasMore});b.g.prototype.Wu=0;b.a.c("Collection.prototype.totalResults",{Wu:b.g.prototype.Wu});b.g.prototype.VD=0;b.a.c("Collection.prototype.lastFetchCount",{VD:b.g.prototype.VD});b.g.prototype.ZD=-1;b.a.c("Collection.prototype.modelLimit",
{ZD:b.g.prototype.ZD});b.g.prototype.offset=0;b.a.c("Collection.prototype.offset",{offset:b.g.prototype.offset});b.g.prototype.Vt=-1;b.a.c("Collection.prototype.fetchSize",{Vt:b.g.prototype.Vt});b.g.prototype.Ru=1;b.a.c("Collection.prototype.sortDirection",{Ru:b.g.prototype.Ru});b.g.prototype.we=null;b.a.c("Collection.prototype.comparator",{we:b.g.prototype.we});b.g.prototype.df=!0;b.a.c("Collection.prototype.sortSupported",{df:b.g.prototype.df});b.a.ga(b.g,b.a,"Collection.Collection");b.g.prototype.Init=
function(){b.g.j.Init.call(this)};b.g.extend=function(a){b.g.yl=!0;var d=new b.g;b.g.yl=!1;var c;c=a&&a.constructor&&a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.g._init(this,d,c,a)};c.prototype=d;return c.prototype.constructor=c};o_("Collection.extend",b.g.extend,b);b.g._init=function(a,d,c,f){var h,e;a.Init();b.N.Zm(a);if(f)for(h in f)f.hasOwnProperty(h)&&(a[h]=f[h]);c=c||{};e=["url","comparator","model",b.g.Lc,"modelLimit","customURL"];for(h=0;h<e.length;h++)c.hasOwnProperty(e[h])&&
void 0!==c[e[h]]&&(a[e[h]]=c[e[h]]);void 0===a.gl(null)&&a.Vp(-1);void 0===a.modelLimit&&a.Ou(-1);a.hasMore=!1;a.De=0;a.$g([]);c.parse&&(d=a.parse(d));if(null!=d&&void 0!==d)for(e=d instanceof Array?d:[d],h=0;h<e.length;h+=1)a.add(e[h],c);a.qi();f&&f.initialize&&f.initialize.call(a,d,c)};b.g.prototype.on=o_a();b.g.prototype.Mf=o_a();b.g.prototype.sb=o_a();b.g.prototype.$g=o_b("models");b.g.prototype.Yc=o_c("models");b.g.prototype.cb=function(){return this.Yc().length};b.g.prototype.lM=function(a){return a<
this.cb()||this.Fa()&&(!this.sl()||0===this.cb())?!1:!0};b.g.prototype.sl=function(){return void 0!==this.totalResults&&null!=this.totalResults};b.g.prototype.FM=function(a){this.Js(a);this.Yc().push(a);this.De++;a.gq(this.cb()-1)};b.g.prototype.JA=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.De--};b.g.prototype.UB=function(a,b,c){for(var f=a;f<a+b;f++)this.gB(this.Yc()[f]);void 0===c?this.JA(this.Yc().splice(a,b)):(this.JA(this.Yc().splice(a,b,c)),this.Js(c));0>this.De&&(this.De=0);this.IA(a)};
b.g.prototype.sa=function(a){return this.Yc()[a]};b.g.prototype.IA=function(a){for(var b=a;b<this.cb();b++)(a=this.sa(b))&&a.gq(b)};b.g.prototype.gB=function(a){if(a){var b=a.hv();a=a.TE();b?b.hq(a):this.head=a;a?a.bn(b):this.tail=b}};b.g.prototype.Js=function(a){a.hq(this.head);this.head?this.head.bn(a):this.tail=a;a.bn(null);this.head=a};b.g.prototype.KN=function(a,b){var c=this.Yc()[a];this.gB(c);c||this.De++;this.Yc()[a]=b;b.gq(a);this.Js(b)};b.g.prototype.TH=function(a){var b=this.tail,c,f,h=
0;for(this.tail=null;b&&h<a;)c=b.index,(f=this.Yc()[c])&&f.ku()?(this.tail||(this.tail=b),b=b.hv()):(this.De--,-1<c&&(this.Yc()[c]=void 0),b.hq(null),b=b.bn(null),h++);this.tail||(this.tail=b);0>this.De&&(this.De=0);0===this.De&&(this.tail=this.head=null)};b.g.prototype.Hj=function(){this.De=0;this.tail=this.head=null};b.g.prototype.Ug=function(a){if(this.Fa()){var b=this.JJ();-1<b&&this.De+a>b&&this.TH(this.De+a-b)}};b.g.prototype.clone=function(){return this.Ix(!0)};b.a.c("Collection.prototype.clone",
{clone:b.g.prototype.clone});b.g.prototype.Ix=function(a){var b=new this.constructor,c;this.Fa()&&(b=this.$H(b),b.kB());if(a)for(a=0;a<this.zc();a+=1)(c=this.Kn(a,null,!0,!1))&&b.Sf(c.clone(),{at:a},!0,!1);return b};b.g.prototype.$H=function(a){var d=["totalResults","hasMore",b.g.Lc],c,f;for(f=0;f<d.length;f++)c=d[f],a[c]=this[c];return a};b.g.prototype.zc=o_c("length");b.g.prototype.qi=function(){var a=this.cb();this.length=a;this.Fa()||(this.totalResults=a)};b.g.prototype.Hl=function(a,d){var c=
null,f,c=a instanceof b.i?a:this.model?b.i.Hc(this.model)?new this.model(a,d):new this.model.constructor(a,d):new b.i(a,d);d=d||{};return d.validate&&c.validate&&(f=c.validate(c.attributes))?(d.validationError=f,this.sb(!1,b.N.q.INVALID,this,f,d),null):c};b.g.prototype.add=function(a,b){this.Ug(1);return this.Sf(a,b,!1,(b||{}).deferred)};b.a.c("Collection.prototype.add",{add:b.g.prototype.add});b.g.prototype.Sf=function(a,d,c,f){function h(a,f,h,e,g){var k;!n&&p&&h?v=h.ZE(f,a.comparator):(n||(k=a.Yy(e)),
void 0===k&&(void 0===l?(a.FM(e),q=a.cb()-1,a.sa(q).an()):(q=l,a.Fa()&&c?a.KN(q,e):a.UB(q,0,e),a.sa(q).an(),l+=1),void 0===e.vk()&&e.yk(a),a.qi(),a.HL(e),u=!0));c&&(d=d||{},d.fillIn=!0);v&&(void 0===k&&!s&&void 0===l&&1<a.zc())&&(-1<q&&(r=a.sa(q).cid),f={},b.bc.xf(f,d),f.add=!0,a.sort(f),-1<q&&(q=a.indexOf(a.Wt(r),g)));u&&(e?e.sb(m,b.N.q.ADD,e,a,d):h.sb(m,b.N.q.ADD,h,a,d))}function g(a,f,g){var p=a.Hl(f,d),m=null,k=null;if(null!=p){q=-1;p.mf();m=f instanceof b.i?f:p;if(g)return n?(h(a,m,void 0,p,
g),e.Deferred().resolve()):a.Vh(m,null,g,!0).done(function(b){k=b.m;return h(a,m,k,p,g)});k=c?a.Yy(m):a.get(m);h(a,m,k,p,g)}}d=d||{};var k=[],l=d.at,m=d.silent,n=d.force,q,r,p=d.merge||!1,s=d.sort,v=!0,u=!1;a instanceof Array?k=a:k.push(a);if(!c&&(this.Fa()||f)){var y=this,w=function(a){var b=e.Deferred();g(y,k[a],!0).done(function(){b.resolve(a)});return b.promise()};f=w(0);var z=function(a){return w(a+1)};for(a=1;a<k.length;a++)f=f.then(z);return e.when(f).promise()}for(a=0;a<k.length;a++)g(this,
k[a],!1)};b.g.prototype.Fo=function(){var a=this.comparator;return void 0!==a&&null!==a};b.g.prototype.sort=function(a){a=a||{};var d=a.silent,c=this.comparator,f;this.Fo()&&(this.Fa()&&this.ZK()?(a=this.totalResults,void 0!==a?this.$g(Array(a)):(this.$g([]),this.Hj(),this.qi())):(f=this,this.Yc().sort(function(a,d){return b.g.jq(a,d,c,f,f)}),this.IA(0),this.sb(d,b.N.q.SORT,this,a.add?{add:!0}:null,null)))};b.a.c("Collection.prototype.sort",{sort:b.g.prototype.sort});b.g.jl=function(a,d){return a instanceof
b.i?a.get(d):b.i.Hc(a[d])?a[d]():a[d]};b.g.jq=function(a,d,c,f,h){var e,k,l;if(b.i.Hc(c)){if(1===c.length){e=c.call(h,a);k=c.call(h,d);e=b.pb.Ce(e)?e.split(","):[e];var m=b.pb.Ce(k)?k.split(","):[k];for(l=0;l<e.length;l++)if(k=b.g.Qh(e[l],m[l],f.sortDirection),0!==k)return k}return c.call(h,a,d)}if(b.pb.Ce(c))for(c=c.split(","),l=0;l<c.length;l++)if(e=b.g.jl(a,c[l]),k=b.g.jl(d,c[l]),k=b.g.Qh(e,k,f.sortDirection),0!==k)return k;return 0};b.g.prototype.uE=function(a){var d=this.comparator;if(!this.Fo())return-1;
this.Wd("sortedIndex");return b.g.$I(this.Yc(),a,d)};b.a.c("Collection.prototype.sortedIndex",{uE:b.g.prototype.uE});b.g.$I=function(a,b,c){function f(h,e){var k,l;if(h>e)return-1;k=b.Oi();l=b.je();if(a[h].Pi(l,k))return h;if(a[e].Pi(l,k))return e;k=Math.floor((e+h)/2);return-1===c(a[k],b)?f(h+1,k):1===c(a[k],b)?f(k,e-1):k}return f(0,a.length-1)};b.g.Qh=function(a,b,c){if(-1===c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};b.g.prototype.unshift=function(a,d){var c=
{};b.bc.xf(c,d||{});c.at||(c.at=0);this.Ug(1);return this.Sf(a,c,!1,c.deferred)};b.a.c("Collection.prototype.unshift",{unshift:b.g.prototype.unshift});b.g.prototype.shift=function(a){var b=this.od(a);if(this.Fa()||b){var c=this;return this.at(0,a).then(function(b){return c.oi(b,0,a)})}return this.oi(this.at(0),0,a)};b.a.c("Collection.prototype.shift",{shift:b.g.prototype.shift});b.g.prototype.ND=function(a){void 0===a&&(a=1);var b=[],c;for(c=0;c<this.zc()-a;c+=1)b.push(this.at(c));return b};b.a.c("Collection.prototype.initial",
{ND:b.g.prototype.ND});b.g.prototype.od=function(a){return(a||{}).deferred};b.g.prototype.last=function(a,b){var c=this.od(b);void 0===a&&(a=1);if(1===a){var f=this.cb();0===f&&(f=a);return 0<f?this.at(f-1,c):null}var h=[],f=this.zc();if(c||this.Fa())return h=f-a,0>h&&(h=0),0===f&&(f=a),this.Ro(h,f);for(c=f-a;c<f;c+=1)h.push(this.at(c));return h};b.a.c("Collection.prototype.last",{last:b.g.prototype.last});b.g.prototype.Ro=function(a,b){function c(a){return f(a+1)}function f(a){var b=e.Deferred();
k.sr(a,null).done(function(c){h.push(c);b.resolve(a)});return b.promise()}var h=[],g,k=this,l=f(a);for(g=a+1;g<b;g++)l=l.then(c);return e.when(l).then(function(){return h})};b.g.prototype.Oy=function(a){return void 0===a||null===a?this[b.g.Lc]:a};b.g.prototype.JH=function(){var a=this.lastFetchCount;if(void 0===a||null===a)a=this[b.g.Lc];return void 0===this.offset||null===this.offset?a:this.offset+a};b.g.prototype.next=function(a,d){d=d||{};d[b.g.Lc]=this.Oy(a);var c=this.JH(),f=this.zc();if(0===
f&&0<d[b.g.Lc])c=0;else if(c>=f)return d.success&&d.success.call(b.i.Kf(d,this),this,null,d),null;d.startIndex=c;return this.fetch(d)};b.a.c("Collection.prototype.next",{next:b.g.prototype.next});b.g.prototype.KH=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};b.g.prototype.previous=function(a,d){d=d||{};if(0===this.offset)return d.success&&this.lastFetchCount&&d.success.call(b.i.Kf(d,this),this,null,d),null;d[b.g.Lc]=this.Oy(a);var c=this.KH(d[b.g.Lc]);0>c&&(d[b.g.Lc]=
this.offset,c=0);d.startIndex=c;return this.fetch(d)};b.a.c("Collection.prototype.previous",{previous:b.g.prototype.previous});b.g.prototype.Ou=function(a){this.modelLimit=a;this.Ug(0)};b.a.c("Collection.prototype.setModelLimit",{Ou:b.g.prototype.Ou});b.g.prototype.JJ=o_c("modelLimit");b.g.prototype.Vp=function(a){this[b.g.Lc]=a};b.a.c("Collection.prototype.setFetchSize",{Vp:b.g.prototype.Vp});b.g.prototype.nE=function(a,b){var c=this.od(b);void 0===a&&(a=1);var f=[];if(this.Fa()||c)return this.Ro(a,
this.zc());for(c=a;c<this.zc();c+=1)f.push(this.at(c));return f};b.a.c("Collection.prototype.rest",{nE:b.g.prototype.nE});b.g.prototype.remove=function(a,b){b=b||{};var c=[],f;a instanceof Array?c=a:c.push(a);for(f=c.length-1;0<=f;f-=1)this.oi(c[f],-1,b)};b.a.c("Collection.prototype.remove",{remove:b.g.prototype.remove});b.g.prototype.oi=function(a,d,c){c=c||{};a=-1==d?this.Vh(a):b.g.$f(d,a);var f=c.silent;d=a.index;if(-1<d){var h=a.m;void 0!==h&&h.vk()===this&&h.yk(null);this.UB(d,1);this.qi();var e=
{};b.bc.xf(e,c);e.index=d;void 0!==h&&h.sb(f,b.N.q.REMOVE,h,this,e);this.jC(h)}return a.m};b.g.prototype.jC=function(a){void 0!==a&&a.off(null,null,this)};b.g.prototype.HL=function(a){a.Mf(b.N.q.ALL,this.WL,this,!1,!0)};b.g.prototype.WL=function(a,d,c,f){a===b.N.q.DESTROY&&this.remove(d);if(void 0===c||c===this)Array.prototype.slice.call(arguments),this.sb(f&&f.silent,a,d,c,f)};b.g.prototype.refresh=function(a){a=a||{};var d=e.Deferred();if(!this.Fa())return this.reset(null,{silent:!0}),this.fetch({success:function(){this.sb(void 0!==
a.silent&&a.silent,b.N.q.REFRESH,this,a,null);d.resolve()}}),d;var c=this.totalResults;void 0!==c&&(this.$g(Array(c)),this.Hj());this.sb(void 0!==a.silent&&a.silent,b.N.q.REFRESH,this,a,null);return d.resolve()};b.a.c("Collection.prototype.refresh",{refresh:b.g.prototype.refresh});b.g.prototype.reset=function(a,d){var c;d=d||{};d.previousModels=this.Yc();if(void 0===a||null==a||a instanceof Array&&0==a.length){for(c=0;c<this.cb();c+=1)this.sa(c)&&this.sa(c).yk(null);this.$g([]);this.Hj()}else if(this.$g([]),
this.Hj(),d.parse&&(a=this.parse(a)),a instanceof Array)for(this.Ug(a.length),c=0;c<a.length;c+=1)this.Sf(a[c],d,!0,!1);else this.Ug(1),this.Sf(a,d,!0,!1);this.qi();this.sb(void 0!==d.silent&&d.silent,b.N.q.RESET,this,d,null)};b.a.c("Collection.prototype.reset",{reset:b.g.prototype.reset});b.g.prototype.at=function(a,b){return this.Kn(a,b,!1,this.od(b))};b.a.c("Collection.prototype.at",{at:b.g.prototype.at});b.g.prototype.Kn=function(a,b,c,f){return 0>a||this.lM(a)?null:c||!this.Fa()&&!f?this.sa(a):
this.sr(a,b).promise()};b.g.prototype.sr=function(a,d){function c(){h.resolve(f.sa(a))}var f=this,h=e.Deferred(),g=this.sa(a);return void 0===g?(g={},b.bc.xf(g,d||{}),g.context=this,g.startIndex=a,this.fo(g,!1).then(c),h):e.Deferred().resolve(g)};b.g.prototype.Wt=function(a){var b,c;for(b=0;b<this.cb();b+=1)if(c=this.sa(b),void 0!==c&&a===c.cid)return c;if(this.Fa())throw Error("Not found locally and not supported by server for virtual collections");return null};b.a.c("Collection.prototype.getByCid",
{Wt:b.g.prototype.Wt});b.g.prototype.get=function(a,b){var c=this.Vh(a,b,this.od(b));if(c){if(e.isFunction(c.promise))return c.then(function(a){return a.m});if(this.Fa())return e.Deferred().resolve(c.m);if(c.hasOwnProperty("m"))return c.m}return null};b.a.c("Collection.prototype.get",{get:b.g.prototype.get});b.g.prototype.Yy=function(a){return(a=this.Zy(a))?a.m:null};b.g.prototype.Zy=function(a){var d,c=a,f=this.cb(),h;a instanceof b.i?(c=a.Oi(),a=a.je()):void 0!==a&&(null!=a&&void 0!==a.id)&&(a=
a.id);for(d=0;d<f;d+=1)if(h=this.sa(d),void 0!==h&&h.Pi(a,c))return b.g.$f(d,h);return b.g.$f(-1,void 0)};b.g.prototype.Vh=function(a,d,c,f){var h,g=a;void 0===f&&(f=!1);a instanceof b.i?(g=a.Oi(),a=a.je()):void 0!==a&&(null!=a&&void 0!==a.id)&&(a=a.id);var k;for(h=0;h<this.cb();h+=1)if(k=this.sa(h),void 0!==k&&k.Pi(a,g))return d=b.g.$f(h,k),c?e.Deferred().resolve(d):d;if(this.Fa()){if(void 0===a&&void 0!==g){var l=e.Deferred();return l.resolve(b.g.$f(-1,void 0))}var l=e.Deferred(),m=this;c={};b.bc.xf(c,
d||{});c.context=this;c.startID=a;this.fo(c,f).then(function(c){if(null!=c){c=m.as();var d=m.sa(c);void 0!==d&&d.Pi(a,g)?l.resolve(b.g.$f(c,d)):l.resolve(b.g.$f(-1,void 0))}else l.resolve(b.g.$f(-1,void 0))});return l}d=b.g.$f(-1,void 0);return c?e.Deferred().resolve(d):d};b.g.$f=function(a,b){return{index:a,m:b}};b.g.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};b.g.prototype.Wp=function(a,d){var c=
e.Deferred();if(this.ru(a,d))return e.Deferred().resolve();var f=this.$y(a,d);this[b.g.Lc]&&this[b.g.Lc]>f-a&&(f=this[b.g.Lc]+a);!this.sl()&&f<a+d&&(f=a+d);this.fo(this.Fa()?{context:this,startIndex:a,fetchSize:f-a}:{context:this},!1).then(function(){c.resolve()});return c};b.a.c("Collection.prototype.setRangeLocal",{Wp:b.g.prototype.Wp});b.g.prototype.$y=function(a,b){var c=this.cb();return a+b>c?c:a+b};b.g.prototype.ru=function(a,b){if(!this.Fa())return 0<this.cb();var c=this.$y(a,b);if(!this.sl()&&
c<a+b||0===c)return!1;for(var f=a;f<c;f++)if(void 0===this.sa(f))return!1;return!0};b.a.c("Collection.prototype.isRangeLocal",{ru:b.g.prototype.ru});b.g.prototype.fetch=function(a){return this.fo(a,!1)};b.a.c("Collection.prototype.fetch",{fetch:b.g.prototype.fetch});b.g.prototype.fo=function(a,d){function c(a,b,c){a.Fa()?c||a.kB():b.add||a.reset()}var f=a||{},h=f.success,e,k;void 0===f.parse&&(f.parse=!0);k=this;f.success=function(l){var m,n;k.LN(l,a);m=k.parse(l,a);var q=null;if(f.add||k.model){if(c(k,
f,d),n=b.g.Rx(k),m)for(q=m instanceof Array?m:[m],r={},p=k.as(),k.Ug(q.length),m=0;m<q.length;m+=1)e=n&&f.parse?n.parse(q[m]):q[m],k.Fa()&&(r={at:p+m}),r.silent=!0,k.Sf(e,r,!0,!1)}else if(q=m instanceof Array?m:[m],!d)if(k.Fa()){if(c(k,f,d),m){var r={},p=k.as();k.Ug(q.length);for(m=0;m<q.length;m+=1)k.Fa()&&(r={at:p+m}),r.silent=!0,k.Sf(q[m],r,!0,!1)}}else k.reset(m);k.Fa()&&q&&(k.lastFetchCount=q.length);k.sb(!1,b.N.q.SYNC,k,l,f);h&&h.call(b.i.Kf(a,k),k,l,f)};return this.wy(f)};b.g.prototype.XI=
function(a){var d=a||{},c=d.success,f,h;void 0===d.parse&&(d.parse=!0);h=this;d.success=function(e){var k,l;k=h.parse(e,a);var m=null,n=[];if(d.add||h.model)if(l=b.g.Rx(h),k)for(m=k instanceof Array?k:[k],k=0;k<m.length;k+=1)f=l&&d.parse?l.parse(m[k]):m[k],n.push(h.Hl(f));h.sb(!1,b.N.q.SYNC,h,e,d);c&&c.call(b.i.Kf(a,h),h,n,d)};this.wy(d)};b.g.Rx=function(a){if(a.model)return b.i.Hc(a.model)?new a.model:new a.model.constructor};b.g.prototype.wy=function(a){try{return b.i.vl("read",this,a)}catch(d){throw this.sb(!1,
b.N.q.ERROR,this,null,a),d;}};b.g.prototype.kB=function(){var a=this.totalResults;void 0!==a&&this.cb()!==a&&(this.$g(Array(a)),this.Hj())};b.g.prototype.gl=function(a){a=a||{};return a[b.g.Lc]||this[b.g.Lc]};b.g.prototype.ZK=function(){return void 0!==this.hasMore&&this.hasMore};b.g.prototype.Fa=function(){return-1<this.gl(null)};b.g.prototype.zo=function(a,d,c,f,h){a=parseInt(b.g.yo(a,d,c),10);return void 0===a||null===a||isNaN(a)?f?f:h:a};b.g.prototype.LN=function(a,d){var c={};this.customPagingOptions&&
((c=this.customPagingOptions.call(this,a))||(c={}));d=d||{};this.lastFetchSize=this.zo(c,a,"limit",d.fetchSize,this.fetchSize);this.offset=this.zo(c,a,"offset",d.startIndex,0);this.lastFetchCount=this.zo(c,a,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.zo(c,a,"totalResults",this.totalResults,this.totalResults);this.hasMore=this.xJ(b.g.yo(c,a,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);!this.Fa()&&this.lastFetchSize&&this.Vp(this.lastFetchSize)};b.g.prototype.xJ=
function(a,b,c,f){return a&&void 0!==a?a:b+c>f?!1:!0};b.g.yo=function(a,b,c){return a[c]?a[c]:b?b[c]:void 0};b.g.prototype.as=function(){return void 0!==this.offset?this.offset:0};b.g.prototype.create=function(a,d){function c(c,f,h,e){return!1===f.save(a instanceof b.i?null:a,e)&&(d.validationError=f.validationError,c.sb(!1,b.N.q.INVALID,c,f.validationError,e),h)?(c.jC(f),c.remove(f),!1):f}var f=this.od(d);d=d||{};var h=this.Hl(a,d),g=d.success,k=d.context,l=d.validate;d.context=this;d.success=function(a,
b,c){g&&g.call(null!=k?k:this,a,b,c)};if(null==h)return!1;d.forceNew=null!=h.je();h.yk(this);var m=this;if(f||this.Fa()){var n=e.Deferred();this.add(h,{merge:!0,deferred:!0}).done(function(){d.success=function(a,b,c){g&&g.call(null!=k?k:this,a,b,c);n.resolve(a)};var a=c(m,h,l,d);a||n.resolve(a)});return n.promise()}this.add(h,{merge:!0});return c(this,h,l,d)};b.a.c("Collection.prototype.create",{create:b.g.prototype.create});b.g.prototype.gE=function(a){var b=[],c;this.Wd("pluck");for(c=0;c<this.zc();c+=
1)b.push(this.at(c).get(a));return b};b.a.c("Collection.prototype.pluck",{gE:b.g.prototype.gE});b.g.prototype.rk=function(a,b){b=b||{};var c=this.od(b);if(this.Fa()){var f=e.Deferred();this.XI({query:a,all:!0,success:function(a,b){f.resolve(b)}});return f.promise()}var h=[],g,k;for(g=0;g<this.zc();g+=1)k=this.at(g),k.ME(a)&&h.push(k);return c?e.Deferred().resolve(h):h};b.a.c("Collection.prototype.where",{rk:b.g.prototype.rk});b.g.prototype.HE=function(a,d){d=d||{};var c=this.od(d),f=this;if(this.Fa()||
c){var h=e.Deferred();this.rk(a,d).done(function(a){a=f.aA(a);h.resolve(a)});return h.promise()}c=this.rk(a,d);c=this.aA(c);c[b.g.Lc]=-1;c.qi();return c};b.a.c("Collection.prototype.whereToCollection",{HE:b.g.prototype.HE});b.g.prototype.aA=function(a){var b=this.Ix(!1);b.$g(a);b.Hj();b.qi();return b};b.g.prototype.Wd=function(a){if(this.Fa())throw Error(a+" not valid on a virtual Collection");};b.g.prototype.map=function(a,b){var c=[],f,h;this.Wd("map");for(h=0;h<this.cb();h+=1)f=a.call(b||this,
this.sa(h)),c.push(f);return c};b.a.c("Collection.prototype.map",{map:b.g.prototype.map});b.g.prototype.each=function(a,b){this.Wd("each");this.Yc().forEach(a,b)};b.a.c("Collection.prototype.each",{each:b.g.prototype.each});b.g.prototype.size=function(){return this.zc()};b.a.c("Collection.prototype.size",{size:b.g.prototype.size});b.g.prototype.tE=function(a,d){var c,f=[],h;this.Wd("sortBy");for(c=0;c<this.cb();c+=1)f.push(this.sa(c));h=this;f.sort(function(c,f){var e,m;if(b.i.Hc(a))return e=a.call(d||
h,c),m=a.call(d||h,f),b.g.Qh(e,m,h.sortDirection);e=c.get(a);m=f.get(a);return b.g.Qh(e,m,h.sortDirection)});return f};b.a.c("Collection.prototype.sortBy",{tE:b.g.prototype.tE});b.g.prototype.HD=function(a,d){var c,f={},h;this.Wd("groupBy");for(c=0;c<this.cb();c+=1)h=b.i.Hc(a)?a.call(d||this,this.sa(c)):this.sa(c).get(a),void 0===f[h]&&(f[h]=[]),f[h].push(this.sa(c));return f};b.a.c("Collection.prototype.groupBy",{HD:b.g.prototype.HD});b.g.prototype.min=function(a,b){var c,f={},h,e;this.Wd("min");
if(0==this.cb())return null;f=this.sa(0);h=a.call(b||this,this.sa(0));for(c=1;c<this.cb();c+=1)e=a.call(b||this,this.sa(c)),e<h&&(f=this.sa(c),h=e);return f};b.a.c("Collection.prototype.min",{min:b.g.prototype.min});b.g.prototype.max=function(a,b){var c,f={},h,e;this.Wd("max");if(0==this.cb())return null;f=this.sa(0);h=a.call(b,this.sa(0));for(c=1;c<this.cb();c+=1)e=a.call(b||this,this.sa(c)),e>h&&(f=this.sa(c),h=e);return f};b.a.c("Collection.prototype.max",{max:b.g.prototype.max});b.g.prototype.filter=
function(a,b){var c,f=[];this.Wd("filter");for(c=0;c<this.cb();c+=1)a.call(b||this,this.sa(c))&&f.push(this.sa(c));return f};b.a.c("Collection.prototype.filter",{filter:b.g.prototype.filter});b.g.prototype.IE=function(a){var b=[],c,f,h;this.Wd("without");if(arguments){for(c=0;c<this.cb();c+=1){h=!0;for(f=0;f<arguments.length;f+=1)if(this.sa(c).Pi(arguments[f].je(),arguments[f].Oi())){h=!1;break}h&&b.push(this.sa(c))}return b}return this.Yc()};b.a.c("Collection.prototype.without",{IE:b.g.prototype.IE});
b.g.prototype.isEmpty=function(){return 0===this.zc()};b.a.c("Collection.prototype.isEmpty",{isEmpty:b.g.prototype.isEmpty});b.g.prototype.zC=function(a,b){var c;this.Wd("any");for(c=0;c<this.cb();c+=1)if(a.call(b||this,this.sa(c)))return!0;return!1};b.a.c("Collection.prototype.any",{zC:b.g.prototype.zC});b.g.prototype.ZC=function(a,b){var c=this.od(b);if(this.Fa()||c){var f=e.Deferred();this.rk(a,b).done(function(a){a&&0<a.length&&f.resolve(a[0]);f.resolve(null)});return f.promise()}c=this.rk(a);
return 0<c.length?c[0]:null};b.a.c("Collection.prototype.findWhere",{ZC:b.g.prototype.ZC});b.g.prototype.slice=function(a,b,c){var f=this.od(c);c=[];if(void 0===b){if(this.Fa&&!this.sl())throw Error("End must be set for virtual collections with no totalResults");b=this.cb()}if(f||this.Fa())return this.Ro(a,b);for(;a<b;a+=1)c.push(this.sa(a));return c};b.a.c("Collection.prototype.slice",{slice:b.g.prototype.slice});b.g.prototype.set=function(a,b){return this.DN(a,b,this.od(b))};b.a.c("Collection.prototype.set",
{set:b.g.prototype.set});b.g.XA=function(a,b,c,f){if(b)for(b=a.cb()-1;0<=b;b-=1)-1==c.indexOf(b)&&a.oi(a.sa(b),b,f)};b.g.prototype.DN=function(a,d,c){d=d||{};var f=void 0===d.add?!0:d.add,h=void 0===d.remove?!0:d.remove,e=void 0===d.merge?!0:d.merge,k=[],l=null,m;d.parse&&(a=this.parse(a));m=b.i.wk(a)?a:[a];if(this.Fa()||c)return this.CI(m,d,h,f,e);for(a=0;a<m.length;a+=1)l=this.pC(this.Hl(m[a],d),f,e,c),-1!==l&&k.push(l);b.g.XA(this,h,k,d)};b.g.prototype.CI=function(a,d,c,f,h){function g(a){return k(a+
1)}function k(b){var c=e.Deferred();n.pC(n.Hl(a[b],d),f,h,!0).done(function(a){-1!==a&&l.push(a);c.resolve(b)});return c.promise()}var l=[],m,n=this,q=k(0);for(m=1;m<a.length;m+=1)q=q.then(g);return e.when(q).then(function(){b.g.XA(n,c,l,d)})};b.g.prototype.pC=function(a,b,c,f){function h(f,h,g){var k=h?h.index:-1;if(h&&h.m){if(c){h={merge:c};if(g){var r=e.Deferred();f.Sf(a,h,!1,!0).done(function(){r.resolve(k)});return r.promise()}f.add(a,h)}}else if(b){if(g)return r=e.Deferred(),f.add(a,{deferred:!0}).done(function(){r.resolve(f.zc()-
1)}),r.promise();f.add(a);k=f.zc()-1}return k}if(f||this.Fa()){var g=this,k=e.Deferred();this.Vh(a,null,f).done(function(a){h(g,a,!0).done(function(a){k.resolve(a)})});return k.promise()}f=this.Vh(a);return h(this,f,!1)};b.g.prototype.toJSON=function(){var a=[],b;this.Wd("toJSON");for(b=0;b<this.cb();b+=1)a.push(this.sa(b).toJSON());return a};b.a.c("Collection.prototype.toJSON",{toJSON:b.g.prototype.toJSON});b.g.prototype.first=function(a,b){var c=this.od(b),f=this.zc(),h=[];a?f=a:a=1;c=this.Fa()||
c;if(1===a)return c?this.sr(0,null).promise():0<this.cb()?this.sa(0):null;f>this.cb()&&(!this.Fa()||this.sl())&&(f=this.cb());if(c)return this.Ro(0,f);for(c=0;c<f;c+=1)h.push(this.sa(c));return h};b.a.c("Collection.prototype.first",{first:b.g.prototype.first});b.g.prototype.indexOf=function(a,b){var c=this.od(b);return this.Fa()||c?this.Vh(a,null,!0).then(function(a){return a.index}):this.Vh(a).index};b.a.c("Collection.prototype.indexOf",{indexOf:b.g.prototype.indexOf});b.g.prototype.QL=function(a){a=
this.Zy(a);return void 0!==a?a.index:-1};b.g.prototype.pop=function(a){var b=this.od(a);if(this.Fa()||b){var c=this;return this.at(this.zc()-1,{deferred:b}).then(function(b){c.remove(b,a);return b})}b=this.at(this.zc()-1);this.remove(b,a);return b};b.a.c("Collection.prototype.pop",{pop:b.g.prototype.pop});b.g.prototype.push=function(a,b){var c=this.od(b);this.Ug(1);return this.Sf(a,b,!1,c)};b.a.c("Collection.prototype.push",{push:b.g.prototype.push});b.g.prototype.lastIndexOf=function(a,d){var c;
this.Wd("lastIndexOf");void 0===d&&(d=0);for(c=this.zc()-1;c>=d;c-=1)if(b.a.Ci(a,this.at(c)))return c;return-1};b.a.c("Collection.prototype.lastIndexOf",{lastIndexOf:b.g.prototype.lastIndexOf});b.g.prototype.ds=function(a){return void 0===a?[]:a.split(",")};b.g.TJ=function(a){a=b.i.wk(a)?a:[a];var d="",c,f,h,e;for(h=0;h<a.length;h++){c=a[h];for(e in c)if(c.hasOwnProperty(e))for(var k=b.i.wk(c[e])?c[e]:[c[e]],l=0;l<k.length;l++){if(b.i.jv(k[l])){f=k[l].value;var m=null,m=k[l].comparator,m=b.i.Hc(m)?
m(null,e,f):m;f=e+m+f}else f=e+"\x3d"+c[e];d+=f+"+"}d=d.substring(0,d.length-1)+","}return","===d.substring(d.length-1)?d.substring(0,d.length-1):d};b.g.prototype.cF=function(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);if(a=this.comparator){a=this.ds(a);for(c=0;c<a.length;c++)d.sort=0===c?a[c]:d.sort+(","+a[c]);d.sortDir=this.es()}this.Fa()&&(d[b.g.Lc]=this.gl(null));return d};b.g.prototype.SE=function(a){var d=b.i.Hc(this.url)?this.url():this.url;if(this.Fa()){var c=a.all,f=null;f=
c?(f=this.totalResults)?f:this.gl(a):this.gl(a);d+="?limit\x3d"+f;c||(a.startIndex&&(d+="\x26offset\x3d"+a.startIndex),a.startID&&(d+="\x26fromID\x3d"+a.startID),a.since&&(d+="\x26since\x3d"+a.since),a.until&&(d+="\x26until\x3d"+a.until));a.query&&(a=b.g.TJ(a.query))&&0<a.length&&(d+="\x26q\x3d"+a);if(a=this.comparator)for(a=this.ds(a),c=this.es(),f=0;f<a.length;f++)d=0===f?d+("\x26orderBy\x3d"+a[f]+":"+c):d+(","+a[f]+":"+c);d+="\x26totalResults\x3dtrue"}return d};b.g.prototype.es=function(){return-1===
this.sortDirection?"dsc":"asc"};b.g.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.g.Lc="fetchSize";b.kb=function(a,b){this.Nm=a;this.Ye=b;jQuery.support.cors=!0};b.kb.Ti="headers";b.kb.bm=function(a,d,c){var f;a=e.extend(!0,a,c);for(f in d)d.hasOwnProperty(f)&&"oauthHeader"!==f&&(a.hasOwnProperty(f)||(a[f]=d[f]),f===b.kb.Ti&&(a[f]=e.extend(!0,a[f],d[f])));if(d.oauthHeader)for(f in a[b.kb.Ti]||(a[b.kb.Ti]={}),d.oauthHeader)d.oauthHeader.hasOwnProperty(f)&&(a[b.kb.Ti].hasOwnProperty(f)||
(a[b.kb.Ti][f]=d.oauthHeader[f]));return a};b.kb.prototype.DP=function(a,d,c,f){c=c||{};var h="jsonp"===c.dataType,e=this.rl("read",this.Nm,this.Ye,null,f,c);a={crossDomain:c.crossDomain||!h,dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,context:null!==f?f:this,success:a,error:d};a=this.Gn(a);a=b.kb.bm(a,c,e);c.xhr=this.ajax(a);return c.xhr};b.kb.prototype.Gn=function(a){a[b.kb.Ti]={"Accept-Language":this.Zd()};return a};b.kb.prototype.CP=function(a,d,c,f,h){f=f||{};var e="jsonp"===f.dataType;
c=this.rl("read",this.Nm,this.Ye,c,h,f);a={crossDomain:f.crossDomain||!e,dataType:f.dataType||"json",jsonpCallback:f.jsonpCallback,context:null!==h?h:this,success:a,error:d};a=this.Gn(a);a=b.kb.bm(a,f,c);f.xhr=this.ajax(a);return f.xhr};b.kb.prototype.FE=function(a,d,c,f,h,e,k){h=h||{};var l="jsonp"===h.dataType;d=this.rl(k?"patch":"update",this.Nm,this.Ye,d,e,h);a={crossDomain:h.crossDomain||!l,contentType:h.contentType||"application/json",dataType:h.dataType||"json",jsonpCallback:h.jsonpCallback,
data:JSON.stringify(c),success:a,error:f,context:null!==e?e:this};a=this.Gn(a);a=b.kb.bm(a,h,d);h.xhr=this.ajax(a);return h.xhr};b.kb.prototype.Rr=function(a,b){return b.type?b.type:"create"===a?"POST":"delete"===a?"DELETE":"patch"===a?"PATCH":"update"===a?"PUT":"GET"};b.kb.prototype.zN=function(a,d,c){d=d instanceof b.g?d.cF(c):{};a&&(d.recordID=a);return d};b.kb.prototype.rl=function(a,d,c,f,h,e){if(b.i.Hc(c)){c=c.call(this,a,h,this.zN(f,h,e));if(b.pb.Ce(c))return{url:c,type:this.Rr(a,e)};if(c)return c.url=
c.hasOwnProperty("url")?c.url:d,c.type=c.hasOwnProperty("type")?c.type:this.Rr(a,e),c}return{url:d,type:this.Rr(a,e)}};b.kb.prototype.jP=function(a,d,c,f){c=c||{};var h="jsonp"===c.dataType;a=this.rl("delete",this.Nm,this.Ye,a,f,c);d={crossDomain:c.crossDomain||!h,success:c.success,error:d,context:null!==f?f:this};d=b.kb.bm(d,c,a);c.xhr=this.ajax(d);return c.xhr};b.kb.prototype.EO=function(a,d,c,f){c=c||{};var h=JSON.stringify(a),e="jsonp"===c.dataType;a=this.rl("create",this.Nm,this.Ye,null,f,c);
d={crossDomain:c.crossDomain||!e,contentType:c.contentType||"application/json",dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,data:h,success:c.success,error:d,context:null!==f?f:this};d=this.Gn(d);d=b.kb.bm(d,c,a);c.xhr=this.ajax(d);return c.xhr};b.kb.prototype.Zd=function(){return b.fb.Zd()};b.kb.prototype.ajax=function(a){return window.oj.ajax(a)};b.Ma=function(a,d){d=d||{};b.Ma._init(this,d,a||"Authorization")};o_("OAuth",b.Ma,b);b.a.ga(b.Ma,b.a,"OAuth.OAuth");b.Ma.prototype.Init=function(){b.Ma.j.Init.call(this)};
b.Ma.prototype.getHeader=function(){var a={};this.bh.access_token||this.Mt();a[this.wf.FC]="Bearer "+this.bh.access_token;return a};b.a.c("OAuth.prototype.getHeader",{getHeader:b.Ma.prototype.getHeader});b.Ma.prototype.SD=function(){return this.bh.mS?!0:!1};b.a.c("OAuth.prototype.isInitialized",{SD:b.Ma.prototype.SD});b.Ma.prototype.Mt=function(){var a={},d=this;a[d.wf.FC]="Basic "+b.Ma.uH(d.wf.client_id+":"+d.wf.client_secret);e.ajax({type:"POST",async:!1,url:this.wf.bearer_url,data:"grant_type\x3dclient_credentials",
headers:a,success:function(a){b.Ma.ul(d.bh,a)},error:function(a){throw Error(a.responseText);}})};b.a.c("OAuth.prototype.clientCredentialGrant",{Mt:b.Ma.prototype.Mt});b.Ma.prototype.qE=function(a){b.Ma.ul(this.bh,a)};b.a.c("OAuth.prototype.setAccessTokenResponse",{qE:b.Ma.prototype.qE});b.Ma.prototype.cD=o_c("bh");b.a.c("OAuth.prototype.getAccessTokenResponse",{cD:b.Ma.prototype.cD});b.Ma.prototype.IC=function(){b.Ma.yx(this.bh)};b.a.c("OAuth.prototype.cleanAccessTokenResponse",{IC:b.Ma.prototype.IC});
b.Ma.prototype.pE=function(a){b.Ma.ul(this.wf,a)};b.a.c("OAuth.prototype.setAccessTokenRequest",{pE:b.Ma.prototype.pE});b.Ma.prototype.bD=o_c("wf");b.a.c("OAuth.prototype.getAccessTokenRequest",{bD:b.Ma.prototype.bD});b.Ma.prototype.HC=function(){b.Ma.yx(this.wf)};b.a.c("OAuth.prototype.cleanAccessTokenRequest",{HC:b.Ma.prototype.HC});b.Ma._init=function(a,d,c){a.Init();a.wf={};a.bh={};d.access_token?b.Ma.ul(a.bh,d):d.client_id&&(d.client_secret&&d.bearer_url)&&b.Ma.ul(a.wf,d);a.wf.FC=c};b.Ma.ul=
function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};b.Ma.yx=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};b.Ma.uH=function(a){var b,c,f,h,e=0,k=0,l=[];do b=a.charCodeAt(e++),c=a.charCodeAt(e++),f=a.charCodeAt(e++),h=b<<16|c<<8|f,b=h>>18&63,c=h>>12&63,f=h>>6&63,h&=63,l[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(h);while(e<a.length);l=l.join("");b=a.length%3;return(b?l.slice(0,b-3):l)+"\x3d\x3d\x3d".slice(b||3)}});
//# sourceMappingURL=oj-modular.map