define(["ojs/ojcore","jquery","ojs/ojeditablevalue"],function(b,e){var a={oa:{TAB:9,ENTER:13,Up:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,UE:16,wE:17,vE:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,Km:8,Qu:46,oS:function(b){b=b.which?b.which:b;switch(b){case a.oa.LEFT:case a.oa.RIGHT:case a.oa.UP:case a.oa.DOWN:return!0}return!1},AD:function(b){switch(b.which){case a.oa.UE:case a.oa.wE:case a.oa.vE:return!0}return b.metaKey?!0:!1},BD:function(a){a=a.which?a.which:a;return 112<=a&&123>=a}},hu:{x:0,y:0},
Fp:function(){var a=1;return function(){return a++}}(),zu:null,cg:function(a,b){for(var c=e(a[0]),d=-1,f=a.length;++d<f&&(c.context=c[0]=a[d])&&!1!==b.call(c[0],d,c););return a},OP:function(){var a=e("\x3cdiv class\x3d'oj-listbox-measure-scrollbar'\x3e\x3c/div\x3e");a.appendTo("body");var b={width:a.width()-a[0].clientWidth,height:a.height()-a[0].clientHeight};a.remove();return b},Op:function(a,b){var c,d,f;if(null===a||1>a.length)return[];c=a.split(b);d=0;for(f=c.length;d<f;d+=1)c[d]=e.trim(c[d]);
return c},iD:function(a){return a.outerWidth(!1)-a.width()},DP:function(b){b.on("keydown",function(){void 0===e.data(b,"keyup-change-value")&&e.data(b,"keyup-change-value",b.val())});b.on("keyup",function(c){c.which===a.oa.ENTER?c.stopPropagation():(c=e.data(b,"keyup-change-value"),void 0!==c&&b.val()!==c&&(e.removeData(b,"keyup-change-value"),b.trigger("keyup-change")))})},CP:function(b){b.on("mousemove",function(b){var c=a.hu;if(void 0===c||c.x!==b.pageX||c.y!==b.pageY)e(b.target).trigger("mousemove-filtered",
b),a.hu.x=b.pageX,a.hu.y=b.pageY})},zQ:function(a){var b=!1,c;return function(){!1===b&&(c=a(),b=!0);return c}},$i:function(a){a[0]!==document.activeElement&&window.setTimeout(function(){var b=a[0],c=a.val().length;a.focus();a.is(":visible")&&b===document.activeElement&&(b.setSelectionRange?b.setSelectionRange(c,c):b.createTextRange&&(b=b.createTextRange(),b.collapse(!1),b.select()))},0)},bP:function(a){a=e(a)[0];var b=0,c=0;"selectionStart"in a?(b=a.selectionStart,c=a.selectionEnd-b):"selection"in
document&&(a.focus(),b=document.selection.createRange(),c=document.selection.createRange().text.length,b.moveStart("character",-a.value.length),b=b.text.length-c);return{offset:b,length:c}},bd:function(a){a.preventDefault();a.stopPropagation()},JP:function(a){a.preventDefault();a.stopImmediatePropagation()},OO:function(a){var b={"\\":"\x26#92;","\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;","/":"\x26#47;"};return String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})},
LP:function(b){function c(a){return""+a.text}var d=b,f,h;e.isArray(d)&&(h=d,d={yb:h});!1===e.isFunction(d)&&(h=d,d=function(){return h});b=d();b.text&&(c=b.text,e.isFunction(c)||(f=b.text,c=function(a){return a[f]}));return function(b){var f=b.Hu,h={yb:[]},p;""===f?b.Gb(d()):(p=function(d,h){var g,m;d=d[0];if(d.children){g={};for(m in d)d.hasOwnProperty(m)&&(g[m]=d[m]);g.children=[];a.cg(e(d.children),function(a,b){p(b,g.children)});(g.children.length||b.yi(f,c(g),d))&&h.push(g)}else b.yi(f,c(d),
d)&&h.push(d)},a.cg(e(d().yb),function(a,b){p(b,h.yb)}),b.Gb(h))}},vC:function(a,b,c){if(e.isFunction(b))return!0;if(!b)return!1;throw Error(c+" must be a function or a false value");},Rl:function(a,c){function d(){}b.a.fa(d,a,"");d.prototype=e.extend(d.prototype,c);return d}},d=a.Rl(Object,{Lb:function(a){var b=this;return function(){a.apply(b,arguments)}},_init:function(b){var c,d=this.da,f=this.Tb;this.cf=b.cf;this.O=b=this.yl(b);this.id=b.id;void 0!==b.element.data(f)&&null!==b.element.data(f)&&
b.element.data(f)._destroy();this.ga=this.$q();this.Tl="ojChoiceId_"+(b.element.attr("id")||"autogen"+a.Fp());this.WR="#"+this.Tl.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.ga.attr("id",this.Tl);this.body=a.zQ(function(){return b.element.closest("body")});this.ga.attr("style",b.element.attr("style"));this.Ft=this.O.element.attr("tabindex");this.O.element.data(f,this).attr("tabindex","-1").before(this.ga);this.ga.data(f,this);this.jc=this.ga.find(".oj-listbox-drop");this.jc.data(f,
this);this.jc.on("click",a.bd);this.yb=this.ga.find(".oj-listbox-results");this.search=c=this.ga.find("input."+d+"-input");this.xu=this.YD=0;this.context=null;this.Do();this.ga.on("click",a.bd);a.CP(this.yb);this.jc.on("mousemove-filtered touchstart touchmove touchend",".oj-listbox-results",this.Lb(this.nz));e(this.ga).on("change","."+d+"-input",function(a){a.stopPropagation()});e(this.jc).on("change","."+d+"-input",function(a){a.stopPropagation()});a.DP(c);c.on("keyup-change input paste",this.Lb(this.ip));
c.on("focus",function(){c.addClass(d+"-focused")});c.on("blur",function(){c.removeClass(d+"-focused")});this.jc.on("mouseup",".oj-listbox-results",this.Lb(function(a){0<e(a.target).closest(".oj-listbox-result-selectable").length&&(this.nz(a),this.ii(null,a))}));this.jc.on("click mouseup mousedown",function(a){a.stopPropagation()});e.isFunction(this.O.ae)&&(!b.value||"ojcombobox"!==this.Tb&&Array.isArray(b.value)||this.fd(b.value),this.mj());f=b.element.prop("disabled");void 0===f&&(f=!1);this.Xn(!f);
f=b.element.prop("readonly");void 0===f&&(f=!1);this.zl(f);a.zu=a.zu||a.OP();this.autofocus=b.element.prop("autofocus");b.element.prop("autofocus",!1);this.autofocus&&this.$i()},_destroy:function(){var a=this.O.element,b=a.data(this.Tb);this.close();this.XD&&(delete this.XD,this.XD=null);void 0!==b&&(b.ga.remove(),b.jc.remove(),a.removeClass(this.da+"-offscreen").removeData(this.Tb).off("."+this.da).prop("autofocus",this.autofocus||!1),this.Ft?a.attr({ES:this.Ft}):a.removeAttr("tabindex"),a.show())},
fi:function(a){if(a.is("option"))return{id:a.prop("value"),text:a.text(),element:a.get(),css:a.attr("class"),disabled:a.prop("disabled"),locked:"locked"===a.attr("locked")||!0===a.data("locked")};if(a.is("optgroup"))return{text:a.attr("label"),children:[],element:a.get(),css:a.attr("class")}},yl:function(b){var d,h,g,p=this;d=b.element;var k=d.get(0).tagName.toLowerCase();"input"===k&&d.attr("list")?this.wf=h=e("#"+d.attr("list")):"select"===k&&0<d.children().length&&(this.wf=h=d);b=e.extend({},{$P:function(c,
d,f){var h,g=this.O.id;h=function(c,d,k){var l,s,n,v,u,q;l=0;for(s=c.length;l<s;l+=1)n=c[l],u=!0===n.disabled,v=!u&&void 0!==g(n),q=e("\x3cli\x3e\x3c/li\x3e"),q.addClass("oj-listbox-results-dept-"+k),q.addClass("oj-listbox-result"),q.addClass(v?"oj-listbox-result-selectable":"oj-listbox-result-unselectable"),u&&q.addClass("oj-disabled"),n.children&&q.addClass("oj-listbox-result-with-children"),q.attr("role","presentation"),v=e(document.createElement("div")),v.addClass("oj-listbox-result-label"),v.attr("id",
"oj-listbox-result-label-"+a.Fp()),v.attr("role","option"),u&&v.attr("aria-disabled","true"),u=b.XO(n,v,f,p.O.Gt),void 0!==u&&v.html(u),q.append(v),n.children&&0<n.children.length&&(u=e("\x3cul\x3e\x3c/ul\x3e"),u.addClass("oj-listbox-result-sub"),h(n.children,u,k+1),q.append(u)),q.data(p.Tb,n),d.append(q)};h(d,c,0)}},c,"select"===k?null:f,b);"function"!==typeof b.id&&(g=b.id,b.id=function(a){return a[g]});h?(b.Kp=this.Lb(function(b){var c={yb:[],RP:!1},d=b.Hu,f,e;e=function(c,f){var h;c.is("option")?
b.yi(d,c.text(),c)&&f.push(p.fi(c)):c.is("optgroup")&&(h=p.fi(c),a.cg(c.children(),function(a,b){e(b,h.children)}),0<h.children.length&&f.push(h))};f=h.children();if(void 0!==this.Th()&&0<f.length){var g=this.cl();g&&(f=f.not(g))}a.cg(f,function(a,b){e(b,c.yb)});b.Gb(c)}),b.id=function(a){return a.id}):"data"in b&&(b.Kp=a.LP(b.data));return b},WB:function(a){a=e.Event(this.Tb+"-selecting",{val:this.id(a),object:a});this.O.element.trigger(a);return!a.isDefaultPrevented()},Ll:function(){this.cf.Ne(this.Wb())},
Re:function(){return!0===this.NC},Xi:function(){var a=this.tr&&!this.zl;if(a===this.NC)return!1;this.ga.toggleClass("oj-disabled",!a);this.close();this.NC=a;return!0},Xn:function(a){void 0===a&&(a=!0);this.tr!==a&&(this.tr=a,this.O.element.prop("disabled",!a),this.Xi())},Wx:function(){this.Xn(!1)},zl:function(a){void 0===a&&(a=!1);if(this.zl===a)return!1;this.zl=a;this.O.element.prop("readonly",a);this.Xi();return!0},Hd:function(){return this.ga.hasClass("oj-listbox-dropdown-open")},vj:function(){var b=
this.jc,c=this.ga.offset(),d=this.ga.outerHeight(!1),f=this.ga.outerWidth(!1),h=b.outerHeight(!1),g=e(window),k=g.width(),l=g.height(),y=g.scrollLeft()+k,w=g.scrollTop()+l,d=c.top+d,z=c.left,w=d+h<=w,x=c.top-h>=this.body().scrollTop(),B=b.outerWidth(!1),t=z+B<=y,C;b.hasClass("oj-listbox-drop-above")?(h=!0,!x&&w&&(C=!0,h=!1)):(h=!1,!w&&x&&(h=C=!0));C?(b.hide(),c=this.ga.offset(),d=this.ga.outerHeight(!1),f=this.ga.outerWidth(!1),b.outerHeight(!1),y=g.scrollLeft()+k,g.scrollTop(),d=c.top+d,!h&&this.Yh()&&
(d-=1),z=c.left,B=b.outerWidth(!1),t=z+B<=y,b.show()):!h&&this.Yh()&&(d-=1);this.O.aS?(g=e(".oj-listbox-results",b)[0],b.addClass("oj-listbox-drop-auto-width"),b.css("width",""),B=b.outerWidth(!1)+(g.scrollHeight===g.clientHeight?0:a.zu.width),B>f?f=B:B=f,t=z+B<=y):this.ga.removeClass("oj-listbox-drop-auto-width");"static"!==this.body().css("position")&&(y=this.body().offset(),d-=y.top,z-=y.left);t||(z=c.left+f-B);f={left:z,width:f};h?(f.bottom=l-c.top,f.top="auto",this.ga.addClass("oj-listbox-drop-above"),
b.addClass("oj-listbox-drop-above")):(f.top=d,f.bottom="auto",this.ga.removeClass("oj-listbox-drop-above"),b.removeClass("oj-listbox-drop-above"));b.css(f)},yN:function(){var a;if(this.Hd()||!1===this.tr||!0===this.zl)return!1;a=e.Event(this.Tb+"-opening");this.O.element.trigger(a);return!a.isDefaultPrevented()},rx:function(){this.ga.removeClass("oj-listbox-drop-above");this.jc.removeClass("oj-listbox-drop-above")},open:function(){if(!this.yN())return!1;this.ei();return!0},Hk:function(){this.search.hasClass(this.da+
"-default")&&this.search.val("").removeClass(this.da+"-default")},ei:function(){var a=this.Tl,b="scroll."+a,c="resize."+a,d="orientationchange."+a,f=this.Tb,h;this.Hk();this.ga.addClass("oj-listbox-dropdown-open");this.rx();this.jc[0]!==this.body().children().last()[0]&&this.jc.detach().appendTo(this.body());h=e("#oj-listbox-drop-mask"+a);0==h.length&&(h=e(document.createElement("div")),h.attr("id","oj-listbox-drop-mask"+a).attr("class","oj-listbox-drop-mask"),h.hide(),h.appendTo(this.body()),h.on("mousedown touchstart click",
function(a){var b=e("#oj-listbox-drop");0<b.length&&(b=b.data(f),b.O.nQ&&b.ii({zm:!0},a),b.close(),a.preventDefault(),a.stopPropagation())}));this.jc.prev()[0]!==h[0]&&this.jc.before(h);e("#oj-listbox-drop").removeAttr("id");this.jc.attr("id","oj-listbox-drop");h.show();this.vj();this.jc.show();this.vj();this.fo().attr("aria-expanded",!0);var g=this;this.ga.parents().add(window).each(function(){e(this).on(c+" "+b+" "+d,function(){g.vj()})})},close:function(){if(this.Hd()){var a=this.Tl,b="scroll."+
a,c="resize."+a,d="orientationchange."+a;this.ga.parents().add(window).each(function(){e(this).off(b).off(c).off(d)});this.rx();e("#oj-listbox-drop-mask"+this.Tl).hide();this.jc.removeAttr("id");this.jc.hide();this.ga.removeClass("oj-listbox-dropdown-open");this.yb.empty();this.fo().attr("aria-expanded",!1)}},Ed:o_a(),AI:function(){var a=this.yb,b,c,d,f;c=this.qf();0>c||(0==c?a.scrollTop(0):(b=this.Yi().find(".oj-listbox-result-label"),d=e(b[c]),f=d.offset().top+d.outerHeight(!0),c===b.length-1&&
(b=a.find("li.oj-listbox-more-results"),0<b.length&&(f=b.offset().top+b.outerHeight(!0))),b=a.offset().top+a.outerHeight(!0),f>b&&a.scrollTop(a.scrollTop()+(f-b)),f=d.offset().top-a.offset().top,0>f&&"none"!=d.css("display")&&a.scrollTop(a.scrollTop()+f)))},Yi:function(){return this.yb.find(".oj-listbox-result-selectable:not(.oj-disabled, .oj-listbox-selected)")},$z:function(a){for(var b=this.Yi(),c=this.qf();-1<c&&c<b.length;){var c=c+a,d=e(b[c]);if(d.hasClass("oj-listbox-result-selectable")&&!d.hasClass("oj-disabled")&&
!d.hasClass("oj-listbox-selected")){this.qf(c);break}}},qf:function(a){var b=this.Yi();if(0===arguments.length)return b.get().indexOf(b.filter(".oj-listbox-highlighted")[0]);a>=b.length&&(a=b.length-1);0>a&&(a=0);this.Rs();b=e(b[a]);b.addClass("oj-listbox-highlighted");this.fo().attr("aria-activedescendant",b.find(".oj-listbox-result-label").attr("id"));this.AI()},Rs:function(){this.yb.find(".oj-listbox-highlighted").removeClass("oj-listbox-highlighted")},nz:function(a){a=e(a.target).closest(".oj-listbox-result-selectable");
if(0<a.length&&!a.is(".oj-listbox-highlighted")){var b=this.Yi();this.qf(b.index(a))}else 0==a.length&&this.Rs()},ip:function(b){function c(a){f.html(a);g.vj()}var d=this.search,f=this.yb,h=this.O,g=this,k;k=d.val();var l=e.data(this.ga,this.da+"-last-term"),y;!0!==b&&l&&k===l||(e.data(this.ga,this.da+"-last-term",k),y=++this.YD,this.Rs(),k=this.search.val(),this.xu=1,h.Kp({element:h.element,Hu:void 0!==k&&null!=k&&!0!==b?k:"",page:this.xu,context:null,yi:h.yi,Gb:this.Lb(function(k){var l;y==this.YD&&
this.Hd()&&(this.context=void 0===k.context?null:k.context,0===k.yb.length&&(this.O.lu&&""!==d.val())&&(l=this.O.lu.call(g,d.val(),k.yb),void 0!==l&&null!==l&&void 0!==g.id(l)&&null!==g.id(l)&&0===e(k.yb).filter(function(){return g.id(this)===g.id(l)}).length&&k.yb.unshift(l)),0===k.yb.length&&a.vC(g.cf,h.qp,"formatNoMatches")?c("\x3cli class\x3d'oj-listbox-no-results'\x3e"+h.qp(g.cf,d.val())+"\x3c/li\x3e"):(f.empty(),g.O.$P.call(this,f,k.yb,{Hu:d.val(),page:this.xu,context:null}),this.xl(k,b),g.vj()))})}))},
Nq:function(){this.close()},Sk:function(){a.$i(this.search)},ii:function(a,b){var c=this.qf(),d=this.yb.find(".oj-listbox-highlighted").closest(".oj-listbox-result").data(this.Tb);d?(this.qf(c),this.cA(d,a,b)):a&&a.zm&&this.close()},Th:function(){return this.O.element.attr("placeholder")||this.O.element.attr("data-placeholder")||this.O.element.data("placeholder")||this.O.placeholder},cl:o_a(),qz:function(){var a;a:{var b,c,d;a=this.O.element.attr("style");if(void 0!==a)for(a=a.split(";"),c=0,d=a.length;c<
d;c+=1)if(b=a[c].replace(/\s/g,""),b=b.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==b&&1<=b.length){a=b[1];break a}a=void 0}null!==a&&this.ga.css("width",a)},Wb:function(){return this.cf.option("value")},fd:function(a,b){"string"===typeof a?this.cf.Ne([a],b):this.cf.Ne(a,b);this.O.element.val(a)},fo:o_c("search"),Yh:function(){return void 0!==this.O.minimumResultsForSearch&&void 0!==this.ga.Yh}}),c={At:!0,VP:!0,XO:function(a,b,c,d){b=[];b.push(d(a.text));return b.join("")},
QC:function(a,b,c){return a&&a.text?c(a.text):void 0},qp:o_d("No matches found"),id:function(a){return a.id},yi:function(a,b){return 0<=(""+b).toUpperCase().indexOf((""+a).toUpperCase())},separator:",",Gt:a.OO,TR:!1,nQ:!1},f={lu:function(a){return{id:e.trim(a),text:e.trim(a)}}},h=a.Rl(d,{Xi:function(){h.j.Xi.apply(this,arguments)&&this.search.prop("disabled",!this.Re())},$i:function(){this.Hd()&&this.close()},_destroy:function(){e("label[for\x3d'"+this.search.attr("id")+"']").attr("for",this.O.element.attr("id"));
h.j._destroy.apply(this,arguments)},Gk:function(){this.selection.data(this.Tb)&&(this.fd([]),this.search.val(""),this.selection.removeData(this.Tb));this.ki()},mj:function(){var a=this;this.O.ae.call(null,this.wf?this.wf:this.O.element,function(b){if(void 0!==b&&null!==b){var c=a.Wb();Array.isArray(c)&&(c=c[0]);a.id(b)!==c&&a.fd(a.id(b));a.Id(b);a.close()}})},Mn:function(b){if(this.Re())if(b.which===a.oa.PAGE_UP||b.which===a.oa.PAGE_DOWN)a.bd(b);else{switch(b.which){case a.oa.UP:case a.oa.DOWN:this.Hd()?
this.$z(b.which===a.oa.UP?-1:1):this.open();a.bd(b);return;case a.oa.ENTER:this.ii(null,b);a.bd(b);return;case a.oa.TAB:this.ii({zm:!0},b);return;case a.oa.Up:this.Nq(b);a.bd(b);return}this.gC=!0;this.Hd()||this.open()}},Ax:function(){this.Re()&&!this.Hd()&&this.open()},Do:function(){var b;b=this.ga;var c=a.Fp(),d;this.selection=b=b.find("."+this.da+"-choice");d=e("label[for\x3d'"+this.O.element.attr("id")+"']");d.attr("id")||d.attr("id",this.da+"-label-"+c);b.find("."+this.da+"-input").attr("id",
this.da+"-input-"+c);this.yb.attr("id","oj-listbox-results-"+c);this.search.attr("aria-owns","oj-listbox-results-"+c);this.search.attr("aria-labelledby",d.attr("id"));this.search.on("keydown",this.Lb(this.Mn));this.search.on("keyup-change input",this.Lb(this.Ax));b.on("mousedown","abbr",this.Lb(function(b){this.Re()&&(this.Gk(),a.JP(b),this.close(),this.selection.focus())}));b.on("mousedown",this.Lb(function(){this.Hd()?this.close():this.Re()&&this.open();this.search.focus()}));b.on("focus",this.Lb(function(b){a.bd(b)}));
this.search.on("blur",this.Lb(function(){this.search.removeClass(this.da+"-focused")}));this.qz();this.O.element.addClass(this.da+"-offscreen");this.ki()},yl:function(){var a=h.j.yl.apply(this,arguments),b=this,c=a.element.get(0).tagName.toLowerCase();if("input"===c&&a.element.prop("list")||"select"===c&&0<a.element.children().length)a.ae=function(a,c){var d,f=b.Wb();Array.isArray(f)&&(f=f[0]);d=void 0!==f&&null!==f?b.fi(a.find("option").filter(function(){return this.value===f})):b.fi(a.find("option").filter(o_c("selected")));
c(d)};else if("data"in a||this.Wb()&&0<this.Wb().length)a.ae=a.ae||function(d,f){var h="";b.Wb()&&b.Wb().length&&(h=b.Wb()[0]);var g=null,k=null;a.Kp({yi:function(b,c,d){(b=h===a.id(d))&&(k=d);g||(g=d);return b},Gb:e.isFunction(f)?function(){k||"select"!==c||(k=g);f(k)}:e.noop})};return a},ki:function(){var a=this.Th();void 0===a&&(a="");this.search.val(a).addClass(this.da+"-default");this.ga.removeClass(this.da+"-allowclear")},xl:function(b,c,d){var f=0,e=this;b=this.Yi();a.cg(b,function(a,b){if(e.Wb()&&
e.Wb()[0]===e.id(b.data(e.Tb)))return f=a,!1});!1!==d&&(!0===c&&0<=f?this.qf(f):this.qf(0))},cA:function(a,b,c){this.WB(a)&&(b=this.Wb()?this.Wb()[0]:null,this.c(),this.Id(a),this.close(),b!==this.id(a)&&this.fd(this.id(a),c))},val:function(){var b,c=null,d=this;this.c();if(0===arguments.length)return this.Wb();b=arguments[0];if(this.wf){var f;f=this.wf.val(b).find("option").filter(o_c("selected"));a.cg(f,function(a,b){c=d.fi(b);return!1});this.fd(b);this.Id(c);this.ki()}else if(b||0===b){if(void 0===
this.O.ae)throw Error("cannot call val() if initSelection() is not defined");this.fd(b);this.O.ae(this.O.element,function(a){d.fd(a?d.id(a):[]);d.Id(a);d.ki()})}else this.Gk()},Ed:function(){this.search.val("")},c:function(a){var b;if(0===arguments.length)return b=this.selection.data(this.Tb),void 0===b&&(b=null),b;a?(this.c(),this.fd(a?this.id(a):[]),this.Id(a)):this.Gk()}}),g=a.Rl(h,{Tb:"ojcombobox",da:"oj-combobox",$q:function(){return e(document.createElement("div")).attr({"class":"oj-combobox oj-component"}).html("\x3cdiv class\x3d'oj-combobox-choice' tabindex\x3d'-1' role\x3d'presentation'\x3e   \x3cspan class\x3d'oj-combobox-search'\x3e\x3cinput type\x3d'text' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off'       spellcheck\x3d'false' class\x3d'oj-combobox-input' role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' /\x3e   \x3c/span\x3e\x3cabbr class\x3d'oj-combobox-search-choice-close' role\x3d'presentation'\x3e\x3c/abbr\x3e   \x3ca class\x3d'oj-combobox-arrow' role\x3d'presentation'\x3e\x3cb class\x3d'oj-combobox-icon oj-component-icon oj-clickable-icon oj-combobox-open-icon' role\x3d'presentation'\x3e\x3c/b\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d'oj-listbox-drop oj-combobox-display-none' role\x3d'presentation'\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e")},
close:function(){this.Hd()&&(g.j.close.apply(this,arguments),""==this.search.val()?this.Gk():this.c()||""===this.search.val?this.search.val(this.c().text):this.Ed())},ei:function(a){var b,c;g.j.ei.apply(this,arguments);b=this.search.get(0);b.createTextRange?(b=b.createTextRange(),b.collapse(!1),b.select()):b.setSelectionRange&&(c=this.search.val().length,b.setSelectionRange(c,c));this.ip(!0);this.O.element.trigger(e.Event("ojexpand"))},Id:function(a){var b;this.selection.data(this.Tb,a);null!==a&&
(b=this.O.QC(a,this.search,this.O.Gt));void 0!==b&&this.search.val(b);this.search.removeClass(this.da+"-default");this.O.lO&&this.ga.addClass(this.da+"-allowclear")}}),k=a.Rl(h,{Tb:"ojselect",da:"oj-select",gC:!1,$q:function(){var a=e(document.createElement("div")).attr({"class":"oj-select oj-component"}).html("\x3cdiv class\x3d'oj-select-choice' tabindex\x3d'0' role\x3d'combobox'      aria-autocomplete\x3d'none' aria-expanded\x3d'false' aria-ready\x3d'true'\x3e  \x3cspan class\x3d'oj-select-box'\x3e    \x3cspan class\x3d'oj-select-chosen'\x3e\x3c/span\x3e    \x3cabbr class\x3d'oj-select-search-choice-close' role\x3d'presentation'\x3e\x3c/abbr\x3e    \x3ca class\x3d'oj-component-icon oj-clickable-icon oj-select-open-icon' role\x3d'presentation'\x3e    \x3cb role\x3d'presentation'\x3e\x3c/b\x3e\x3c/a\x3e  \x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'oj-listbox-drop oj-select-display-none' role\x3d'presentation'\x3e  \x3cdiv class\x3d'oj-select-search-wrapper'\x3e  \x3cdiv class\x3d'oj-select-search'\x3e    \x3cinput type\x3d'text' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off'           spellcheck\x3d'false' class\x3d'oj-select-input' title\x3d'Search field'            role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' /\x3e    \x3cspan class\x3d'oj-select-spyglass-box'\x3e      \x3cspan class\x3d'oj-component-icon oj-select-search-icon' role\x3d'presentation'\x3e       \x3cb role\x3d'presentation'\x3e\x3c/b\x3e\x3c/span\x3e    \x3c/span\x3e  \x3c/div\x3e  \x3c/div\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e");
this.O.element.prop("disabled")&&a.find(".oj-select-choice").attr("tabindex","-1");return a},close:function(){this.Hd()&&(k.j.close.apply(this,arguments),""==this.text.text()?this.Gk():this.Ed(),a.$i(this.selection))},ei:function(a){var b,c;k.j.ei.apply(this,arguments);this.CN();this.Yh()&&(b=this.search.get(0),b.createTextRange?(b=b.createTextRange(),b.collapse(!1),b.select()):b.setSelectionRange&&(c=this.search.val().length,b.setSelectionRange(c,c)));this.ip(!0);this.O.element.trigger(e.Event("ojexpand"))},
Do:function(){this.text=this.ga.find(".oj-select-chosen");k.j.Do.apply(this,arguments);this.ga.find(".oj-select-choice").attr("aria-owns",this.search.attr("aria-owns")).attr("aria-labelledby",this.search.attr("aria-labelledby"));this.selection.on("keydown",this.Lb(this.Mn));this.selection.on("keyup-change input",this.Lb(this.Ax))},mj:function(){this.Ez()?(this.Id(null),this.close(),this.ki()):k.j.mj.apply(this,arguments)},Id:function(a){this.selection.data(this.Tb,a);null!==a&&this.text.text(a.text);
this.text.removeClass(this.da+"-default");this.O.lO&&this.ga.addClass(this.da+"-allowclear")},fo:function(){return this.search.attr("aria-expanded")&&this.Yh()?this.search:this.selection},cl:function(){var a=this.O.element.children("option").first();if(""===a.text()&&""===a.val())return a},Ez:function(){var a;if(!this.Th())return!1;var b=this.Wb();return void 0!==(a=this.cl())&&a.prop("selected")||""===b||void 0===b||null===b},Th:function(){return void 0===this.cl()?void 0:k.j.Th.apply(this,arguments)},
ki:function(){var a=this.Th();this.Ez()&&void 0!==a&&void 0!==this.cl()&&(void 0===a&&(a=""),this.text.text(a).addClass(this.da+"-default"),this.ga.removeClass(this.da+"-allowclear"))},Hk:function(){this.text.hasClass(this.da+"-default")&&this.text.val("").removeClass(this.da+"-default")},fd:function(a,b){k.j.fd.call(this,a,b);this.selection.data("selectVal",a)},Mn:function(b){a.oa.AD(b)||a.oa.BD(b)||(b.which===a.oa.TAB?(this.ii({zm:!0},b),this.selection.focus()):k.j.Mn.apply(this,arguments))},CN:function(){var b=
!1,c=this.jc.find(".oj-select-search");c&&(this.Yh()?(this.jc.find(".oj-select-search-wrapper").removeClass("oj-helper-hidden-accessible"),e(c).removeAttr("aria-hidden"),b=!0):(this.jc.find(".oj-select-search-wrapper").addClass("oj-helper-hidden-accessible"),e(c).attr({"aria-hidden":"true"})));a.$i(b?this.search:this.selection)},Yh:function(){return(this.wf?this.wf[0].length:this.O.data.length)>this.O.minimumResultsForSearch||this.gC}});b.ta("oj.ojCombobox",e.oj.editableValue,{version:"1.0.0",defaultElement:"\x3cinput\x3e",
widgetEventPrefix:"oj",options:{placeholder:"",multiple:!1,data:null,expand:null},widget:function(){return this.te.ga},Ic:function(){this._super();this.kb()},kb:function(){var a,b=this.options.multiple;a={};a.element=this.element;a.cf=this;a=e.extend(this.options,a);this.te=b?new l:new g;this.te._init(a)},_destroy:function(){this.te._destroy()},refresh:function(){this._super();this.te._destroy();this.kb()},expand:function(a){this.te.open();this._trigger("ojexpand",a)},collapse:function(){this.te.close()},
_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.te.Wx():this.te.Xn():"value"===a&&this.te.mj()},_GetMessagingLauncherElement:function(){return this.te.ga},_GetDefaultStyleClass:o_d("oj-combobox"),getNodeBySubId:function(a){if(null==a)return this.te.ga?this.te.ga[0]:null;a=a.subId;"oj-combobox-drop"==a&&(a="oj-listbox-drop");"oj-combobox-results"==a&&(a="oj-listbox-results");switch(a){case "oj-combobox-input":case "oj-combobox-arrow":case "oj-listbox-drop":case "oj-listbox-results":return this.widget().find(a)[0]}return null}});
b.ta("oj.ojSelect",e.oj.editableValue,{version:"1.0.0",defaultElement:"\x3cselect\x3e",widgetEventPrefix:"oj",options:{minimumResultsForSearch:10,placeholder:"",data:null,expand:null},widget:function(){return this.select.ga},Ic:function(){this.kb();this._super()},kb:function(){var a={};a.element=this.element;a.cf=this;a=e.extend(this.options,a);this.select=new k;this.select._init(a)},refresh:function(){this._super();this.select._destroy();this.kb()},_destroy:function(){this.select._destroy()},expand:function(){this.select.open()},
collapse:function(){this.select.close()},_SetPlaceholder:function(a){this._super(a);this.select.O.placeholder=a;this.select.ki()},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.select.Wx():this.select.Xn():"data"===a?this.kb():"value"===a&&this.select.mj()},getNodeBySubId:function(a){if(null==a)return this.select.ga?this.select.ga[0]:null;a=a.subId;"oj-select-drop"==a&&(a="oj-listbox-drop");"oj-select-results"==a&&(a="oj-listbox-results");switch(a){case "oj-select-chosen":case "oj-select-search":case "oj-listbox-drop":case "oj-listbox-results":return this.widget().find("."+
a)[0]}return null},_GetDefaultStyleClass:o_d("oj-select"),_GetMessagingLauncherElement:function(){return this.select.ga}});var l=a.Rl(d,{Tb:"ojcombobox",da:"oj-combobox",$q:function(){return e(document.createElement("div")).attr({"class":"oj-combobox oj-combobox-multi oj-component"}).html("\x3cul class\x3d'oj-combobox-choices'\x3e  \x3cli class\x3d'oj-combobox-search-field'\x3e    \x3cinput type\x3d'text' role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off' spellcheck\x3d'false' class\x3d'oj-combobox-input'\x3e  \x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'oj-combobox-description oj-helper-hidden-accessible'/\x3e\x3cdiv class\x3d'oj-listbox-drop oj-listbox-drop-multi oj-combobox-display-none'\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e")},
yl:function(){var b=l.j.yl.apply(this,arguments),c=this;"input"===b.element.get(0).tagName.toLowerCase()&&b.element.prop("list")?b.ae=function(d,f){var e=[];if(b.element.val())for(var h,g=a.Op(b.element.val(),b.separator),k=0;k<g.length;k++){var l=g[k];h=d.find("option").filter(function(){return this.value===l});e.push(c.fi(h))}else h=d.find("option").filter(o_c("selected")),a.cg(h,function(a,b){e.push(c.fi(b))});f(e)}:"data"in b&&(b.ae=b.ae||function(c,d){var f=a.Op(c.val(),b.separator),h=[];b.Kp({yi:function(a,
c,d){(a=e.grep(f,function(a){return a===b.id(d)}).length)&&h.push(d);return a},Gb:e.isFunction(d)?function(){for(var a=[],c=0;c<f.length;c++)for(var e=f[c],g=0;g<h.length;g++){var k=h[g];if(e===b.id(k)){a.push(k);h.splice(g,1);break}}d(a)}:e.noop})});return b},Bj:function(a){var b=this.ga.find("."+this.da+"-search-choice-focus");b.length&&a&&a[0]==b[0]||(b.length&&this.O.element.trigger("choice-deselected",b),b.removeClass(this.da+"-search-choice-focus"),a&&a.length&&(this.close(),a.addClass(this.da+
"-search-choice-focus"),this.ga.find(".oj-combobox-description").html(a.attr("valueText")+". Press back space to delete.").attr("aria-live","assertive"),this.O.element.trigger("choice-selected",a)))},_destroy:function(){e("label[for\x3d'"+this.search.attr("id")+"']").attr("for",this.O.element.attr("id"));l.j._destroy.apply(this,arguments)},Do:function(){var b="."+this.da+"-choices",c,d=a.Fp(),f;this.lQ=this.ga.find("."+this.da+"-search-field");this.selection=c=this.ga.find(b);var h=this;this.selection.on("click",
"."+this.da+"-search-choice:not(."+this.da+"-locked)",function(){h.search[0].focus();h.Bj(e(this))});f=e("label[for\x3d'"+this.O.element.attr("id")+"']");f.attr("id")||f.attr("id",this.da+"-label-"+d);this.yb.attr("id","oj-listbox-results-"+d);this.search.attr("aria-owns","oj-listbox-results-"+d);this.search.attr("aria-labelledby",f.attr("id"));this.search.on("input paste",this.Lb(function(){this.Re()&&!this.Hd()&&this.open()}));this.search.attr("tabindex",this.Ft);this.fu=0;this.search.on("keydown",
this.Lb(function(b){if(this.Re()){++this.fu;var d=c.find("."+this.da+"-search-choice-focus"),f=d.prev("."+this.da+"-search-choice:not(."+this.da+"-locked)"),e=d.next("."+this.da+"-search-choice:not(."+this.da+"-locked)"),h=a.bP(this.search);if(!d.length||b.which!=a.oa.LEFT&&b.which!=a.oa.RIGHT&&b.which!=a.oa.Km&&b.which!=a.oa.Qu&&b.which!=a.oa.ENTER)if((b.which!==a.oa.Km||1!=this.fu)&&b.which!=a.oa.LEFT||0!=h.offset||h.length){this.Bj(null);if(this.Hd())switch(b.which){case a.oa.UP:case a.oa.DOWN:this.$z(b.which===
a.oa.UP?-1:1);a.bd(b);return;case a.oa.ENTER:this.ii();a.bd(b);return;case a.oa.TAB:this.ii({zm:!0});this.close();return;case a.oa.Up:this.Nq(b);a.bd(b);return}b.which===a.oa.TAB||(a.oa.AD(b)||a.oa.BD(b)||b.which===a.oa.Km||b.which===a.oa.Up)||b.which===a.oa.ENTER&&(!1===this.O.VP||b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(this.open(),b.which!==a.oa.PAGE_UP&&b.which!==a.oa.PAGE_DOWN||a.bd(b),b.which===a.oa.ENTER&&a.bd(b))}else this.Bj(c.find("."+this.da+"-search-choice:not(."+this.da+"-locked)").last()),
a.bd(b);else h=d,b.which==a.oa.LEFT&&f.length?h=f:b.which==a.oa.RIGHT?h=e.length?e:null:b.which===a.oa.Km?(this.mt(d.first()),this.search.width(10),h=f.length?f:e):b.which==a.oa.Qu?(this.mt(d.first()),this.search.width(10),h=e.length?e:null):b.which==a.oa.ENTER&&(h=null),this.Bj(h),a.bd(b),h&&h.length||this.open()}}));this.search.on("keyup",this.Lb(function(){this.fu=0;this.Us()}));this.search.on("blur",this.Lb(function(a){this.search.removeClass(this.da+"-focused");this.Bj(null);this.Hd()||this.Ed();
a.stopImmediatePropagation()}));this.ga.on("click",b,this.Lb(function(a){!this.Re()||0<e(a.target).closest("."+this.da+"-search-choice").length||(this.Bj(null),this.Hk(),this.open(),this.Sk(),a.preventDefault())}));this.ga.on("focus",b,this.Lb(function(){this.Re()&&this.Hk()}));this.qz();this.O.element.addClass(this.da+"-offscreen");this.Ed()},Xi:function(){l.j.Xi.apply(this,arguments)&&this.search.prop("disabled",!this.Re())},mj:function(){""===this.O.element.val()&&""===this.O.element.text()&&(this.Id([]),
this.close(),this.Ed());if(this.wf||""!==this.O.element.val()){var a=this;this.O.ae.call(null,this.wf?this.wf:this.O.element,function(b){void 0!==b&&null!==b&&(a.Id(b),a.close(),a.Ed())})}},Ed:function(){var a=this.Th(),b=this.pJ();void 0===a||this.Wb()&&0!==this.Wb().length?this.search.val("").width(10):(this.search.val(a).addClass(this.da+"-default"),this.search.width(0<b?b:this.ga.css("width")))},Hk:function(){this.search.hasClass(this.da+"-default")&&this.search.val("").removeClass(this.da+"-default")},
ei:function(a){this.Us();l.j.ei.apply(this,arguments);this.Sk();this.ip(!0);this.search.focus();this.O.element.trigger(e.Event("ojexpand"))},close:function(){this.Hd()&&(this.Ed(),l.j.close.apply(this,arguments))},$i:function(){this.close();this.search.focus()},Id:function(a){var b=[],c=[],d=this;e(a).each(function(){0>b.indexOf(d.id(this))&&(b.push(d.id(this)),c.push(this))});a=c;this.selection.find("."+this.da+"-search-choice").remove();e(a).each(function(){d.Bw(this)});d.xl()},cA:function(a,b){this.WB(a)&&
(this.Bw(a),!this.select&&this.O.At||this.xl(a,!1,!0===this.O.At),this.O.At?(this.close(),this.search.width(10)):0<this.Yi().length?(this.Ed(),this.search.width(10),this.Us(),this.vj()):(this.close(),this.search.width(10)),this.Ll(),b&&b.zm||this.Sk())},Nq:function(){this.close();this.Sk()},Bw:function(b){var c=!b.locked,d=e("\x3cli class\x3d'"+this.da+"-search-choice'\x3e    \x3cdiv\x3e\x3c/div\x3e    \x3ca href\x3d'#' onclick\x3d'return false;' class\x3d'"+this.da+"-search-choice-close' tabindex\x3d'-1'\x3e\x3c/a\x3e\x3c/li\x3e"),
f=e("\x3cli class\x3d'"+this.da+"-search-choice "+this.da+"-locked'\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e"),d=c?d:f,h=this.id(b),g=this.Wb(),f=this.O.QC(b,d.find("div"),this.O.Gt);void 0!==f&&(d.find("div").replaceWith("\x3cdiv\x3e"+f+"\x3c/div\x3e"),d.attr("valueText",f));if(c)d.find("."+this.da+"-search-choice-close").on("mousedown",a.bd).on("click dblclick",this.Lb(function(b){this.Re()&&(e(b.target).closest("."+this.da+"-search-choice").fadeOut("fast",this.Lb(function(){this.mt(e(b.target));this.selection.find("."+
this.da+"-search-choice-focus").removeClass(this.da+"-search-choice-focus");this.close();this.Sk()})).dequeue(),a.bd(b))}));d.data(this.Tb,b);d.insertBefore(this.lQ);e(b).each(function(){0>g.indexOf(h)&&g.push(h)});this.fd(g)},mt:function(a){var b=this.Wb(),c,d;a=a.closest("."+this.da+"-search-choice");if(0===a.length)throw"Invalid argument: "+a+". Must be ."+this.da+"-search-choice";if(c=a.data(this.Tb)){for(;0<=(d=b.indexOf(this.id(c)));)b.splice(d,1),this.fd(b),this.select&&this.xl();a.remove();
this.Ll()}},xl:function(b,c,d){var f=this.Wb();c=this.yb.find(".oj-listbox-result");var e=this.yb.find(".oj-listbox-result-with-children"),h=this;a.cg(c,function(a,b){var c=h.id(b.data(h.Tb));0<=f.indexOf(c)&&(b.addClass("oj-listbox-selected"),b.find(".oj-listbox-result-selectable").addClass("oj-listbox-selected"))});a.cg(e,function(a,b){b.is(".oj-listbox-result-selectable")||0!==b.find(".oj-listbox-result-selectable:not(.oj-listbox-selected)").length||b.addClass("oj-listbox-selected")});-1==this.qf()&&
!1!==d&&h.qf(0);!this.O.lu&&0<!c.filter(".oj-listbox-result:not(.oj-listbox-selected)").length&&(!b||b&&!b.RP&&0===this.yb.find(".oj-listbox-no-results").length)&&a.vC(h.cf,h.O.qp,"formatNoMatches")&&this.yb.append("\x3cli class\x3d'oj-listbox-no-results'\x3e"+h.O.qp(h.cf,h.search.val())+"\x3c/li\x3e")},pJ:function(){return this.selection.width()-a.iD(this.search)},Us:function(){var b,c,d,f,e=a.iD(this.search);b=this.search.width()+10;c=this.search.offset().left;d=this.selection.width();f=this.selection.offset().left;
c=d-(c-f)-e;c<b&&(c=d-e);40>c&&(c=d-e);0>=c&&(c=b);this.search.width(Math.floor(c))},Wb:function(){var b;b=this.O.element.val();return a.Op(b,this.O.separator)},fd:function(b){var c;c=[];"string"===typeof b&&(b=a.Op(b,this.O.separator));e(b).each(function(){0>c.indexOf(this)&&c.push(this)});this.O.element.val(0===c.length?"":c.join(this.O.separator));this.search.attr("aria-activedescendant",this.O.element.attr("id"))},val:function(a){var b,c=this;if(0===arguments.length)return this.Wb();b=this.c();
b.length||(b=[]);if(a||0===a){this.fd(a);if(this.select)this.O.ae(this.select,this.Lb(this.Id)),this.Ll();else{if(void 0===this.O.ae)throw Error("cannot call val() if initSelection() is not defined");this.O.ae(this.O.element,function(a){var b=e.map(a,c.id);c.fd(b);c.Id(a);c.Ed();c.Ll()})}this.Ed()}else this.O.element.val(null),this.Id([]),this.Ed(),this.Ll()},c:function(a){var b=this,c;if(0===arguments.length)return this.selection.find("."+this.da+"-search-choice").map(function(){return e(this).data(b.Tb)}).get();
this.c();a||(a=[]);c=e.map(a,function(a){return b.O.id(a)});this.fd(c);this.Id(a);this.Ed()}})});
//# sourceMappingURL=oj-modular.map