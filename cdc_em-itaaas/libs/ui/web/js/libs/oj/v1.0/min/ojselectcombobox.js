define(["ojs/ojcore","jquery","ojs/ojeditablevalue"],function(b,e){var a={oa:{TAB:9,ENTER:13,dq:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,hF:16,KE:17,JE:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,Tm:8,bv:46,HS:function(b){b=b.which?b.which:b;switch(b){case a.oa.LEFT:case a.oa.RIGHT:case a.oa.UP:case a.oa.DOWN:return!0}return!1},QD:function(b){switch(b.which){case a.oa.hF:case a.oa.KE:case a.oa.JE:return!0}return b.metaKey?!0:!1},RD:function(a){a=a.which?a.which:a;return 112<=a&&123>=a}},vu:{x:0,y:0},
Op:function(){var a=1;return function(){return a++}}(),Mu:null,gg:function(a,b){for(var c=e(a[0]),d=-1,f=a.length;++d<f&&(c.context=c[0]=a[d])&&!1!==b.call(c[0],d,c););return a},iQ:function(){var a=e("\x3cdiv class\x3d'oj-listbox-measure-scrollbar'\x3e\x3c/div\x3e");a.appendTo("body");var b={width:a.width()-a[0].clientWidth,height:a.height()-a[0].clientHeight};a.remove();return b},Xp:function(a,b){var c,d,f;if(null===a||1>a.length)return[];c=a.split(b);d=0;for(f=c.length;d<f;d+=1)c[d]=e.trim(c[d]);
return c},uD:function(a){return a.outerWidth(!1)-a.width()},YP:function(b){b.on("keydown",function(){void 0===e.data(b,"keyup-change-value")&&e.data(b,"keyup-change-value",b.val())});b.on("keyup",function(c){c.which===a.oa.ENTER?c.stopPropagation():(c=e.data(b,"keyup-change-value"),void 0!==c&&b.val()!==c&&(e.removeData(b,"keyup-change-value"),b.trigger("keyup-change")))})},XP:function(b){b.on("mousemove",function(b){var c=a.vu;if(void 0===c||c.x!==b.pageX||c.y!==b.pageY)e(b.target).trigger("mousemove-filtered",
b),a.vu.x=b.pageX,a.vu.y=b.pageY})},UQ:function(a){var b=!1,c;return function(){!1===b&&(c=a(),b=!0);return c}},ij:function(a){a[0]!==document.activeElement&&window.setTimeout(function(){var b=a[0],c=a.val().length;a.focus();a.is(":visible")&&b===document.activeElement&&(b.setSelectionRange?b.setSelectionRange(c,c):b.createTextRange&&(b=b.createTextRange(),b.collapse(!1),b.select()))},0)},vP:function(a){a=e(a)[0];var b=0,c=0;"selectionStart"in a?(b=a.selectionStart,c=a.selectionEnd-b):"selection"in
document&&(a.focus(),b=document.selection.createRange(),c=document.selection.createRange().text.length,b.moveStart("character",-a.value.length),b=b.text.length-c);return{offset:b,length:c}},Ac:function(a){a.preventDefault();a.stopPropagation()},dQ:function(a){a.preventDefault();a.stopImmediatePropagation()},hP:function(a){var b={"\\":"\x26#92;","\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};return String(a).replace(/[&<>"'\\]/g,function(a){return b[a]})},fQ:function(b){function c(a){return""+
a.text}var d=b,f,h;e.isArray(d)&&(h=d,d={Bb:h});!1===e.isFunction(d)&&(h=d,d=function(){return h});b=d();b.text&&(c=b.text,e.isFunction(c)||(f=b.text,c=function(a){return a[f]}));return function(b){var f=b.Uu,h={Bb:[]},p;""===f?b.Hb(d()):(p=function(d,h){var g,m;d=d[0];if(d.children){g={};for(m in d)d.hasOwnProperty(m)&&(g[m]=d[m]);g.children=[];a.gg(e(d.children),function(a,b){p(b,g.children)});(g.children.length||b.Fi(f,c(g),d))&&h.push(g)}else b.Fi(f,c(d),d)&&h.push(d)},a.gg(e(d().Bb),function(a,
b){p(b,h.Bb)}),b.Hb(h))}},GC:function(a,b,c){if(e.isFunction(b))return!0;if(!b)return!1;throw Error(c+" must be a function or a false value");},dm:function(a,c){function d(){}b.a.ga(d,a,"");d.prototype=e.extend(d.prototype,c);return d}},d=a.dm(Object,{Mb:function(a){var b=this;return function(){a.apply(b,arguments)}},_init:function(b){var c,d=this.da,f=this.Ub;this.cf=b.cf;this.O=b=this.Jl(b);this.id=b.id;void 0!==b.element.data(f)&&null!==b.element.data(f)&&b.element.data(f)._destroy();this.fa=this.kr();
this.fm="ojChoiceId_"+(b.element.attr("id")||"autogen"+a.Op());this.qS="#"+this.fm.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.fa.attr("id",this.fm);this.body=a.UQ(function(){return b.element.closest("body")});this.fa.attr("style",b.element.attr("style"));this.Tt=this.O.element.attr("tabindex");this.O.element.data(f,this).attr("tabindex","-1").before(this.fa);this.fa.data(f,this);this.kc=this.fa.find(".oj-listbox-drop");this.kc.data(f,this);this.kc.on("click",a.Ac);this.Bb=this.fa.find(".oj-listbox-results");
this.search=c=this.fa.find("input."+d+"-input");this.Ku=this.mE=0;this.context=null;this.Ko();this.fa.on("click",a.Ac);a.XP(this.Bb);this.kc.on("mousemove-filtered touchstart touchmove touchend",".oj-listbox-results",this.Mb(this.zz));e(this.fa).on("change","."+d+"-input",function(a){a.stopPropagation()});e(this.kc).on("change","."+d+"-input",function(a){a.stopPropagation()});a.YP(c);c.on("keyup-change input paste",this.Mb(this.rp));c.on("focus",function(){c.addClass(d+"-focused")});c.on("blur",function(){c.removeClass(d+
"-focused")});this.kc.on("mouseup",".oj-listbox-results",this.Mb(function(a){0<e(a.target).closest(".oj-listbox-result-selectable").length&&(this.zz(a),this.pi(null,a))}));this.kc.on("click mouseup mousedown",function(a){a.stopPropagation()});e.isFunction(this.O.ce)&&(!b.value||"ojcombobox"!==this.Ub&&Array.isArray(b.value)||this.hd(b.value),this.wj());f=b.element.prop("disabled");void 0===f&&(f=!1);this.eo(!f);f=b.element.prop("readonly");void 0===f&&(f=!1);this.Kl(f);a.Mu=a.Mu||a.iQ();this.autofocus=
b.element.prop("autofocus");b.element.prop("autofocus",!1);this.autofocus&&this.ij()},_destroy:function(){var a=this.O.element,b=a.data(this.Ub);this.close();this.lE&&(delete this.lE,this.lE=null);void 0!==b&&(b.fa.remove(),b.kc.remove(),a.removeClass(this.da+"-offscreen").removeData(this.Ub).off("."+this.da).prop("autofocus",this.autofocus||!1),this.Tt?a.attr({ZS:this.Tt}):a.removeAttr("tabindex"),a.show())},mi:function(a){if(a.is("option"))return{id:a.prop("value"),text:a.text(),element:a.get(),
css:a.attr("class"),disabled:a.prop("disabled"),locked:"locked"===a.attr("locked")||!0===a.data("locked")};if(a.is("optgroup"))return{text:a.attr("label"),children:[],element:a.get(),css:a.attr("class")}},Jl:function(b){var d,h,g,p=this;d=b.element;var k=d.get(0).tagName.toLowerCase();"input"===k&&d.attr("list")?this.yf=h=e("#"+d.attr("list")):"select"===k&&0<d.children().length&&(this.yf=h=d);b=e.extend({},{tQ:function(c,d,f){var h,g=this.O.id;h=function(c,d,k){var l,s,n,v,u,q;l=0;for(s=c.length;l<
s;l+=1)n=c[l],u=!0===n.disabled,v=!u&&void 0!==g(n),q=e("\x3cli\x3e\x3c/li\x3e"),q.addClass("oj-listbox-results-dept-"+k),q.addClass("oj-listbox-result"),q.addClass(v?"oj-listbox-result-selectable":"oj-listbox-result-unselectable"),u&&q.addClass("oj-disabled"),n.children&&q.addClass("oj-listbox-result-with-children"),q.attr("role","presentation"),v=e(document.createElement("div")),v.addClass("oj-listbox-result-label"),v.attr("id","oj-listbox-result-label-"+a.Op()),v.attr("role","option"),u&&v.attr("aria-disabled",
"true"),u=b.qP(n,v,f,p.O.Ut),void 0!==u&&v.html(u),q.append(v),n.children&&0<n.children.length&&(u=e("\x3cul\x3e\x3c/ul\x3e"),u.addClass("oj-listbox-result-sub"),h(n.children,u,k+1),q.append(u)),q.data(p.Ub,n),d.append(q)};h(d,c,0)}},c,"select"===k?null:f,b);"function"!==typeof b.id&&(g=b.id,b.id=function(a){return a[g]});h?(b.Tp=this.Mb(function(b){var c={Bb:[],lQ:!1},d=b.Uu,f,e;e=function(c,f){var h;c.is("option")?b.Fi(d,c.text(),c)&&f.push(p.mi(c)):c.is("optgroup")&&(h=p.mi(c),a.gg(c.children(),
function(a,b){e(b,h.children)}),0<h.children.length&&f.push(h))};f=h.children();if(void 0!==this.Zh()&&0<f.length){var g=this.ol();g&&(f=f.not(g))}a.gg(f,function(a,b){e(b,c.Bb)});b.Hb(c)}),b.id=function(a){return a.id}):"data"in b&&(b.Tp=a.fQ(b.data));return b},gC:function(a){a=e.Event(this.Ub+"-selecting",{val:this.id(a),object:a});this.O.element.trigger(a);return!a.isDefaultPrevented()},Xl:function(){this.cf.Ne(this.Xb())},Re:function(){return!0===this.XC},fj:function(){var a=this.Dr&&!this.Kl;
if(a===this.XC)return!1;this.fa.toggleClass("oj-disabled",!a);this.close();this.XC=a;return!0},eo:function(a){void 0===a&&(a=!0);this.Dr!==a&&(this.Dr=a,this.O.element.prop("disabled",!a),this.fj())},hy:function(){this.eo(!1)},Kl:function(a){void 0===a&&(a=!1);if(this.Kl===a)return!1;this.Kl=a;this.O.element.prop("readonly",a);this.fj();return!0},rd:function(){return this.fa.hasClass("oj-listbox-dropdown-open")},Dj:function(){var b=this.kc,c=this.fa.offset(),d=this.fa.outerHeight(!1),f=this.fa.outerWidth(!1),
h=b.outerHeight(!1),g=e(window),k=g.width(),l=g.height(),y=g.scrollLeft()+k,w=g.scrollTop()+l,d=c.top+d,z=c.left,w=d+h<=w,x=c.top-h>=this.body().scrollTop(),C=b.outerWidth(!1),t=z+C<=y,A;b.hasClass("oj-listbox-drop-above")?(h=!0,!x&&w&&(A=!0,h=!1)):(h=!1,!w&&x&&(h=A=!0));A?(b.hide(),c=this.fa.offset(),d=this.fa.outerHeight(!1),f=this.fa.outerWidth(!1),b.outerHeight(!1),y=g.scrollLeft()+k,g.scrollTop(),d=c.top+d,!h&&this.di()&&(d-=1),z=c.left,C=b.outerWidth(!1),t=z+C<=y,b.show()):!h&&this.di()&&(d-=
1);this.O.vS?(g=e(".oj-listbox-results",b)[0],b.addClass("oj-listbox-drop-auto-width"),b.css("width",""),C=b.outerWidth(!1)+(g.scrollHeight===g.clientHeight?0:a.Mu.width),C>f?f=C:C=f,t=z+C<=y):this.fa.removeClass("oj-listbox-drop-auto-width");"static"!==this.body().css("position")&&(y=this.body().offset(),d-=y.top,z-=y.left);t||(z=c.left+f-C);f={left:z,width:f};h?(f.bottom=l-c.top,f.top="auto",this.fa.addClass("oj-listbox-drop-above"),b.addClass("oj-listbox-drop-above")):(f.top=d,f.bottom="auto",
this.fa.removeClass("oj-listbox-drop-above"),b.removeClass("oj-listbox-drop-above"));b.css(f)},SN:function(){var a;if(this.rd()||!1===this.Dr||!0===this.Kl)return!1;a=e.Event(this.Ub+"-opening");this.O.element.trigger(a);return!a.isDefaultPrevented()},Dx:function(){this.fa.removeClass("oj-listbox-drop-above");this.kc.removeClass("oj-listbox-drop-above")},open:function(){if(!this.SN())return!1;this.li();return!0},Tk:function(){this.search.hasClass(this.da+"-default")&&this.search.val("").removeClass(this.da+
"-default")},li:function(){var a=this.fm,b="scroll."+a,c="resize."+a,d="orientationchange."+a,f=this.Ub,h;this.Tk();this.fa.addClass("oj-listbox-dropdown-open");this.Dx();this.kc[0]!==this.body().children().last()[0]&&this.kc.detach().appendTo(this.body());h=e("#oj-listbox-drop-mask"+a);0==h.length&&(h=e(document.createElement("div")),h.attr("id","oj-listbox-drop-mask"+a).attr("class","oj-listbox-drop-mask"),h.hide(),h.appendTo(this.body()),h.on("mousedown touchstart click",function(a){var b=e("#oj-listbox-drop");
0<b.length&&(b=b.data(f),b.O.IQ&&b.pi({Im:!0},a),b.close(),a.preventDefault(),a.stopPropagation())}));this.kc.prev()[0]!==h[0]&&this.kc.before(h);e("#oj-listbox-drop").removeAttr("id");this.kc.attr("id","oj-listbox-drop");h.show();this.Dj();this.kc.show();this.Dj();this.no().attr("aria-expanded",!0);var g=this;this.fa.parents().add(window).each(function(){e(this).on(c+" "+b+" "+d,function(){g.Dj()})})},close:function(){if(this.rd()){var a=this.fm,b="scroll."+a,c="resize."+a,d="orientationchange."+
a;this.fa.parents().add(window).each(function(){e(this).off(b).off(c).off(d)});this.Dx();e("#oj-listbox-drop-mask"+this.fm).hide();this.kc.removeAttr("id");this.kc.hide();this.fa.removeClass("oj-listbox-dropdown-open");this.Bb.empty();this.no().attr("aria-expanded",!1)}},Hd:o_a(),TI:function(){var a=this.Bb,b,c,d,f;c=this.sf();0>c||(0==c?a.scrollTop(0):(b=this.gj().find(".oj-listbox-result-label"),d=e(b[c]),f=d.offset().top+d.outerHeight(!0),c===b.length-1&&(b=a.find("li.oj-listbox-more-results"),
0<b.length&&(f=b.offset().top+b.outerHeight(!0))),b=a.offset().top+a.outerHeight(!0),f>b&&a.scrollTop(a.scrollTop()+(f-b)),f=d.offset().top-a.offset().top,0>f&&"none"!=d.css("display")&&a.scrollTop(a.scrollTop()+f)))},gj:function(){return this.Bb.find(".oj-listbox-result-selectable:not(.oj-disabled, .oj-listbox-selected)")},lA:function(a){for(var b=this.gj(),c=this.sf();-1<c&&c<b.length;){var c=c+a,d=e(b[c]);if(d.hasClass("oj-listbox-result-selectable")&&!d.hasClass("oj-disabled")&&!d.hasClass("oj-listbox-selected")){this.sf(c);
break}}},sf:function(a){var b=this.gj();if(0===arguments.length)return b.get().indexOf(b.filter(".oj-listbox-highlighted")[0]);a>=b.length&&(a=b.length-1);0>a&&(a=0);this.dt();b=e(b[a]);b.addClass("oj-listbox-highlighted");this.no().attr("aria-activedescendant",b.find(".oj-listbox-result-label").attr("id"));this.TI()},dt:function(){this.Bb.find(".oj-listbox-highlighted").removeClass("oj-listbox-highlighted")},zz:function(a){a=e(a.target).closest(".oj-listbox-result-selectable");if(0<a.length&&!a.is(".oj-listbox-highlighted")){var b=
this.gj();this.sf(b.index(a))}else 0==a.length&&this.dt()},rp:function(b){function c(a){f.html(a);g.Dj()}var d=this.search,f=this.Bb,h=this.O,g=this,k;k=d.val();var l=e.data(this.fa,this.da+"-last-term"),y;!0!==b&&l&&k===l||(e.data(this.fa,this.da+"-last-term",k),y=++this.mE,this.dt(),k=this.search.val(),this.Ku=1,h.Tp({element:h.element,Uu:void 0!==k&&null!=k&&!0!==b?k:"",page:this.Ku,context:null,Fi:h.Fi,Hb:this.Mb(function(k){var l;y==this.mE&&this.rd()&&(this.context=void 0===k.context?null:k.context,
0===k.Bb.length&&(this.O.zu&&""!==d.val())&&(l=this.O.zu.call(g,d.val(),k.Bb),void 0!==l&&null!==l&&void 0!==g.id(l)&&null!==g.id(l)&&0===e(k.Bb).filter(function(){return g.id(this)===g.id(l)}).length&&k.Bb.unshift(l)),0===k.Bb.length&&a.GC(g.cf,h.Ap,"formatNoMatches")?c("\x3cli class\x3d'oj-listbox-no-results'\x3e"+h.Ap(g.cf,d.val())+"\x3c/li\x3e"):(f.empty(),g.O.tQ.call(this,f,k.Bb,{Uu:d.val(),page:this.Ku,context:null}),this.Il(k,b),g.Dj()))})}))},Xq:function(){this.close()},dl:function(){a.ij(this.search)},
pi:function(a,b){var c=this.sf(),d=this.Bb.find(".oj-listbox-highlighted").closest(".oj-listbox-result").data(this.Ub);d?(this.sf(c),this.oA(d,a,b)):a&&a.Im&&this.close()},Zh:function(){return this.O.element.attr("placeholder")||this.O.element.attr("data-placeholder")||this.O.element.data("placeholder")||this.O.placeholder},ol:o_a(),Cz:function(){var a;a:{var b,c,d;a=this.O.element.attr("style");if(void 0!==a)for(a=a.split(";"),c=0,d=a.length;c<d;c+=1)if(b=a[c].replace(/\s/g,""),b=b.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),
null!==b&&1<=b.length){a=b[1];break a}a=void 0}null!==a&&this.fa.css("width",a)},Xb:function(){return this.cf.option("value")},hd:function(a,b){"string"===typeof a?this.cf.Ne([a],b):this.cf.Ne(a,b);this.O.element.val(a)},no:o_c("search"),di:function(){return void 0!==this.O.minimumResultsForSearch&&void 0!==this.fa.di}}),c={Ot:!0,oQ:!0,qP:function(a,b,c,d){b=[];b.push(d(a.text));return b.join("")},$C:function(a,b,c){return a&&a.text?c(a.text):void 0},Ap:o_d("No matches found"),id:function(a){return a.id},
Fi:function(a,b){return 0<=(""+b).toUpperCase().indexOf((""+a).toUpperCase())},separator:",",Ut:a.hP,nS:!1,IQ:!1},f={zu:function(a){return{id:e.trim(a),text:e.trim(a)}}},h=a.dm(d,{fj:function(){h.j.fj.apply(this,arguments)&&this.search.prop("disabled",!this.Re())},ij:function(){this.rd()&&this.close()},_destroy:function(){e("label[for\x3d'"+this.search.attr("id")+"']").attr("for",this.O.element.attr("id"));h.j._destroy.apply(this,arguments)},Sk:function(){this.selection.data(this.Ub)&&(this.hd([]),
this.search.val(""),this.selection.removeData(this.Ub));this.ri()},wj:function(){var a=this;this.O.ce.call(null,this.yf?this.yf:this.O.element,function(b){if(void 0!==b&&null!==b){var c=a.Xb();Array.isArray(c)&&(c=c[0]);a.id(b)!==c&&a.hd(a.id(b));a.Kd(b);a.close()}})},Tn:function(b){if(this.Re())if(b.which===a.oa.PAGE_UP||b.which===a.oa.PAGE_DOWN)a.Ac(b);else{switch(b.which){case a.oa.UP:case a.oa.DOWN:this.rd()?this.lA(b.which===a.oa.UP?-1:1):this.open();a.Ac(b);return;case a.oa.ENTER:this.pi(null,
b);a.Ac(b);return;case a.oa.TAB:this.pi({Im:!0},b);return;case a.oa.dq:this.Xq(b);a.Ac(b);return}this.rC=!0;this.rd()||this.open()}},Lx:function(){this.Re()&&!this.rd()&&this.open()},Ko:function(){var b;b=this.fa;var c=a.Op(),d;this.selection=b=b.find("."+this.da+"-choice");d=e("label[for\x3d'"+this.O.element.attr("id")+"']");d.attr("id")||d.attr("id",this.da+"-label-"+c);b.find("."+this.da+"-input").attr("id",this.da+"-input-"+c);this.Bb.attr("id","oj-listbox-results-"+c);this.search.attr("aria-owns",
"oj-listbox-results-"+c);this.search.attr("aria-labelledby",d.attr("id"));this.search.on("keydown",this.Mb(this.Tn));this.search.on("keyup-change input",this.Mb(this.Lx));b.on("mousedown","abbr",this.Mb(function(b){this.Re()&&(this.Sk(),a.dQ(b),this.close(),this.selection.focus())}));b.on("mousedown",this.Mb(function(b){this.O.element.prop("disabled")&&a.Ac(b);this.rd()?this.close():this.Re()&&this.open();this.search.focus()}));b.on("focus",this.Mb(function(b){a.Ac(b)}));this.search.on("blur",this.Mb(function(){this.search.removeClass(this.da+
"-focused")}));this.Cz();this.O.element.addClass(this.da+"-offscreen");this.ri()},Jl:function(){var a=h.j.Jl.apply(this,arguments),b=this,c=a.element.get(0).tagName.toLowerCase();if("input"===c&&a.element.prop("list")||"select"===c&&0<a.element.children().length)a.ce=function(a,c){var d,f=b.Xb();Array.isArray(f)&&(f=f[0]);d=void 0!==f&&null!==f?b.mi(a.find("option").filter(function(){return this.value===f})):b.mi(a.find("option").filter(o_c("selected")));c(d)};else if("data"in a||this.Xb()&&0<this.Xb().length)a.ce=
a.ce||function(d,f){var h="";b.Xb()&&b.Xb().length&&(h=b.Xb()[0]);var g=null,k=null;a.Tp({Fi:function(b,c,d){(b=h===a.id(d))&&(k=d);g||(g=d);return b},Hb:e.isFunction(f)?function(){k||"select"!==c||(k=g);f(k)}:e.noop})};return a},ri:function(){var a=this.Zh();void 0===a&&(a="");this.search.val(a).addClass(this.da+"-default");this.fa.removeClass(this.da+"-allowclear")},Il:function(b,c,d){var f=0,e=this;b=this.gj();a.gg(b,function(a,b){if(e.Xb()&&e.Xb()[0]===e.id(b.data(e.Ub)))return f=a,!1});!1!==
d&&(!0===c&&0<=f?this.sf(f):this.sf(0))},oA:function(a,b,c){this.gC(a)&&(b=this.Xb()?this.Xb()[0]:null,this.b(),this.Kd(a),this.close(),b!==this.id(a)&&this.hd(this.id(a),c))},val:function(){var b,c=null,d=this;this.b();if(0===arguments.length)return this.Xb();b=arguments[0];if(this.yf){var f;f=this.yf.val(b).find("option").filter(o_c("selected"));a.gg(f,function(a,b){c=d.mi(b);return!1});this.hd(b);this.Kd(c);this.ri()}else if(b||0===b){if(void 0===this.O.ce)throw Error("cannot call val() if initSelection() is not defined");
this.hd(b);this.O.ce(this.O.element,function(a){d.hd(a?d.id(a):[]);d.Kd(a);d.ri()})}else this.Sk()},Hd:function(){this.search.val("")},b:function(a){var b;if(0===arguments.length)return b=this.selection.data(this.Ub),void 0===b&&(b=null),b;a?(this.b(),this.hd(a?this.id(a):[]),this.Kd(a)):this.Sk()}}),g=a.dm(h,{Ub:"ojcombobox",da:"oj-combobox",kr:function(){return e(document.createElement("div")).attr({"class":"oj-combobox oj-component"}).html("\x3cdiv class\x3d'oj-combobox-choice' tabindex\x3d'-1' role\x3d'presentation'\x3e   \x3cspan class\x3d'oj-combobox-search'\x3e\x3cinput type\x3d'text' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off'       spellcheck\x3d'false' class\x3d'oj-combobox-input' role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' /\x3e   \x3c/span\x3e\x3cabbr class\x3d'oj-combobox-search-choice-close' role\x3d'presentation'\x3e\x3c/abbr\x3e   \x3ca class\x3d'oj-combobox-arrow' role\x3d'presentation'\x3e\x3cb class\x3d'oj-combobox-icon oj-component-icon oj-clickable-icon oj-combobox-open-icon' role\x3d'presentation'\x3e\x3c/b\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d'oj-listbox-drop oj-combobox-display-none' role\x3d'presentation'\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e")},
close:function(){this.rd()&&(g.j.close.apply(this,arguments),""==this.search.val()?this.Sk():this.b()||""===this.search.val?this.search.val(this.b().text):this.Hd())},li:function(a){var b,c;g.j.li.apply(this,arguments);b=this.search.get(0);b.createTextRange?(b=b.createTextRange(),b.collapse(!1),b.select()):b.setSelectionRange&&(c=this.search.val().length,b.setSelectionRange(c,c));this.rp(!0);this.O.element.trigger(e.Event("ojexpand"))},Kd:function(a){var b;this.selection.data(this.Ub,a);null!==a&&
(b=this.O.$C(a,this.search,this.O.Ut));void 0!==b&&this.search.val(b);this.search.removeClass(this.da+"-default");this.O.FO&&this.fa.addClass(this.da+"-allowclear")}}),k=a.dm(h,{Ub:"ojselect",da:"oj-select",rC:!1,kr:function(){var a=e(document.createElement("div")).attr({"class":"oj-select oj-component"}).html("\x3cdiv class\x3d'oj-select-choice' tabindex\x3d'0' role\x3d'combobox'      aria-autocomplete\x3d'none' aria-expanded\x3d'false' aria-ready\x3d'true'\x3e  \x3cspan class\x3d'oj-select-box'\x3e    \x3cspan class\x3d'oj-select-chosen'\x3e\x3c/span\x3e    \x3cabbr class\x3d'oj-select-search-choice-close' role\x3d'presentation'\x3e\x3c/abbr\x3e    \x3ca class\x3d'oj-component-icon oj-clickable-icon oj-select-open-icon' role\x3d'presentation'\x3e    \x3cb role\x3d'presentation'\x3e\x3c/b\x3e\x3c/a\x3e  \x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'oj-listbox-drop oj-select-display-none' role\x3d'presentation'\x3e  \x3cdiv class\x3d'oj-select-search-wrapper'\x3e  \x3cdiv class\x3d'oj-select-search'\x3e    \x3cinput type\x3d'text' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off'           spellcheck\x3d'false' class\x3d'oj-select-input' title\x3d'Search field'            role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' /\x3e    \x3cspan class\x3d'oj-select-spyglass-box'\x3e      \x3cspan class\x3d'oj-component-icon oj-select-search-icon' role\x3d'presentation'\x3e       \x3cb role\x3d'presentation'\x3e\x3c/b\x3e\x3c/span\x3e    \x3c/span\x3e  \x3c/div\x3e  \x3c/div\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e");
this.O.element.prop("disabled")&&(a.find(".oj-select-choice").attr("tabindex","-1"),a.find(".oj-select-open-icon").addClass("oj-disabled"));return a},close:function(){this.rd()&&(k.j.close.apply(this,arguments),""==this.text.text()?this.Sk():this.Hd(),a.ij(this.selection),this.fa.find(".oj-select-spyglass-box").off("mouseup click"))},li:function(a){var b,c;k.j.li.apply(this,arguments);this.WN();this.di()&&(b=this.search.get(0),b.createTextRange?(b=b.createTextRange(),b.collapse(!1),b.select()):b.setSelectionRange&&
(c=this.search.val().length,b.setSelectionRange(c,c)));this.rp(!0);this.O.element.trigger(e.Event("ojexpand"))},Ko:function(){this.text=this.fa.find(".oj-select-chosen");k.j.Ko.apply(this,arguments);this.fa.find(".oj-select-choice").attr("aria-owns",this.search.attr("aria-owns")).attr("aria-labelledby",this.search.attr("aria-labelledby"));this.selection.on("keydown",this.Mb(this.Tn));this.selection.on("keyup-change input",this.Mb(this.Lx))},wj:function(){this.Qz()?(this.Kd(null),this.close(),this.ri()):
k.j.wj.apply(this,arguments)},Kd:function(a){this.selection.data(this.Ub,a);null!==a&&this.text.text(a.text);this.text.removeClass(this.da+"-default");this.O.FO&&this.fa.addClass(this.da+"-allowclear")},no:function(){return this.search.attr("aria-expanded")&&this.di()?this.search:this.selection},ol:function(){var a=this.O.element.children("option").first();if(""===a.text()&&""===a.val())return a},Qz:function(){var a;if(!this.Zh())return!1;var b=this.Xb();return void 0!==(a=this.ol())&&a.prop("selected")||
""===b||void 0===b||null===b},Zh:function(){return void 0===this.ol()?void 0:k.j.Zh.apply(this,arguments)},ri:function(){var a=this.Zh();this.Qz()&&void 0!==a&&void 0!==this.ol()&&(void 0===a&&(a=""),this.text.text(a).addClass(this.da+"-default"),this.fa.removeClass(this.da+"-allowclear"))},Tk:function(){this.text.hasClass(this.da+"-default")&&this.text.val("").removeClass(this.da+"-default")},hd:function(a,b){k.j.hd.call(this,a,b);this.selection.data("selectVal",a)},Tn:function(b){if(!a.oa.QD(b)&&
!a.oa.RD(b)){switch(b.which){case a.oa.TAB:this.pi({Im:!0},b);this.selection.focus();return;case a.oa.ENTER:if(b.target===this.selection[0]&&!this.rd()){this.open();a.Ac(b);return}}k.j.Tn.apply(this,arguments)}},WN:function(){var b=!1,c=this.kc.find(".oj-select-search");c&&(this.di()?(this.kc.find(".oj-select-search-wrapper").removeClass("oj-helper-hidden-accessible"),e(c).removeAttr("aria-hidden"),b=!0):(this.kc.find(".oj-select-search-wrapper").addClass("oj-helper-hidden-accessible"),e(c).attr({"aria-hidden":"true"})));
a.ij(b?this.search:this.selection);if(b){var d=this;c.find(".oj-select-spyglass-box").on("mouseup click",function(a){d.search.focus();a.stopPropagation()})}},di:function(){return(this.yf?this.yf[0].length:this.O.data.length)>this.O.minimumResultsForSearch||this.rC}});b.ta("oj.ojCombobox",e.oj.editableValue,{version:"1.0.0",defaultElement:"\x3cinput\x3e",widgetEventPrefix:"oj",options:{placeholder:"",multiple:!1,data:null,expand:null},widget:function(){return this.ve.fa},Kc:function(){this._super();
this.mb()},mb:function(){var a,b=this.options.multiple;a={};a.element=this.element;a.cf=this;a=e.extend(this.options,a);this.ve=b?new l:new g;this.ve._init(a)},_destroy:function(){this.ve._destroy()},refresh:function(){this._super();this.ve._destroy();this.mb()},expand:function(a){this.ve.open();this._trigger("ojexpand",a)},collapse:function(){this.ve.close()},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.ve.hy():this.ve.eo():"value"===a&&this.ve.wj()},_GetMessagingLauncherElement:function(){return this.ve.fa},
_GetDefaultStyleClass:o_d("oj-combobox"),getNodeBySubId:function(a){if(null==a)return this.ve.fa?this.ve.fa[0]:null;a=a.subId;"oj-combobox-drop"==a&&(a="oj-listbox-drop");"oj-combobox-results"==a&&(a="oj-listbox-results");switch(a){case "oj-combobox-input":case "oj-combobox-arrow":case "oj-listbox-drop":case "oj-listbox-results":return this.widget().find(a)[0]}return null}});b.ta("oj.ojSelect",e.oj.editableValue,{version:"1.0.0",defaultElement:"\x3cselect\x3e",widgetEventPrefix:"oj",options:{minimumResultsForSearch:10,
placeholder:"",data:null,expand:null},widget:function(){return this.select.fa},Kc:function(){this._super();this.mb()},mb:function(){var a={};a.element=this.element;a.cf=this;a=e.extend(this.options,a);this.select=new k;this.select._init(a)},refresh:function(){this._super();this.select._destroy();this.mb()},_destroy:function(){this.select._destroy()},expand:function(){this.select.open()},collapse:function(){this.select.close()},_SetPlaceholder:function(a){this._super(a);this.select.O.placeholder=a;
this.select.ri()},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.select.hy():this.select.eo():"data"===a?this.mb():"value"===a&&this.select.wj()},getNodeBySubId:function(a){if(null==a)return this.select.fa?this.select.fa[0]:null;a=a.subId;"oj-select-drop"==a&&(a="oj-listbox-drop");"oj-select-results"==a&&(a="oj-listbox-results");switch(a){case "oj-select-chosen":case "oj-select-search":case "oj-listbox-drop":case "oj-listbox-results":return this.widget().find("."+a)[0]}return null},
_GetDefaultStyleClass:o_d("oj-select"),_GetMessagingLauncherElement:function(){return this.select.fa}});var l=a.dm(d,{Ub:"ojcombobox",da:"oj-combobox",kr:function(){return e(document.createElement("div")).attr({"class":"oj-combobox oj-combobox-multi oj-component"}).html("\x3cul class\x3d'oj-combobox-choices'\x3e  \x3cli class\x3d'oj-combobox-search-field'\x3e    \x3cinput type\x3d'text' role\x3d'combobox' aria-expanded\x3d'false' aria-autocomplete\x3d'list' autocomplete\x3d'off' autocorrect\x3d'off' autocapitalize\x3d'off' spellcheck\x3d'false' class\x3d'oj-combobox-input'\x3e  \x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'oj-combobox-description oj-helper-hidden-accessible'/\x3e\x3cdiv class\x3d'oj-listbox-drop oj-listbox-drop-multi oj-combobox-display-none'\x3e   \x3cul class\x3d'oj-listbox-results' role\x3d'listbox'\x3e   \x3c/ul\x3e\x3c/div\x3e")},
Jl:function(){var b=l.j.Jl.apply(this,arguments),c=this;"input"===b.element.get(0).tagName.toLowerCase()&&b.element.prop("list")?b.ce=function(d,f){var e=[];if(b.element.val())for(var h,g=a.Xp(b.element.val(),b.separator),k=0;k<g.length;k++){var l=g[k];h=d.find("option").filter(function(){return this.value===l});e.push(c.mi(h))}else h=d.find("option").filter(o_c("selected")),a.gg(h,function(a,b){e.push(c.mi(b))});f(e)}:"data"in b&&(b.ce=b.ce||function(c,d){var f=a.Xp(c.val(),b.separator),h=[];b.Tp({Fi:function(a,
c,d){(a=e.grep(f,function(a){return a===b.id(d)}).length)&&h.push(d);return a},Hb:e.isFunction(d)?function(){for(var a=[],c=0;c<f.length;c++)for(var e=f[c],g=0;g<h.length;g++){var k=h[g];if(e===b.id(k)){a.push(k);h.splice(g,1);break}}d(a)}:e.noop})});return b},Jj:function(a){var b=this.fa.find("."+this.da+"-search-choice-focus");b.length&&a&&a[0]==b[0]||(b.length&&this.O.element.trigger("choice-deselected",b),b.removeClass(this.da+"-search-choice-focus"),a&&a.length&&(this.close(),a.addClass(this.da+
"-search-choice-focus"),this.fa.find(".oj-combobox-description").html(a.attr("valueText")+". Press back space to delete.").attr("aria-live","assertive"),this.O.element.trigger("choice-selected",a)))},_destroy:function(){e("label[for\x3d'"+this.search.attr("id")+"']").attr("for",this.O.element.attr("id"));l.j._destroy.apply(this,arguments)},Ko:function(){var b="."+this.da+"-choices",c,d=a.Op(),f;this.GQ=this.fa.find("."+this.da+"-search-field");this.selection=c=this.fa.find(b);var h=this;this.selection.on("click",
"."+this.da+"-search-choice:not(."+this.da+"-locked)",function(){h.search[0].focus();h.Jj(e(this))});f=e("label[for\x3d'"+this.O.element.attr("id")+"']");f.attr("id")||f.attr("id",this.da+"-label-"+d);this.Bb.attr("id","oj-listbox-results-"+d);this.search.attr("aria-owns","oj-listbox-results-"+d);this.search.attr("aria-labelledby",f.attr("id"));this.search.on("input paste",this.Mb(function(){this.Re()&&!this.rd()&&this.open()}));this.search.attr("tabindex",this.Tt);this.tu=0;this.search.on("keydown",
this.Mb(function(b){if(this.Re()){++this.tu;var d=c.find("."+this.da+"-search-choice-focus"),f=d.prev("."+this.da+"-search-choice:not(."+this.da+"-locked)"),e=d.next("."+this.da+"-search-choice:not(."+this.da+"-locked)"),h=a.vP(this.search);if(!d.length||b.which!=a.oa.LEFT&&b.which!=a.oa.RIGHT&&b.which!=a.oa.Tm&&b.which!=a.oa.bv&&b.which!=a.oa.ENTER)if((b.which!==a.oa.Tm||1!=this.tu)&&b.which!=a.oa.LEFT||0!=h.offset||h.length){this.Jj(null);if(this.rd())switch(b.which){case a.oa.UP:case a.oa.DOWN:this.lA(b.which===
a.oa.UP?-1:1);a.Ac(b);return;case a.oa.ENTER:this.pi();a.Ac(b);return;case a.oa.TAB:this.pi({Im:!0});this.close();return;case a.oa.dq:this.Xq(b);a.Ac(b);return}b.which===a.oa.TAB||(a.oa.QD(b)||a.oa.RD(b)||b.which===a.oa.Tm||b.which===a.oa.dq)||b.which===a.oa.ENTER&&(!1===this.O.oQ||b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(this.open(),b.which!==a.oa.PAGE_UP&&b.which!==a.oa.PAGE_DOWN||a.Ac(b),b.which===a.oa.ENTER&&a.Ac(b))}else this.Jj(c.find("."+this.da+"-search-choice:not(."+this.da+"-locked)").last()),
a.Ac(b);else h=d,b.which==a.oa.LEFT&&f.length?h=f:b.which==a.oa.RIGHT?h=e.length?e:null:b.which===a.oa.Tm?(this.yt(d.first()),this.search.width(10),h=f.length?f:e):b.which==a.oa.bv?(this.yt(d.first()),this.search.width(10),h=e.length?e:null):b.which==a.oa.ENTER&&(h=null),this.Jj(h),a.Ac(b),h&&h.length||this.open()}}));this.search.on("keyup",this.Mb(function(){this.tu=0;this.gt()}));this.search.on("blur",this.Mb(function(a){this.search.removeClass(this.da+"-focused");this.Jj(null);this.rd()||this.Hd();
a.stopImmediatePropagation()}));this.fa.on("click",b,this.Mb(function(a){!this.Re()||0<e(a.target).closest("."+this.da+"-search-choice").length||(this.Jj(null),this.Tk(),this.open(),this.dl(),a.preventDefault())}));this.fa.on("focus",b,this.Mb(function(){this.Re()&&this.Tk()}));this.Cz();this.O.element.addClass(this.da+"-offscreen");this.Hd()},fj:function(){l.j.fj.apply(this,arguments)&&this.search.prop("disabled",!this.Re())},wj:function(){""===this.O.element.val()&&""===this.O.element.text()&&(this.Kd([]),
this.close(),this.Hd());if(this.yf||""!==this.O.element.val()){var a=this;this.O.ce.call(null,this.yf?this.yf:this.O.element,function(b){void 0!==b&&null!==b&&(a.Kd(b),a.close(),a.Hd())})}},Hd:function(){var a=this.Zh(),b=this.GJ();void 0===a||this.Xb()&&0!==this.Xb().length?this.search.val("").width(10):(this.search.val(a).addClass(this.da+"-default"),this.search.width(0<b?b:this.fa.css("width")))},Tk:function(){this.search.hasClass(this.da+"-default")&&this.search.val("").removeClass(this.da+"-default")},
li:function(a){this.gt();l.j.li.apply(this,arguments);this.dl();this.rp(!0);this.search.focus();this.O.element.trigger(e.Event("ojexpand"))},close:function(){this.rd()&&(this.Hd(),l.j.close.apply(this,arguments))},ij:function(){this.close();this.search.focus()},Kd:function(a){var b=[],c=[],d=this;e(a).each(function(){0>b.indexOf(d.id(this))&&(b.push(d.id(this)),c.push(this))});a=c;this.selection.find("."+this.da+"-search-choice").remove();e(a).each(function(){d.Ow(this)});d.Il()},oA:function(a,b){this.gC(a)&&
(this.Ow(a),!this.select&&this.O.Ot||this.Il(a,!1,!0===this.O.Ot),this.O.Ot?(this.close(),this.search.width(10)):0<this.gj().length?(this.Hd(),this.search.width(10),this.gt(),this.Dj()):(this.close(),this.search.width(10)),this.Xl(),b&&b.Im||this.dl())},Xq:function(){this.close();this.dl()},Ow:function(b){var c=!b.locked,d=e("\x3cli class\x3d'"+this.da+"-search-choice'\x3e    \x3cdiv\x3e\x3c/div\x3e    \x3ca href\x3d'#' onclick\x3d'return false;' class\x3d'"+this.da+"-search-choice-close' tabindex\x3d'-1'\x3e\x3c/a\x3e\x3c/li\x3e"),
f=e("\x3cli class\x3d'"+this.da+"-search-choice "+this.da+"-locked'\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/li\x3e"),d=c?d:f,h=this.id(b),g=this.Xb(),f=this.O.$C(b,d.find("div"),this.O.Ut);void 0!==f&&(d.find("div").replaceWith("\x3cdiv\x3e"+f+"\x3c/div\x3e"),d.attr("valueText",f));if(c)d.find("."+this.da+"-search-choice-close").on("mousedown",a.Ac).on("click dblclick",this.Mb(function(b){this.Re()&&(e(b.target).closest("."+this.da+"-search-choice").fadeOut("fast",this.Mb(function(){this.yt(e(b.target));this.selection.find("."+
this.da+"-search-choice-focus").removeClass(this.da+"-search-choice-focus");this.close();this.dl()})).dequeue(),a.Ac(b))}));d.data(this.Ub,b);d.insertBefore(this.GQ);e(b).each(function(){0>g.indexOf(h)&&g.push(h)});this.hd(g)},yt:function(a){var b=this.Xb(),c,d;a=a.closest("."+this.da+"-search-choice");if(0===a.length)throw"Invalid argument: "+a+". Must be ."+this.da+"-search-choice";if(c=a.data(this.Ub)){for(;0<=(d=b.indexOf(this.id(c)));)b.splice(d,1),this.hd(b),this.select&&this.Il();a.remove();
this.Xl()}},Il:function(b,c,d){var f=this.Xb();c=this.Bb.find(".oj-listbox-result");var e=this.Bb.find(".oj-listbox-result-with-children"),h=this;a.gg(c,function(a,b){var c=h.id(b.data(h.Ub));0<=f.indexOf(c)&&(b.addClass("oj-listbox-selected"),b.find(".oj-listbox-result-selectable").addClass("oj-listbox-selected"))});a.gg(e,function(a,b){b.is(".oj-listbox-result-selectable")||0!==b.find(".oj-listbox-result-selectable:not(.oj-listbox-selected)").length||b.addClass("oj-listbox-selected")});-1==this.sf()&&
!1!==d&&h.sf(0);!this.O.zu&&0<!c.filter(".oj-listbox-result:not(.oj-listbox-selected)").length&&(!b||b&&!b.lQ&&0===this.Bb.find(".oj-listbox-no-results").length)&&a.GC(h.cf,h.O.Ap,"formatNoMatches")&&this.Bb.append("\x3cli class\x3d'oj-listbox-no-results'\x3e"+h.O.Ap(h.cf,h.search.val())+"\x3c/li\x3e")},GJ:function(){return this.selection.width()-a.uD(this.search)},gt:function(){var b,c,d,f,e=a.uD(this.search);b=this.search.width()+10;c=this.search.offset().left;d=this.selection.width();f=this.selection.offset().left;
c=d-(c-f)-e;c<b&&(c=d-e);40>c&&(c=d-e);0>=c&&(c=b);this.search.width(Math.floor(c))},Xb:function(){var b;b=this.O.element.val();return a.Xp(b,this.O.separator)},hd:function(b){var c;c=[];"string"===typeof b&&(b=a.Xp(b,this.O.separator));e(b).each(function(){0>c.indexOf(this)&&c.push(this)});this.O.element.val(0===c.length?"":c.join(this.O.separator));this.search.attr("aria-activedescendant",this.O.element.attr("id"))},val:function(a){var b,c=this;if(0===arguments.length)return this.Xb();b=this.b();
b.length||(b=[]);if(a||0===a){this.hd(a);if(this.select)this.O.ce(this.select,this.Mb(this.Kd)),this.Xl();else{if(void 0===this.O.ce)throw Error("cannot call val() if initSelection() is not defined");this.O.ce(this.O.element,function(a){var b=e.map(a,c.id);c.hd(b);c.Kd(a);c.Hd();c.Xl()})}this.Hd()}else this.O.element.val(null),this.Kd([]),this.Hd(),this.Xl()},b:function(a){var b=this,c;if(0===arguments.length)return this.selection.find("."+this.da+"-search-choice").map(function(){return e(this).data(b.Ub)}).get();
this.b();a||(a=[]);c=e.map(a,function(a){return b.O.id(a)});this.hd(c);this.Kd(a);this.Hd()}})});
//# sourceMappingURL=oj-modular.map