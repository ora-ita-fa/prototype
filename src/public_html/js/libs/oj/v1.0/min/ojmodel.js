define(["ojs/ojcore","jquery"],function(a,e){a.L=window.oj.Events={on:function(a,b,c){return this.Ue(a,b,c,!1,!1)},off:function(a,b,c){return this.tq(a,b,c,!1)},trigger:function(d){var b=Array.prototype.slice.call(arguments);b.unshift(!1);return a.L.jb.apply(this,b)},once:function(a,b,c){return this.nx(a,b,c,!1)},listenTo:function(d,b,c){var f,h,g,e,k={};b.constructor===String?k[b]=c:k=b;for(e in k)if(k.hasOwnProperty(e))for(b=a.L.Gg(e),c=0;c<b.length;c+=1)f=b[c].event,h=b[c].ab,g={event:f,ab:h,object:d,
rb:k[e]},this.Yo(this.gb,g,a.L.Vw),f=h?f+":"+h:f,void 0===this.gb&&(this.gb=[]),this.gb.push(g),d.Ue(f,k[e],null,!0,!1);return this},listenToOnce:function(d,b,c){var f,h,g,e,k={};b.constructor===String?k[b]=c:k=b;for(e in k)if(k.hasOwnProperty(e))for(b=a.L.Gg(e),c=0;c<b.length;c+=1)f=b[c].event,h=b[c].ab,g={event:f,ab:h,object:d,rb:k[e]},this.Yo(this.gb,g,a.L.Vw),f=h?f+":"+h:f,void 0===this.gb&&(this.gb=[]),this.gb.push(g),d.nx(f,k[e],null,!0);return this},stopListening:function(d,b,c){var f,h={},
g,e,k,m,n,p,q,r,s;if(null==arguments||0==arguments.length){n=this.gb?this.gb.length:0;for(r=0;r<n;r++)p=this.gb[r].object.tq,p.apply(this.gb[r].object,[this.gb[r].event,this.gb[r].rb,this.gb[r].context,!0]);this.gb=[];return this}f=b;d&&d.constructor===String&&(f=d);f.constructor===String?h[f]=c:h=f;for(s in h)if(h.hasOwnProperty(s))for(f=a.L.Gg(s),g=0;g<f.length;g+=1)for(e=f[g].event,k=f[g].ab,n=this.gb?this.gb.length:0,r=n-1;0<=r;r-=1)m=this.gb[r],n=d?d===m.object:!0,p=e?e===m.event:!0,q=c?h[s]===
m.rb:!0,m=k?k===m.ab:!0,n&&(p&&q&&m)&&(p=this.gb[r].object.tq,p.apply(this.gb[r].object,[this.gb[r].event,this.gb[r].rb,this.gb[r].context,!0]),this.gb.splice(r,1));return this}};a.L.bind=a.L.on;a.L.unbind=a.L.off;a.L.t={ADD:"add",REMOVE:"remove",RESET:"reset",SORT:"sort",CHANGE:"change",DESTROY:"destroy",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",ALL:"all"};o_("Events.EventType",a.L.t,a);a.L.kl=function(a,b){var c,f=b||this;for(c in f)"function"===typeof f[c]&&(a[c]=f[c]);a.sb=
{};a.gb=[]};a.L.nx=function(a,b,c,f){var h,g,e,k;e=this.Jp(a,b);for(k in e)if(e.hasOwnProperty(k))for(a=this.Gg(k),b=0;b<a.length;b+=1)h=a[b].event,g=a[b].ab,void 0===this.sb&&(this.sb=[]),void 0===this.sb[h]&&(this.sb[h]=[]),this.sb[h].push({rb:e[k],context:c,ab:g,rf:!0,fired:!1,kg:f});return this};a.L.Ly=function(a){return a.rf?a.fired?!1:a.fired=!0:!0};a.L.jb=function(d,b){var c=this.Gg(b),f,h,g,e,k,m;e=[];for(f=0;f<c.length;f+=1)h=c[f].event,g=c[f].ab,e.push({event:h,ab:g});for(f=0;f<e.length;f+=
1){k=this.vm(this.sb,a.L.t.ALL);c=a.L.vm(this.sb,e[f].event,!1);for(h=0;h<(c?c.length:0);h+=1)c[h].ab===e[f].ab&&c[h].rb&&(g=Array.prototype.slice.call(arguments),c&&(c[h]&&c[h].rf)&&this.Wx(a.L.vm(this.sb,e[f].event,!0),c[h]),c&&(c[h]&&this.Ly(c[h]))&&(m=c[h].rb,d&&!c[h].hA||m.apply(c[h].context||this,g.slice(2))));for(h=0;h<(k?k.length:0);h+=1)g=Array.prototype.slice.call(arguments),0<g.length&&(g[1]=e[f].ab?e[f].event+":"+e[f].ab:e[f].event),k&&(k[h]&&k[h].rb&&this.Ly(k[h]))&&(m=k[h].rb,d&&!k[h].hA||
m.apply(k[h].context||this,g.slice(1))),k&&(k[h]&&k[h].rf)&&this.Wx(this.vm(this.sb,a.L.t.ALL,!0),k[h])}return this};a.L.Ue=function(d,b,c,f,h){var g,e,k,m;d=this.Jp(d,b);for(g in d)if(d.hasOwnProperty(g))for(b=this.Gg(g),e=0;e<b.length;e+=1)k=b[e].event,m=b[e].ab,void 0===this.sb&&(this.sb=[]),void 0===this.sb[k]&&(this.sb[k]=[]),m={rb:d[g],context:c,ab:m,kg:f,hA:h},-1===this.Yo(this.sb[k],m,a.L.ZG)&&this.sb[k].push(m);return this};a.L.tq=function(a,b,c,f){var h,g;if(null==arguments||0==arguments.length)return this.sb=
{},this;if(null==a)return this.Vx(a,b,c,f),this;h=this.Jp(a,b);for(g in h)h.hasOwnProperty(g)&&this.Vx(g,h[g],c,f);return this};a.L.Jp=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};a.L.Vx=function(d,b,c,f){var h=[],g,e,k,m,n,p,q,r;if(d)h=a.L.Gg(d);else if(void 0!==this.sb)for(e in this.sb)this.sb.hasOwnProperty(e)&&h.push({event:e});for(d=0;d<h.length;d+=1)if(e=h[d].event,k=h[d].ab,void 0!==this.sb&&this.sb[e]instanceof Array){m=this.sb[e];for(g=m.length-1;0<=g;g-=1)n=void 0===
b||null===b||m[g].rb==b,p=void 0===c||null===c||m[g].context==c,q=void 0===k||null===k||m[g].ab==k,r=void 0===f||null===f||m[g].kg==f,n&&(p&&q&&r)&&m.splice(g,1);0===m.length&&delete this.sb[e]}};a.L.Wx=function(a,b){var c,f,h,g,e,k;for(c=a.length-1;0<=c;c-=1)f=void 0===b.rb||null===b.rb||a[c].rb==b.rb,h=void 0===b.context||null===b.context||a[c].context==b.context,g=void 0===b.ab||null===b.ab||a[c].ab==b.ab,e=void 0===b.kg||null===b.kg||a[c].kg==b.kg,k=void 0===b.rf||null===b.rf||a[c].rf==b.rf,f&&
(h&&g&&e&&k)&&a.splice(c,1)};a.L.Gg=function(a){a=a?a.split(" "):[];var b=[],c,f,h;for(c=0;c<a.length;c+=1)f=a[c].split(":"),h=f[0],f=1<f.length?f[1]:null,b.push({event:h,ab:f});return b};a.L.ZG=function(a,b){return a.rb===b.rb&&a.ab===b.ab&&a.context===b.context&&a.kg===b.kg&&a.rf===b.rf};a.L.Vw=function(a,b){return a.event===b.event&&a.ab===b.ab&&a.context===b.context&&a.object===b.object};a.L.Yo=function(a,b,c){var f;if(void 0===a)return-1;for(f=0;f<a.length;f+=1)if(c(a[f],b))return f;return-1};
a.L.vm=function(a,b,c){if(a&&a[b]instanceof Array){if(c)return a[b];c=[];var f;for(f=0;f<a[b].length;f++)c.push(a[b][f]);return c}return null};a.h=function(d,b){a.h._init(this,d,b,null)};o_("Model",a.h,a);a.a.ea(a.h,a.a,"Model.Model");a.h.prototype.i=function(){a.h.q.i.call(this)};a.h.prototype.attributes={};a.a.c("Model.prototype.attributes",{attributes:a.h.prototype.attributes});a.h.prototype.Od={};a.a.c("Model.prototype.defaults",{Od:a.h.prototype.Od});a.h.prototype.id=null;a.a.c("Model.prototype.id",
{id:a.h.prototype.id});a.h.prototype.Fk=null;a.a.c("Model.prototype.idAttribute",{Fk:a.h.prototype.Fk});a.h.prototype.UA=null;a.a.c("Model.prototype.urlRoot",{UA:a.h.prototype.UA});a.h.prototype.je=null;a.a.c("Model.prototype.customURL",{je:a.h.prototype.je});a.h.dq=0;a.h._init=function(d,b,c,f){var h=null,g;if(!a.h.Sj){d.i();a.L.kl(d);d.Dh();d.Un={};d.Pn=!1;d.index=-1;c=c||{};d.attributes={};d.defaults&&(d.attributes=a.h.Ye(a.h.tc(d.defaults)?d.defaults():d.defaults,null));for(h in f)f.hasOwnProperty(h)&&
(d[h]=f[h]);if(b)if(f=c.parse,a.h.tc(f)&&(d.parse=f),g=a.h.Ye(b,d.attributes),g=f?d.parse(g):g,null==g||void 0===g)d.attributes={};else for(h in g)g.hasOwnProperty(h)&&d.Yg(h,g[h],c);d.ml();d.Yi(c.collection);c.customURL&&(d.customURL=c.customURL);c.url&&(d.url=c.url);c.urlRoot&&(d.urlRoot=c.urlRoot);d.initialize&&d.initialize(b,c);d.xe()}};a.h.extend=function(d,b){a.h.Sj=!0;var c,f;c=new a.h;a.h.Sj=!1;a.L.kl(c,this.prototype);d=d||{};for(f in d)d.hasOwnProperty(f)&&(c[f]=d[f]);var h;h=d&&d.constructor&&
d.hasOwnProperty("constructor")?d.constructor:function(c,b){a.h._init(this,c,b,d)};h.prototype=c;h.extend=a.h.extend;h.prototype.constructor=h;a.L.kl(h,this);if(b)for(f in b)b.hasOwnProperty(f)&&(h[f]=b[f]);return h};o_("Model.extend",a.h.extend,a);a.h.prototype.jb=o_a();a.h.prototype.ml=function(){this.ve()||(this.cid="id"+a.h.dq,a.h.dq+=1)};a.h.prototype.ve=o_c("cid");a.h.prototype.ho=o_b("index");a.h.prototype.io=o_b("next");a.h.prototype.eB=o_c("next");a.h.prototype.nl=function(a){var b=this.previous;
this.previous=a;return b};a.h.prototype.vs=o_c("previous");a.h.prototype.Am=function(d){return a.h.tc(this[d])?this[d]():this[d]};a.h.prototype.kB=function(d,b){var c,f=!1,h=a.Xa.le(b),g;for(c in d.attributes)d.attributes.hasOwnProperty(c)&&(g=this.attributes[c]!=d.attributes[c],h?c===b&&g&&(f=!0):g&&(f=!0),g&&(this.attributes[c]=d.attributes[c],this.Fo(c,d.attributes[c])));this.xe();return f};a.h.Og=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;return!1};
a.h.prototype.Yi=function(a){null==a?delete this.collection:this.collection=a};a.h.prototype.Ti=o_c("collection");a.h.prototype.mm=function(d,b,c,f){null!=d&&this.jb(f,a.L.t.CHANGE+":"+d,this,b,c)};a.h.prototype.nm=function(d,b){var c;this.jb(b,a.L.t.CHANGE,this,d,null);(c=this.Ti())&&c.jb(b,a.L.t.CHANGE,this,c,d,null)};a.h.prototype.xe=function(){this.id=this.attributes[this.Np()]};a.h.prototype.Kq=function(d,b){return a.a.kh(this.attributes[d],b)?!1:(this.attributes[d]=b,this.xe(),!0)};a.h.prototype.Dh=
function(){this.changed={}};a.h.prototype.Fo=function(a,b){this.changed[a]=b};a.h.prototype.Yg=function(d,b,c){if(null==d)return!0;var f={},h,g=this.Pn,e,k;k=a.h.bm(c);if(2<arguments.length)f[d]=b;else{for(h in d)d.hasOwnProperty(h)&&(f[h]=d[h]);k=b}k=k||{};e=[];if(!this.kj(f,{validate:k.validate},!1))return!1;g||this.Dh();this.Pn||(this.Un=a.h.Ye(this.attributes,null));this.Pn=!0;for(h in f)f.hasOwnProperty(h)&&(this.Kq(h,f[h])?(this.Fo(h,f[h]),e.push(h)):delete f[h]);var m=k.silent;for(h in f)f.hasOwnProperty(h)&&
(e.length&&!m&&(this.wA=!0),this.mm(h,f[h],k,m));if(g)return!0;if(!m)for(;this.wA;)this.wA=!1,this.nm(k,m);this.Pn=!1;return!0};a.h.prototype.clear=function(d){var b,c={silent:!0},f;d=d||{};f=d.silent;c.validate=d.validate;this.Dh();for(b in this.attributes)if(this.attributes.hasOwnProperty(b)){if(!this.wn(b,c,!0))return!1;this.jb(f,a.L.t.CHANGE+":"+b,this,void 0,null)}this.attributes={};this.xe();this.mm(null,null,null,f);this.nm(null,f);return this};a.a.c("Model.prototype.clear",{clear:a.h.prototype.clear});
a.h.Ye=function(d,b){var c;b=b||{};for(c in d)d.hasOwnProperty(c)&&("object"!==typeof d[c]?b.hasOwnProperty(c)?void 0!==d[c]&&(b[c]=d[c]):b[c]=d[c]:b[c]=a.h.Ye(d[c],null));return b};a.h.prototype.clone=function(){var d=new this.constructor,b;for(b in this)this.hasOwnProperty(b)&&this[b]!==this.attributes&&(d[b]=this[b]);d.attributes=a.h.Ye(this.attributes,null);delete d.cid;d.ml();d.xe();return d};a.a.c("Model.prototype.clone",{clone:a.h.prototype.clone});a.h.prototype.Wi=function(a,b){var c=this.Xd();
if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};a.h.prototype.set=function(d,b,c){var f={},h=!1,g,e=!0;if(arguments&&0<arguments.length)if(1<arguments.length&&arguments[arguments.length-1]&&(h=!0,f=arguments[arguments.length-1]||{}),a.h.Og(d))if(f.unset)for(g in d)d.hasOwnProperty(g)&&this.wn(g,null,!1);else this.Yg(d,f)||(e=!1);else for(g=0;g<arguments.length;g+=2)if(void 0!==arguments[g]||g<arguments.length-1||!h&&g===arguments.length-1)f.unset?this.wn(arguments[g],null,!1):
this.Yg(arguments[g],arguments[g+1],f)||(e=!1);return e?this:!1};a.a.c("Model.prototype.set",{set:a.h.prototype.set});a.h.prototype.SA=function(a,b){return this.wn(a,b,!1)};a.a.c("Model.prototype.unset",{SA:a.h.prototype.SA});a.h.prototype.wn=function(a,b,c){b=b||{};var f=b.silent,h={};if(this.has(a)){if(!this.kj(h,b,!1))return!1;c||this.Dh();delete this.attributes[a];this.Fo(a,void 0);this.mm(a,null,null,f);this.nm(null,f)}this.xe();return!0};a.h.prototype.get=function(a){return this.attributes[a]};
a.a.c("Model.prototype.get",{get:a.h.prototype.get});a.h.prototype.has=function(a){return void 0!==this.attributes[a]&&null!==this.attributes[a]};a.a.c("Model.prototype.has",{has:a.h.prototype.has});a.h.prototype.fetch=function(d){d=d||{};var b=d.success,c=d.error,f=this,h;h=a.h.bm(d);h.error=function(b,h,e){f.jb(!1,a.L.t.ERROR,f,b,d);c&&c.call(f,arguments)};h.success=function(c){a.h.om(f,c,h);a.h.tc(this.parse)&&this.set(this.parse(c),h);b&&b.call(f,this,c,d)};a.h.Qj("read",this,h)};a.a.c("Model.prototype.fetch",
{fetch:a.h.prototype.fetch});a.h.prototype.parse=function(a){this.attributes=a;this.xe();return this.attributes};a.h.prototype.url=function(){var d=this.tw(),b=this.Xd();if(d)return b?d+"/"+encodeURIComponent(b):d;if(d=this.collection)return d=a.h.tc(d.url)?d.url():d.url,b&&d?(b="/"==a.h.HF(d)?"":"/",d+b+encodeURIComponent(this.Xd())):d;throw"No URL defined";};a.a.c("Model.prototype.url",{url:a.h.prototype.url});a.h.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
b.push(a);return b};a.a.c("Model.prototype.keys",{keys:a.h.prototype.keys});a.h.prototype.cl=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};a.a.c("Model.prototype.values",{cl:a.h.prototype.cl});a.h.prototype.Me=function(){var a,b={};for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(b[a]=this.get(a));return b};a.a.c("Model.prototype.pairs",{Me:a.h.prototype.Me});a.h.prototype.vA=function(a){var b=[],c,f,h={};if(a instanceof
Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Me();for(f in this.attributes)this.attributes.hasOwnProperty(f)&&-1==b.indexOf(f)&&(h[f]=this.get(f));return h};a.a.c("Model.prototype.omit",{vA:a.h.prototype.vA});a.h.prototype.xA=function(a){var b=[],c,f={};if(a instanceof Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Me();for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(f[b[c]]=this.get(b[c]));
return f};a.a.c("Model.prototype.pick",{xA:a.h.prototype.xA});a.h.prototype.kA=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=this.get(a),b[c]=a);return b};a.a.c("Model.prototype.invert",{kA:a.h.prototype.kA});a.h.HF=function(a){return a.charAt(a.length-1)};a.h.prototype.$I=function(){var a=this.tw();return a?a:this.Ti()?this.Ti().url:null};a.h.prototype.tw=function(){return a.h.tc(this.urlRoot)?this.urlRoot():this.urlRoot};a.h.prototype.parseSave=function(a){return a};
a.h.prototype.isValid=function(){var a={};a.validate=this.validate;return this.kj(this.attributes,a,!1)};a.a.c("Model.prototype.isValid",{isValid:a.h.prototype.isValid});a.h.FH=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};a.h.prototype.kj=function(d,b,c){var f=this.validate;return f&&a.h.FH(b,c)&&(this.validationError=f.call(this,d,b))?(this.jb(!1,a.L.t.INVALID,this,this.validationError,b),!1):!0};a.h.mI=function(d){var b=!1,c={},f,h={};if(d&&0<d.length){1<d.length&&
(d[d.length-1]&&a.h.Og(d[d.length-1]))&&(b=!0,c=d[d.length-1]||{});if(null==d[0])return{attributes:null,options:c};if(a.h.Og(d[0]))for(f in d[0])d[0].hasOwnProperty(f)&&(h[f]=d[0][f]);else for(f=0;f<d.length;f+=2)if(void 0!==d[f]||f<d.length-1||!b&&f===d.length-1)h[d[f]]=d[f+1]}return{attributes:h,options:c}};a.h.bm=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.h.prototype.save=function(d,b){var c,f,h,g,e,k;c=a.h.mI(arguments);var m,n,p;p=void 0===d?void 0:
c.attributes;m=a.h.bm(c.options);m.wait||this.set(p);if(!this.kj(this.attributes,m,!0))return!1;c=void 0===m.forceNew?!1:m.forceNew;g=this;e=m.error;k=m.patch;m.error=function(c,d,f){g.jb(!1,a.L.t.ERROR,g,c,b);e&&e.call(g,arguments)};m.saveAttrs=m.wait?this.yD(p):this.attributes;n=this.attributes;this.attributes=m.saveAttrs;m.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.Jn())return f=m.success,m.success=function(c){var d;c&&(d=a.h.tc(this.parse)?this.parse(c):c,g.attributes=d,g.xe());a.h.om(g,
c,m);f&&f.call(a.h.Se(m,g),g,c,b);g.Dh()},m.attrs=void 0===p?void 0:k?p:m.saveAttrs,a.h.Qj(k?"patch":"update",this,m);h=a.h.lw(m);m.success=function(c){var d;if(c){d=a.h.tc(g.parse)?g.parse(c):c;if(!g.kj(d,m,!0))return;g.attributes=d;g.xe()}m.wait&&g.set(p);a.h.om(g,c,m);h&&h.call(a.h.Se(m,g),g,c,b);g.Dh()};m.attrs=m.saveAttrs;m.parse=!0;return a.h.Qj("create",this,m)};a.a.c("Model.prototype.save",{save:a.h.prototype.save});a.h.prototype.yD=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&
(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.h.isArray=function(a){return a.constructor===Array};a.h.tc=function(a){return a instanceof Function};a.h.prototype.$G=function(a){for(var b in a)if(a.hasOwnProperty(b)&&(!this.attributes.hasOwnProperty(b)||a[b]!==this.attributes[b]))return!1;return!0};a.h.prototype.ZA=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.$G(a[b]))return!0;return!1};a.h.lw=function(a){return null!=a&&a.success?
a.success:null};a.h.Se=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};a.h.prototype.Jn=function(){return void 0==this.Xd()};a.a.c("Model.prototype.isNew",{Jn:a.h.prototype.Jn});a.h.prototype.Np=function(){return this.idAttribute||"id"};a.h.prototype.Xd=o_c("id");a.h.prototype.gr=function(d){if(d){var b={},c;for(c in d)d.hasOwnProperty(c)&&(a.a.kh(d[c],this.attributes[c])||(b[c]=d[c]));return a.a.Dc(b)?!1:b}return a.a.Dc(this.changed)?!1:this.changed};a.a.c("Model.prototype.changedAttributes",
{gr:a.h.prototype.gr});a.h.prototype.Br=function(d){return void 0!==d?a.h.Og(this.changed)&&this.changed.hasOwnProperty(d):a.h.Og(this.changed)};a.a.c("Model.prototype.hasChanged",{Br:a.h.prototype.Br});a.h.prototype.change=function(){for(var a in this.changed)this.changed.hasOwnProperty(a)&&(this.mm(a,this.get(a),null,!1),this.nm(null,!1))};a.a.c("Model.prototype.change",{change:a.h.prototype.change});a.h.prototype.destroy=function(d){d=d||{};var b=d.wait,c,f=d.error,h=this,g,e;e=a.h.bm(d);c=a.h.lw(e);
e.success=function(f){b&&h.zp();a.h.om(h,f,e);c&&c.call(a.h.Se(e,h),h,f,d)};e.error=function(c,b,d){h.jb(!1,a.L.t.ERROR,h,c,e);f&&f.call(h,arguments)};if(!this.Jn())return g=a.h.Qj("delete",this,e),b||this.zp(),g;b||this.zp();c&&c.call(a.h.Se(e,h),h,null,d);return!1};a.a.c("Model.prototype.destroy",{destroy:a.h.prototype.destroy});a.h.prototype.zp=function(){this.jb(!1,a.L.t.DESTROY,this,this.collection,null)};a.h.om=function(d,b,c){d.jb(!1,a.L.t.SYNC,d,b,c)};a.h.prototype.toJSON=function(){var a=
{},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};a.a.c("Model.prototype.toJSON",{toJSON:a.h.prototype.toJSON});a.h.prototype.previous=function(a){return this.Un[a]};a.a.c("Model.prototype.previous",{previous:a.h.prototype.previous});a.h.prototype.zA=o_c("Un");a.a.c("Model.prototype.previousAttributes",{zA:a.h.prototype.zA});a.h.prototype.AA=o_c("Un");a.a.c("Model.prototype.previousChanges",
{AA:a.h.prototype.AA});a.h.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.h.Qj=function(a,b,c){c=c||{};b.oauth&&(c.oauthHeader=b.oauth.getHeader());!c.dataType&&b.dataType&&(c.dataType=b.dataType);!c.jsonpCallback&&b.jsonpCallback&&(c.jsonpCallback=b.jsonpCallback);if("create"===a||"patch"===a||"update"===a)c.Vr=b.parseSave.call(b,"patch"===a?b.changed:c.saveAttrs);return b.sync(a,b,c)};a.IL=function(d,b,c){c=c||{};var f,h=c.success,g=c.error;f=b.customURL;if("create"===d.valueOf())return f=
new a.Oa(b.$I(),f),f.cK(c.Vr,g,c,b);if("read"===d.valueOf()){if(b instanceof a.h)return f=new a.Oa(b.url(),f),f.KK(h,g,b.Xd(),c,a.h.Se(c,b));f=new a.Oa(b.dB(c),f);return f.LK(h,g,c,b)}f=new a.Oa(b.url(),f);var e=null;b instanceof a.h&&(e=b.Xd());return"update"===d.valueOf()?f.TA(h,e,c.Vr,g,c,b,!1):"patch"===d.valueOf()?f.TA(h,e,c.Vr,g,c,b,!0):"delete"===d.valueOf()?f.wK(e,g,c,b):null};o_("sync",a.IL,a);a.ajax=function(){return e.ajax.apply(window.oj,arguments)};a.g=function(d,b){a.g.Sj||a.g._init(this,
d,b,null)};o_("Collection",a.g,a);a.g.prototype.Fc=null;a.a.c("Collection.prototype.model",{Fc:a.g.prototype.Fc});a.g.prototype.length=0;a.a.c("Collection.prototype.length",{length:a.g.prototype.length});a.g.prototype.uA=[];a.a.c("Collection.prototype.models",{uA:a.g.prototype.uA});a.g.prototype.url=null;a.a.c("Collection.prototype.url",{url:a.g.prototype.url});a.g.prototype.je=o_d(null);a.a.c("Collection.prototype.customURL",{je:a.g.prototype.je});a.g.prototype.Ez=o_d(null);a.a.c("Collection.prototype.customPagingOptions",
{Ez:a.g.prototype.Ez});a.g.prototype.rA=0;a.a.c("Collection.prototype.lastFetchSize",{rA:a.g.prototype.rA});a.g.prototype.hasMore=!1;a.a.c("Collection.prototype.hasMore",{hasMore:a.g.prototype.hasMore});a.g.prototype.Zk=0;a.a.c("Collection.prototype.totalResults",{Zk:a.g.prototype.Zk});a.g.prototype.qA=0;a.a.c("Collection.prototype.lastFetchCount",{qA:a.g.prototype.qA});a.g.prototype.tA=-1;a.a.c("Collection.prototype.modelLimit",{tA:a.g.prototype.tA});a.g.prototype.offset=0;a.a.c("Collection.prototype.offset",
{offset:a.g.prototype.offset});a.g.prototype.Jz=-1;a.a.c("Collection.prototype.fetchSize",{Jz:a.g.prototype.Jz});a.g.prototype.wf=1;a.a.c("Collection.prototype.sortDirection",{wf:a.g.prototype.wf});a.g.prototype.jf=null;a.a.c("Collection.prototype.comparator",{jf:a.g.prototype.jf});a.g.prototype.ng=!0;a.a.c("Collection.prototype.sortSupported",{ng:a.g.prototype.ng});a.a.ea(a.g,a.a,"Collection.Collection");a.g.prototype.i=function(){a.g.q.i.call(this)};a.g.extend=function(d){a.g.Sj=!0;var b=new a.g;
a.g.Sj=!1;var c;c=d&&d.constructor&&d.hasOwnProperty("constructor")?d.constructor:function(c,b){a.g._init(this,c,b,d)};c.prototype=b;return c.prototype.constructor=c};o_("Collection.extend",a.g.extend,a);a.g._init=function(d,b,c,f){var h,g;d.i();a.L.kl(d);if(f)for(h in f)f.hasOwnProperty(h)&&(d[h]=f[h]);c=c||{};g=["url","comparator","model",a.g.jd,"modelLimit","customURL"];for(h=0;h<g.length;h++)c.hasOwnProperty(g[h])&&void 0!==c[g[h]]&&(d[g[h]]=c[g[h]]);void 0===d.um(null)&&d.HA(-1);void 0===d.modelLimit&&
d.bs(-1);d.hasMore=!1;d.Sd=0;d.ki([]);c.parse&&(b=d.parse(b));if(null!=b&&void 0!==b)for(g=b instanceof Array?b:[b],h=0;h<g.length;h+=1)d.add(g[h],c);d.jk();f&&f.initialize&&f.initialize.call(d,b,c)};a.g.prototype.on=o_a();a.g.prototype.Ue=o_a();a.g.prototype.jb=o_a();a.g.prototype.ki=o_b("models");a.g.prototype.wc=o_c("models");a.g.prototype.Ka=function(){return this.wc().length};a.g.prototype.bI=function(a){return a<this.Ka()||this.Ba()&&!this.Nj()?!1:!0};a.g.prototype.Nj=function(){return void 0!==
this.totalResults&&null!=this.totalResults};a.g.prototype.tI=function(a){this.oq(a);this.wc().push(a);this.Sd++;a.ho(this.Ka()-1)};a.g.prototype.Ex=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.Sd--};a.g.prototype.Ry=function(a,b,c){for(var f=a;f<a+b;f++)this.by(this.wc()[f]);void 0===c?this.Ex(this.wc().splice(a,b)):(this.Ex(this.wc().splice(a,b,c)),this.oq(c));0>this.Sd&&(this.Sd=0);this.Dx(a)};a.g.prototype.da=function(a){return this.wc()[a]};a.g.prototype.Dx=function(a){for(var b=a;b<
this.Ka();b++)(a=this.da(b))&&a.ho(b)};a.g.prototype.by=function(a){if(a){var b=a.vs();a=a.eB();b?b.io(a):this.head=a;a?a.nl(b):this.xf=b}};a.g.prototype.oq=function(a){a.io(this.head);this.head?this.head.nl(a):this.xf=a;a.nl(null);this.head=a};a.g.prototype.sJ=function(a,b){var c=this.wc()[a];this.by(c);c||this.Sd++;this.wc()[a]=b;b.ho(a);this.oq(b)};a.g.prototype.YD=function(a){var b=this.xf,c,f,h=0;for(this.xf=null;b&&h<a;)c=b.index,(f=this.wc()[c])&&f.Br()?(this.xf||(this.xf=b),b=b.vs()):(this.Sd--,
-1<c&&(this.wc()[c]=void 0),b.io(null),b=b.nl(null),h++);this.xf||(this.xf=b);0>this.Sd&&(this.Sd=0);0===this.Sd&&(this.xf=this.head=null)};a.g.prototype.hn=function(){this.Sd=0;this.xf=this.head=null};a.g.prototype.Tg=function(a){if(this.Ba()){var b=this.PF();-1<b&&this.Sd+a>b&&this.YD(this.Sd+a-b)}};a.g.prototype.clone=function(){var a=new this.constructor,b,c;this.Ba()&&(a=this.dE(a),a.hy());for(b=0;b<this.cc();b+=1)(c=this.Ql(b,null,!0,!1))&&a.Gf(c.clone(),{at:b},!0,!1);return a};a.a.c("Collection.prototype.clone",
{clone:a.g.prototype.clone});a.g.prototype.dE=function(d){var b=["totalResults","hasMore",a.g.jd],c,f;for(f=0;f<b.length;f++)c=b[f],d[c]=this[c];return d};a.g.prototype.cc=o_c("length");a.g.prototype.jk=function(){var a=this.Ka();this.length=a;this.Ba()||(this.totalResults=a)};a.g.prototype.$j=function(d,b){var c=null,f,c=d instanceof a.h?d:this.model?a.h.tc(this.model)?new this.model(d,b):new this.model.constructor(d,b):new a.h(d,b);b=b||{};return b.validate&&c.validate&&(f=c.validate(c.attributes))?
(b.validationError=f,this.jb(!1,a.L.t.INVALID,this,f,b),null):c};a.g.prototype.add=function(a,b){this.Tg(1);return this.Gf(a,b,!1,(b||{}).deferred)};a.a.c("Collection.prototype.add",{add:a.g.prototype.add});a.g.prototype.Gf=function(d,b,c,f){function h(d,f,h,g,e){var l;q&&h?s=h.kB(f,d.comparator):(l=d.Wv(g),void 0===l&&(void 0===k?(d.tI(g),n=d.Ka()-1,d.da(n).ml()):(n=k,d.Ba()&&c?d.sJ(n,g):d.Ry(n,0,g),d.da(n).ml(),k+=1),void 0===g.Ti()&&g.Yi(d),d.jk(),d.JH(g),t=!0));c&&(b=b||{},b.fillIn=!0);s&&(void 0===
l&&!r&&void 0===k&&1<d.cc())&&(-1<n&&(p=d.da(n).cid),d.sort(b),-1<n&&(n=d.indexOf(d.gh(p),e)));t&&(g?g.jb(m,a.L.t.ADD,g,d,b):h.jb(m,a.L.t.ADD,h,d,b))}function g(d,f,g){var e=d.$j(f,b),l=null,p=null;if(null!=e){n=-1;e.xe();l=f instanceof a.h?f:e;if(g)return d.Hg(l,null,g,!0).done(function(c){p=c.m;return h(d,l,p,e,g)});p=c?d.Wv(l):d.get(l);h(d,l,p,e,g)}}b=b||{};var l=[],k=b.at,m=b.silent,n,p,q=b.merge||!1,r=b.sort,s=!0,t=!1;d instanceof Array?l=d:l.push(d);if(!c&&(this.Ba()||f)){var v=this,y=function(c){var b=
e.Deferred();g(v,l[c],!0).done(function(){b.resolve(c)});return b.promise()};f=y(0);var A=function(c){return y(c+1)};for(d=1;d<l.length;d++)f=f.then(A);return e.when(f).promise()}for(d=0;d<l.length;d++)g(this,l[d],!1)};a.g.prototype.Mm=function(){var a=this.comparator;return void 0!==a&&null!==a};a.g.prototype.sort=function(d){d=d||{};d=d.silent;var b=this.comparator,c;this.Mm()&&(this.Ba()&&this.aH()?(d=this.totalResults,void 0!==d?this.ki(Array(d)):(this.ki([]),this.hn(),this.jk())):(c=this,this.wc().sort(function(d,
h){return a.g.ko(d,h,b,c,c)}),this.Dx(0),this.jb(d,a.L.t.SORT,this,null,null)))};a.a.c("Collection.prototype.sort",{sort:a.g.prototype.sort});a.g.Cj=function(d,b){return d instanceof a.h?d.get(b):a.h.tc(d[b])?d[b]():d[b]};a.g.ko=function(d,b,c,f,h){var g,e,k;if(a.h.tc(c)){if(1===c.length){g=c.call(h,d);e=c.call(h,b);g=a.Xa.le(g)?g.split(","):[g];var m=a.Xa.le(e)?e.split(","):[e];for(k=0;k<g.length;k++)if(e=a.g.zg(g[k],m[k],f.sortDirection),0!==e)return e}return c.call(h,d,b)}if(a.Xa.le(c))for(c=c.split(","),
k=0;k<c.length;k++)if(g=a.g.Cj(d,c[k]),e=a.g.Cj(b,c[k]),e=a.g.zg(g,e,f.sortDirection),0!==e)return e;return 0};a.g.prototype.KA=function(d){var b=this.comparator;if(!this.Mm())return-1;this.qd("sortedIndex");return a.g.gF(this.wc(),d,b)};a.a.c("Collection.prototype.sortedIndex",{KA:a.g.prototype.KA});a.g.gF=function(a,b,c){function f(h,g){var e,k;if(h>g)return-1;e=b.ve();k=b.Xd();if(a[h].Wi(k,e))return h;if(a[g].Wi(k,e))return g;e=Math.floor((g+h)/2);return-1===c(a[e],b)?f(h+1,e):1===c(a[e],b)?f(e,
g-1):e}return f(0,a.length-1)};a.g.zg=function(a,b,c){if(-1===c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};a.g.prototype.unshift=function(d,b){var c={};a.Rb.kf(c,b||{});c.at||(c.at=0);this.Tg(1);return this.Gf(d,c,!1,c.deferred)};a.a.c("Collection.prototype.unshift",{unshift:a.g.prototype.unshift});a.g.prototype.shift=function(a){var b=this.Yc(a);if(this.Ba()||b){var c=this;return this.at(0,a).then(function(b){return c.Xg(b,0,a)})}return this.Xg(this.at(0),0,a)};
a.a.c("Collection.prototype.shift",{shift:a.g.prototype.shift});a.g.prototype.iA=function(a){void 0===a&&(a=1);var b=[],c;for(c=0;c<this.cc()-a;c+=1)b.push(this.at(c));return b};a.a.c("Collection.prototype.initial",{iA:a.g.prototype.iA});a.g.prototype.Yc=function(a){return(a||{}).deferred};a.g.prototype.last=function(a,b){var c=this.Yc(b);void 0===a&&(a=1);if(1===a){var f=this.Ka();0===f&&(f=a);return 0<f?this.at(f-1,c):null}var h=[],f=this.cc();if(c||this.Ba())return h=f-a,0>h&&(h=0),0===f&&(f=a),
this.Wm(h,f);for(c=f-a;c<f;c+=1)h.push(this.at(c));return h};a.a.c("Collection.prototype.last",{last:a.g.prototype.last});a.g.prototype.Wm=function(a,b){function c(c){return f(c+1)}function f(c){var b=e.Deferred();l.kp(c,null).done(function(a){h.push(a);b.resolve(c)});return b.promise()}var h=[],g,l=this,k=f(a);for(g=a+1;g<b;g++)k=k.then(c);return e.when(k).then(function(){return h})};a.g.prototype.Ov=function(d){return void 0===d||null===d?this[a.g.jd]:d};a.g.prototype.QD=function(){var d=this.lastFetchCount;
if(void 0===d||null===d)d=this[a.g.jd];return void 0===this.offset||null===this.offset?d:this.offset+d};a.g.prototype.next=function(d,b){b=b||{};b[a.g.jd]=this.Ov(d);var c=this.QD(),f=this.cc();if(0===f&&0<b[a.g.jd])c=0;else if(c>=f)return b.success&&b.success.call(a.h.Se(b,this),this,null,b),null;b.startIndex=c;return this.fetch(b)};a.a.c("Collection.prototype.next",{next:a.g.prototype.next});a.g.prototype.RD=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};a.g.prototype.previous=
function(d,b){b=b||{};if(0===this.offset)return b.success&&this.lastFetchCount&&b.success.call(a.h.Se(b,this),this,null,b),null;b[a.g.jd]=this.Ov(d);var c=this.RD(b[a.g.jd]);0>c&&(b[a.g.jd]=this.offset,c=0);b.startIndex=c;return this.fetch(b)};a.a.c("Collection.prototype.previous",{previous:a.g.prototype.previous});a.g.prototype.bs=function(a){this.modelLimit=a;this.Tg(0)};a.a.c("Collection.prototype.setModelLimit",{bs:a.g.prototype.bs});a.g.prototype.PF=o_c("modelLimit");a.g.prototype.HA=function(d){this[a.g.jd]=
d};a.g.prototype.DA=function(a,b){var c=this.Yc(b);void 0===a&&(a=1);var f=[];if(this.Ba()||c)return this.Wm(a,this.cc());for(c=a;c<this.cc();c+=1)f.push(this.at(c));return f};a.a.c("Collection.prototype.rest",{DA:a.g.prototype.DA});a.g.prototype.remove=function(a,b){b=b||{};var c=[],f;a instanceof Array?c=a:c.push(a);for(f=c.length-1;0<=f;f-=1)this.Xg(c[f],-1,b)};a.a.c("Collection.prototype.remove",{remove:a.g.prototype.remove});a.g.prototype.Xg=function(d,b,c){c=c||{};d=-1==b?this.Hg(d):a.g.Jg(b,
d);var f=c.silent;b=d.index;if(-1<b){var h=d.m;void 0!==h&&h.Ti()===this&&h.Yi(null);this.Ry(b,1);this.jk();var g={};a.Rb.kf(g,c);g.index=b;void 0!==h&&h.jb(f,a.L.t.REMOVE,h,this,g);this.iz(h)}return d.m};a.g.prototype.iz=function(a){void 0!==a&&a.off(null,null,this)};a.g.prototype.JH=function(d){d.Ue(a.L.t.ALL,this.UH,this,!1,!0)};a.g.prototype.UH=function(d,b,c,f){d===a.L.t.DESTROY&&this.remove(b);if(void 0===c||c===this)Array.prototype.slice.call(arguments),this.jb(f&&f.silent,d,b,c,f)};a.g.prototype.reset=
function(d,b){var c;b=b||{};b.previousModels=this.wc();if(void 0===d||null==d||d instanceof Array&&0==d.length){for(c=0;c<this.Ka();c+=1)this.da(c)&&this.da(c).Yi(null);this.ki([]);this.hn()}else if(this.ki([]),this.hn(),b.parse&&(d=this.parse(d)),d instanceof Array)for(this.Tg(d.length),c=0;c<d.length;c+=1)this.Gf(d[c],b,!0,!1);else this.Tg(1),this.Gf(d,b,!0,!1);this.jk();this.jb(void 0!==b.silent&&b.silent,a.L.t.RESET,this,b,null)};a.a.c("Collection.prototype.reset",{reset:a.g.prototype.reset});
a.g.prototype.at=function(a,b){return this.Ql(a,b,!1,this.Yc(b))};a.a.c("Collection.prototype.at",{at:a.g.prototype.at});a.g.prototype.Ql=function(a,b,c,f){return 0>a||this.bI(a)?null:c||!this.Ba()&&!f?this.da(a):this.kp(a,b).promise()};a.g.prototype.kp=function(d,b){function c(){h.resolve(f.da(d))}var f=this,h=e.Deferred(),g=this.da(d);return void 0===g?(g={},a.Rb.kf(g,b||{}),g.context=this,g.startIndex=d,this.lm(g,!1).then(c),h):e.Deferred().resolve(g)};a.g.prototype.gh=function(a){var b,c;for(b=
0;b<this.Ka();b+=1)if(c=this.da(b),void 0!==c&&a===c.cid)return c;if(this.Ba())throw Error("Not found locally and not supported by server for virtual collections");return null};a.a.c("Collection.prototype.getByCid",{gh:a.g.prototype.gh});a.g.prototype.get=function(a,b){var c=this.Hg(a,b,this.Yc(b));if(c){if(e.isFunction(c.promise))return c.then(function(c){return c.m});if(c.hasOwnProperty("m"))return c.m}return null};a.a.c("Collection.prototype.get",{get:a.g.prototype.get});a.g.prototype.Wv=function(a){return(a=
this.Xv(a))?a.m:null};a.g.prototype.Xv=function(d){var b,c=d,f=this.Ka(),h;d instanceof a.h?(c=d.ve(),d=d.Xd()):void 0!==d&&(null!=d&&void 0!==d.id)&&(d=d.id);for(b=0;b<f;b+=1)if(h=this.da(b),void 0!==h&&h.Wi(d,c))return a.g.Jg(b,h);return a.g.Jg(-1,void 0)};a.g.prototype.Hg=function(d,b,c,f){var h,g=d;void 0===f&&(f=!1);d instanceof a.h?(g=d.ve(),d=d.Xd()):void 0!==d&&(null!=d&&void 0!==d.id)&&(d=d.id);var l;for(h=0;h<this.Ka();h+=1)if(l=this.da(h),void 0!==l&&l.Wi(d,g))return d=a.g.Jg(h,l),c?e.Deferred().resolve(d):
d;if(this.Ba()){if(void 0===d&&void 0!==g)throw Error("cid not supported on virtual get by ID: only id supported");var k=e.Deferred(),m=this;c={};a.Rb.kf(c,b||{});c.context=this;c.startID=d;this.lm(c,f).then(function(c){null!=c?(c=m.Zv(),k.resolve(a.g.Jg(c,m.da(c)))):k.resolve(a.g.Jg(-1,void 0))});return k}d=a.g.Jg(-1,void 0);return c?e.Deferred().resolve(d):d};a.g.Jg=function(a,b){return{index:a,m:b}};a.g.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&
a[b]instanceof Array)return a[b];return a};a.g.prototype.cs=function(a,b){var c=e.Deferred();if(this.Ir(a,b))return e.Deferred().resolve();var f=this.Yv(a,b);!this.Nj()&&f<a+b&&(f=a+b);this.lm(this.Ba()?{context:this,startIndex:a,fetchSize:f-a}:{context:this},!1).then(function(){c.resolve()});return c};a.a.c("Collection.prototype.setRangeLocal",{cs:a.g.prototype.cs});a.g.prototype.Yv=function(a,b){var c=this.Ka();return a+b>c?c:a+b};a.g.prototype.Ir=function(a,b){if(!this.Ba())return 0<this.Ka();
var c=this.Yv(a,b);if(!this.Nj()&&c<a+b)return!1;for(var f=a;f<c;f++)if(void 0===this.da(f))return!1;return!0};a.a.c("Collection.prototype.isRangeLocal",{Ir:a.g.prototype.Ir});a.g.prototype.fetch=function(a){return this.lm(a,!1)};a.a.c("Collection.prototype.fetch",{fetch:a.g.prototype.fetch});a.g.prototype.lm=function(d,b){var c=d||{},f=c.success,h,g;void 0===c.parse&&(c.parse=!0);g=this;c.success=function(e){var k,m;g.tJ(e,d);k=g.parse(e,d);var n=null;if(c.add||g.model){if(g.Ba()?b||g.hy():c.add||
g.reset(),m=a.g.Su(g),k){var n=k instanceof Array?k:[k],p={},q=g.Zv();g.Tg(n.length);for(k=0;k<n.length;k+=1)h=m&&c.parse?m.parse(n[k]):n[k],g.Ba()&&(p={at:q+k}),p.silent=!0,g.Gf(h,p,!0,!1)}}else n=k instanceof Array?k:[k],b||g.reset(k);g.Ba()&&n&&(g.lastFetchCount=n.length);g.jb(!1,a.L.t.SYNC,g,e,c);f&&f.call(a.h.Se(d,g),g,e,c)};return this.vv(c)};a.g.prototype.dF=function(d){var b=d||{},c=b.success,f,h;void 0===b.parse&&(b.parse=!0);h=this;b.success=function(g){var e,k;e=h.parse(g,d);var m=null,
n=[];if(b.add||h.model)if(k=a.g.Su(h),e)for(m=e instanceof Array?e:[e],e=0;e<m.length;e+=1)f=k&&b.parse?k.parse(m[e]):m[e],n.push(h.$j(f));h.jb(!1,a.L.t.SYNC,h,g,b);c&&c.call(a.h.Se(d,h),h,n,b)};this.vv(b)};a.g.Su=function(d){if(d.model)return a.h.tc(d.model)?new d.model:new d.model.constructor};a.g.prototype.vv=function(d){try{return a.h.Qj("read",this,d)}catch(b){throw this.jb(!1,a.L.t.ERROR,this,null,d),b;}};a.g.prototype.hy=function(){var a=this.totalResults;void 0!==a&&this.Ka()!==a&&(this.ki(Array(a)),
this.hn())};a.g.prototype.um=function(d){d=d||{};return d[a.g.jd]||this[a.g.jd]};a.g.prototype.aH=function(){return void 0!==this.hasMore&&this.hasMore};a.g.prototype.Ba=function(){return-1<this.um(null)};a.g.prototype.Bm=function(d,b,c,f,h){d=parseInt(a.g.Am(d,b,c),10);return void 0===d||null===d||isNaN(d)?f?f:h:d};a.g.prototype.tJ=function(d,b){var c={};this.customPagingOptions&&((c=this.customPagingOptions.call(this,d))||(c={}));b=b||{};this.lastFetchSize=this.Bm(c,d,"limit",b.fetchSize,this.fetchSize);
this.offset=this.Bm(c,d,"offset",b.startIndex,0);this.lastFetchCount=this.Bm(c,d,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.Bm(c,d,"totalResults",this.totalResults,this.totalResults);this.hasMore=this.EF(a.g.Am(c,d,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);!this.Ba()&&this.lastFetchSize&&this.HA(this.lastFetchSize)};a.g.prototype.EF=function(a,b,c,f){return a&&void 0!==a?a:b+c>f?!1:!0};a.g.Am=function(a,b,c){return a[c]?a[c]:b?b[c]:void 0};a.g.prototype.Zv=
function(){return void 0!==this.offset?this.offset:0};a.g.prototype.create=function(d,b){function c(c,f,h,g){return!1===f.save(d instanceof a.h?null:d,g)&&(b.validationError=f.validationError,c.jb(!1,a.L.t.INVALID,c,f.validationError,g),h)?(c.iz(f),c.remove(f),!1):f}var f=this.Yc(b);b=b||{};var h=this.$j(d,b),g=b.success,l=b.context,k=b.validate;b.context=this;b.success=function(c,b,a){g&&g.call(null!=l?l:this,c,b,a)};if(null==h)return!1;b.forceNew=null!=h.Xd();h.Yi(this);var m=this;if(f||this.Ba()){var n=
e.Deferred();this.add(h,{merge:!0,deferred:!0}).done(function(){b.success=function(c,b,a){g&&g.call(null!=l?l:this,c,b,a);n.resolve(c)};var a=c(m,h,k,b);a||n.resolve(a)});return n.promise()}this.add(h,{merge:!0});return c(this,h,k,b)};a.a.c("Collection.prototype.create",{create:a.g.prototype.create});a.g.prototype.yA=function(a){var b=[],c;this.qd("pluck");for(c=0;c<this.cc();c+=1)b.push(this.at(c).get(a));return b};a.a.c("Collection.prototype.pluck",{yA:a.g.prototype.yA});a.g.prototype.$n=function(a,
b){var c=this.Yc(b);if(this.Ba()){var f=e.Deferred();this.dF({query:a,success:function(c,b){f.resolve(b)}});return f.promise()}var h=[],g,l;for(g=0;g<this.cc();g+=1)l=this.at(g),l.ZA(a)&&h.push(l);return c?e.Deferred().resolve(h):h};a.a.c("Collection.prototype.where",{$n:a.g.prototype.$n});a.g.prototype.qd=function(a){if(this.Ba())throw Error(a+" not valid on a virtual Collection");};a.g.prototype.map=function(a,b){var c=[],f,h;this.qd("map");for(h=0;h<this.Ka();h+=1)f=a.call(b||this,this.da(h)),
c.push(f);return c};a.a.c("Collection.prototype.map",{map:a.g.prototype.map});a.g.prototype.each=function(a,b){this.qd("each");this.wc().forEach(a,b)};a.a.c("Collection.prototype.each",{each:a.g.prototype.each});a.g.prototype.size=function(){return this.cc()};a.a.c("Collection.prototype.size",{size:a.g.prototype.size});a.g.prototype.JA=function(d,b){var c,f=[],h;this.qd("sortBy");for(c=0;c<this.Ka();c+=1)f.push(this.da(c));h=this;f.sort(function(c,f){var e,m;if(a.h.tc(d))return e=d.call(b||h,c),m=
d.call(b||h,f),a.g.zg(e,m,h.sortDirection);e=c.get(d);m=f.get(d);return a.g.zg(e,m,h.sortDirection)});return f};a.a.c("Collection.prototype.sortBy",{JA:a.g.prototype.JA});a.g.prototype.fA=function(d,b){var c,f={},h;this.qd("groupBy");for(c=0;c<this.Ka();c+=1)h=a.h.tc(d)?d.call(b||this,this.da(c)):this.da(c).get(d),void 0===f[h]&&(f[h]=[]),f[h].push(this.da(c));return f};a.a.c("Collection.prototype.groupBy",{fA:a.g.prototype.fA});a.g.prototype.min=function(a,b){var c,f={},h,g;this.qd("min");if(0==
this.Ka())return null;f=this.da(0);h=a.call(b||this,this.da(0));for(c=1;c<this.Ka();c+=1)g=a.call(b||this,this.da(c)),g<h&&(f=this.da(c),h=g);return f};a.a.c("Collection.prototype.min",{min:a.g.prototype.min});a.g.prototype.max=function(a,b){var c,f={},h,g;this.qd("max");if(0==this.Ka())return null;f=this.da(0);h=a.call(b,this.da(0));for(c=1;c<this.Ka();c+=1)g=a.call(b||this,this.da(c)),g>h&&(f=this.da(c),h=g);return f};a.a.c("Collection.prototype.max",{max:a.g.prototype.max});a.g.prototype.filter=
function(a,b){var c,f=[];this.qd("filter");for(c=0;c<this.Ka();c+=1)a.call(b||this,this.da(c))&&f.push(this.da(c));return f};a.a.c("Collection.prototype.filter",{filter:a.g.prototype.filter});a.g.prototype.VA=function(a){var b=[],c,f,h;this.qd("without");if(arguments){for(c=0;c<this.Ka();c+=1){h=!0;for(f=0;f<arguments.length;f+=1)if(this.da(c).Wi(arguments[f].Xd(),arguments[f].ve())){h=!1;break}h&&b.push(this.da(c))}return b}return this.wc()};a.a.c("Collection.prototype.without",{VA:a.g.prototype.VA});
a.g.prototype.Dc=function(){return 0===this.cc()};a.a.c("Collection.prototype.isEmpty",{Dc:a.g.prototype.Dc});a.g.prototype.vz=function(a,b){var c;this.qd("any");for(c=0;c<this.Ka();c+=1)if(a.call(b||this,this.da(c)))return!0;return!1};a.a.c("Collection.prototype.any",{vz:a.g.prototype.vz});a.g.prototype.Kz=function(a,b){var c=this.Yc(b);if(this.Ba()||c){var f=e.Deferred();this.$n(a,b).done(function(c){c&&0<c.length&&f.resolve(c[0]);f.resolve(null)});return f.promise()}c=this.$n(a);return 0<c.length?
c[0]:null};a.a.c("Collection.prototype.findWhere",{Kz:a.g.prototype.Kz});a.g.prototype.slice=function(a,b,c){var f=this.Yc(c);c=[];if(void 0===b){if(this.Ba&&!this.Nj())throw Error("End must be set for virtual collections with no totalResults");b=this.Ka()}if(f||this.Ba())return this.Wm(a,b);for(;a<b;a+=1)c.push(this.da(a));return c};a.a.c("Collection.prototype.slice",{slice:a.g.prototype.slice});a.g.prototype.set=function(a,b){return this.lJ(a,b,this.Yc(b))};a.a.c("Collection.prototype.set",{set:a.g.prototype.set});
a.g.Ux=function(a,b,c,f){if(b)for(b=a.Ka()-1;0<=b;b-=1)-1==c.indexOf(b)&&a.Xg(a.da(b),b,f)};a.g.prototype.lJ=function(d,b,c){b=b||{};var f=void 0===b.add?!0:b.add,h=void 0===b.remove?!0:b.remove,g=void 0===b.merge?!0:b.merge,e=[],k=null,m;b.parse&&(d=this.parse(d));m=a.h.isArray(d)?d:[d];if(this.Ba()||c)return this.OE(m,b,h,f,g);for(d=0;d<m.length;d+=1)k=this.nz(this.$j(m[d],b),f,g,c),-1!==k&&e.push(k);a.g.Ux(this,h,e,b)};a.g.prototype.OE=function(d,b,c,f,h){function g(c){return l(c+1)}function l(c){var a=
e.Deferred();n.nz(n.$j(d[c],b),f,h,!0).done(function(b){-1!==b&&k.push(b);a.resolve(c)});return a.promise()}var k=[],m,n=this,p=l(0);for(m=1;m<d.length;m+=1)p=p.then(g);return e.when(p).then(function(){a.g.Ux(n,c,k,b)})};a.g.prototype.nz=function(a,b,c,f){function h(f,h,g){var l=h?h.index:-1;if(h&&h.m){if(c){h={merge:c};if(g){var q=e.Deferred();f.Gf(a,h,!1,!0).done(function(){q.resolve(l)});return q.promise()}f.add(a,h)}}else if(b){if(g)return q=e.Deferred(),f.add(a,{deferred:!0}).done(function(){q.resolve(f.cc()-
1)}),q.promise();f.add(a);l=f.cc()-1}return l}if(f||this.Ba()){var g=this,l=e.Deferred();this.Hg(a,null,f).done(function(c){h(g,c,!0).done(function(c){l.resolve(c)})});return l.promise()}f=this.Hg(a);return h(this,f,!1)};a.g.prototype.toJSON=function(){var a=[],b;this.qd("toJSON");for(b=0;b<this.Ka();b+=1)a.push(this.da(b).toJSON());return a};a.a.c("Collection.prototype.toJSON",{toJSON:a.g.prototype.toJSON});a.g.prototype.first=function(a,b){var c=this.Yc(b),f=this.cc(),h=[];a?f=a:a=1;c=this.Ba()||
c;if(1===a)return c?this.kp(0,null).promise():0<this.Ka()?this.da(0):null;f>this.Ka()&&(!this.Ba()||this.Nj())&&(f=this.Ka());if(c)return this.Wm(0,f);for(c=0;c<f;c+=1)h.push(this.da(c));return h};a.a.c("Collection.prototype.first",{first:a.g.prototype.first});a.g.prototype.indexOf=function(a,b){var c=this.Yc(b);return this.Ba()||c?this.Hg(a,null,!0).then(function(c){return c.index}):this.Hg(a).index};a.a.c("Collection.prototype.indexOf",{indexOf:a.g.prototype.indexOf});a.g.prototype.RH=function(a){a=
this.Xv(a);return void 0!==a?a.index:-1};a.g.prototype.pop=function(a){var b=this.Yc(a);if(this.Ba()||b){var c=this;return this.at(this.cc()-1,{deferred:b}).then(function(b){c.remove(b,a);return b})}b=this.at(this.cc()-1);this.remove(b,a);return b};a.a.c("Collection.prototype.pop",{pop:a.g.prototype.pop});a.g.prototype.push=function(a,b){var c=this.Yc(b);this.Tg(1);return this.Gf(a,b,!1,c)};a.a.c("Collection.prototype.push",{push:a.g.prototype.push});a.g.prototype.lastIndexOf=function(d,b){var c;
this.qd("lastIndexOf");void 0===b&&(b=0);for(c=this.cc()-1;c>=b;c-=1)if(a.a.kh(d,this.at(c)))return c;return-1};a.a.c("Collection.prototype.lastIndexOf",{lastIndexOf:a.g.prototype.lastIndexOf});a.g.prototype.Sp=function(a){return void 0===a?[]:a.split(",")};a.g.ZF=function(d){d=a.h.isArray(d)?d:[d];var b="",c,f,h,g;for(h=0;h<d.length;h++){c=d[h];for(g in c)c.hasOwnProperty(g)&&(f=g+"\x3d"+c[g],b+=f+"+");b=b.substring(0,b.length-1)+","}return","===b.substring(b.length-1)?b.substring(0,b.length-1):
b};a.g.prototype.oB=function(d){var b={},c;for(c in d)d.hasOwnProperty(c)&&(b[c]=d[c]);if(d=this.comparator){d=this.Sp(d);for(c=0;c<d.length;c++)b.sort=0===c?d[c]:b.sort+(","+d[c]);b.sortDir=this.Tp()}this.Ba()&&(b[a.g.jd]=this.um(null));return b};a.g.prototype.dB=function(d){var b=a.h.tc(this.url)?this.url():this.url;if(this.Ba()){b+="?limit\x3d"+this.um(d);d.startIndex&&(b+="\x26offset\x3d"+d.startIndex);d.startID&&(b+="\x26fromID\x3d"+d.startID);d.since&&(b+="\x26since\x3d"+d.since);d.until&&(b+=
"\x26until\x3d"+d.until);d.query&&(d=a.g.ZF(d.query))&&0<d.length&&(b+="\x26q\x3d"+d);if(d=this.comparator){d=this.Sp(d);var c=this.Tp(),f;for(f=0;f<d.length;f++)b=0===f?b+("\x26orderBy\x3d"+d[f]+":"+c):b+(","+d[f]+":"+c)}b+="\x26totalResults\x3dtrue"}return b};a.g.prototype.Tp=function(){return-1===this.sortDirection?"dsc":"asc"};a.g.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.g.jd="fetchSize";a.Oa=function(a,b){this.Xk=a;this.je=b;jQuery.support.cors=!0};a.Oa.yh="headers";a.Oa.rk=
function(d,b,c){var f;d=e.extend(!0,d,c);for(f in b)b.hasOwnProperty(f)&&"oauthHeader"!==f&&(d.hasOwnProperty(f)||(d[f]=b[f]),f===a.Oa.yh&&(d[f]=e.extend(!0,d[f],b[f])));if(b.oauthHeader)for(f in d[a.Oa.yh]||(d[a.Oa.yh]={}),b.oauthHeader)b.oauthHeader.hasOwnProperty(f)&&(d[a.Oa.yh].hasOwnProperty(f)||(d[a.Oa.yh][f]=b.oauthHeader[f]));return d};a.Oa.prototype.LK=function(d,b,c,f){c=c||{};var h="jsonp"===c.dataType,g=this.Lj("read",this.Xk,this.je,null,f,c);d={crossDomain:c.crossDomain||!h,dataType:c.dataType||
"json",jsonpCallback:c.jsonpCallback,context:null!==f?f:this,success:d,error:b};d=this.Ml(d);d=a.Oa.rk(d,c,g);c.xhr=this.ajax(d);return c.xhr};a.Oa.prototype.Ml=function(d){d[a.Oa.yh]={"Accept-Language":this.ed()};return d};a.Oa.prototype.KK=function(d,b,c,f,h){f=f||{};var g="jsonp"===f.dataType;c=this.Lj("read",this.Xk,this.je,c,h,f);d={crossDomain:f.crossDomain||!g,dataType:f.dataType||"json",jsonpCallback:f.jsonpCallback,context:null!==h?h:this,success:d,error:b};d=this.Ml(d);d=a.Oa.rk(d,f,c);
f.xhr=this.ajax(d);return f.xhr};a.Oa.prototype.TA=function(d,b,c,f,h,g,e){h=h||{};var k="jsonp"===h.dataType;b=this.Lj(e?"patch":"update",this.Xk,this.je,b,g,h);d={crossDomain:h.crossDomain||!k,contentType:h.contentType||"application/json",dataType:h.dataType||"json",jsonpCallback:h.jsonpCallback,data:JSON.stringify(c),success:d,error:f,context:null!==g?g:this};d=this.Ml(d);d=a.Oa.rk(d,h,b);h.xhr=this.ajax(d);return h.xhr};a.Oa.prototype.Kp=function(a,b){return b.type?b.type:"create"===a?"POST":
"delete"===a?"DELETE":"patch"===a?"PATCH":"update"===a?"PUT":"GET"};a.Oa.prototype.fJ=function(d,b,c){b=b instanceof a.g?b.oB(c):{};d&&(b.recordID=d);return b};a.Oa.prototype.Lj=function(d,b,c,f,h,g){if(a.h.tc(c)){c=c.call(this,d,h,this.fJ(f,h,g));if(a.Xa.le(c))return{url:c,type:this.Kp(d,g)};if(c)return c.url=c.hasOwnProperty("url")?c.url:b,c.type=c.hasOwnProperty("type")?c.type:this.Kp(d,g),c}return{url:b,type:this.Kp(d,g)}};a.Oa.prototype.wK=function(d,b,c,f){c=c||{};var h="jsonp"===c.dataType;
d=this.Lj("delete",this.Xk,this.je,d,f,c);b={crossDomain:c.crossDomain||!h,success:c.success,error:b,context:null!==f?f:this};b=a.Oa.rk(b,c,d);c.xhr=this.ajax(b);return c.xhr};a.Oa.prototype.cK=function(d,b,c,f){c=c||{};var h=JSON.stringify(d),g="jsonp"===c.dataType;d=this.Lj("create",this.Xk,this.je,null,f,c);b={crossDomain:c.crossDomain||!g,contentType:c.contentType||"application/json",dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,data:h,success:c.success,error:b,context:null!==f?f:
this};b=this.Ml(b);b=a.Oa.rk(b,c,d);c.xhr=this.ajax(b);return c.xhr};a.Oa.prototype.ed=function(){return a.Ea.ed()};a.Oa.prototype.ajax=function(a){return window.oj.ajax(a)};a.ua=function(d,b){b=b||{};a.ua._init(this,b,d||"Authorization")};o_("OAuth",a.ua,a);a.a.ea(a.ua,a.a,"OAuth.OAuth");a.ua.prototype.i=function(){a.ua.q.i.call(this)};a.ua.prototype.getHeader=function(){var a={};this.cg.access_token||this.jr();a[this.He.Bz]="Bearer "+this.cg.access_token;return a};a.a.c("OAuth.prototype.getHeader",
{getHeader:a.ua.prototype.getHeader});a.ua.prototype.mA=function(){return this.cg.QM?!0:!1};a.a.c("OAuth.prototype.isInitialized",{mA:a.ua.prototype.mA});a.ua.prototype.jr=function(){var d={},b=this;d[b.He.Bz]="Basic "+a.ua.DD(b.He.client_id+":"+b.He.client_secret);e.ajax({type:"POST",async:!1,url:this.He.bearer_url,data:"grant_type\x3dclient_credentials",headers:d,success:function(c){a.ua.Pj(b.cg,c)},error:function(c){throw Error(c.responseText);}})};a.a.c("OAuth.prototype.clientCredentialGrant",
{jr:a.ua.prototype.jr});a.ua.prototype.FA=function(d){a.ua.Pj(this.cg,d)};a.a.c("OAuth.prototype.setAccessTokenResponse",{FA:a.ua.prototype.FA});a.ua.prototype.Nz=o_c("cg");a.a.c("OAuth.prototype.getAccessTokenResponse",{Nz:a.ua.prototype.Nz});a.ua.prototype.Dz=function(){a.ua.Cu(this.cg)};a.a.c("OAuth.prototype.cleanAccessTokenResponse",{Dz:a.ua.prototype.Dz});a.ua.prototype.EA=function(d){a.ua.Pj(this.He,d)};a.a.c("OAuth.prototype.setAccessTokenRequest",{EA:a.ua.prototype.EA});a.ua.prototype.Mz=
o_c("He");a.a.c("OAuth.prototype.getAccessTokenRequest",{Mz:a.ua.prototype.Mz});a.ua.prototype.Cz=function(){a.ua.Cu(this.He)};a.a.c("OAuth.prototype.cleanAccessTokenRequest",{Cz:a.ua.prototype.Cz});a.ua._init=function(d,b,c){d.i();d.He={};d.cg={};b.access_token?a.ua.Pj(d.cg,b):b.client_id&&(b.client_secret&&b.bearer_url)&&a.ua.Pj(d.He,b);d.He.Bz=c};a.ua.Pj=function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};a.ua.Cu=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};
a.ua.DD=function(a){var b,c,f,h,g=0,e=0,k=[];do b=a.charCodeAt(g++),c=a.charCodeAt(g++),f=a.charCodeAt(g++),h=b<<16|c<<8|f,b=h>>18&63,c=h>>12&63,f=h>>6&63,h&=63,k[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(h);while(g<a.length);
k=k.join("");b=a.length%3;return(b?k.slice(0,b-3):k)+"\x3d\x3d\x3d".slice(b||3)}});
//# sourceMappingURL=oj-modular.map