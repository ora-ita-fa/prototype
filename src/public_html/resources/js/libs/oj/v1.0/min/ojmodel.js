define(["ojs/ojcore","jquery"],function(a,e){a.H=window.oj.Events={on:function(a,b,c){return this.sf(a,b,c,!1,!1)},off:function(a,b,c){return this.rr(a,b,c,!1)},trigger:function(d){var b=Array.prototype.slice.call(arguments);b.unshift(!1);return a.H.ub.apply(this,b)},once:function(a,b,c){return this.Iy(a,b,c,!1)},listenTo:function(d,b,c){var f,h,g,e,k={};b.constructor===String?k[b]=c:k=b;for(e in k)if(k.hasOwnProperty(e))for(b=a.H.hh(e),c=0;c<b.length;c+=1)f=b[c].event,h=b[c].ib,g={event:f,ib:h,object:d,
Bb:k[e]},this.Np(this.pb,g,a.H.qy),f=h?f+":"+h:f,void 0===this.pb&&(this.pb=[]),this.pb.push(g),d.sf(f,k[e],null,!0,!1);return this},listenToOnce:function(d,b,c){var f,h,g,e,k={};b.constructor===String?k[b]=c:k=b;for(e in k)if(k.hasOwnProperty(e))for(b=a.H.hh(e),c=0;c<b.length;c+=1)f=b[c].event,h=b[c].ib,g={event:f,ib:h,object:d,Bb:k[e]},this.Np(this.pb,g,a.H.qy),f=h?f+":"+h:f,void 0===this.pb&&(this.pb=[]),this.pb.push(g),d.Iy(f,k[e],null,!0);return this},stopListening:function(d,b,c){var f,h={},
g,e,k,n,m,p,q,r,s;if(null==arguments||0==arguments.length){m=this.pb?this.pb.length:0;for(r=0;r<m;r++)p=this.pb[r].object.rr,p.apply(this.pb[r].object,[this.pb[r].event,this.pb[r].Bb,this.pb[r].context,!0]);this.pb=[];return this}f=b;d&&d.constructor===String&&(f=d);f.constructor===String?h[f]=c:h=f;for(s in h)if(h.hasOwnProperty(s))for(f=a.H.hh(s),g=0;g<f.length;g+=1)for(e=f[g].event,k=f[g].ib,m=this.pb?this.pb.length:0,r=m-1;0<=r;r-=1)n=this.pb[r],m=d?d===n.object:!0,p=e?e===n.event:!0,q=c?h[s]===
n.Bb:!0,n=k?k===n.ib:!0,m&&(p&&q&&n)&&(p=this.pb[r].object.rr,p.apply(this.pb[r].object,[this.pb[r].event,this.pb[r].Bb,this.pb[r].context,!0]),this.pb.splice(r,1));return this}};a.H.bind=a.H.on;a.H.unbind=a.H.off;a.H.q={ADD:"add",REMOVE:"remove",RESET:"reset",SORT:"sort",CHANGE:"change",DESTROY:"destroy",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",ALL:"all"};o_("Events.EventType",a.H.q,a);a.H.Wl=function(a,b){var c,f=b||this;for(c in f)"function"===typeof f[c]&&(a[c]=f[c]);a.Cb=
{};a.pb=[]};a.H.Iy=function(a,b,c,f){var h,g,e,k;e=this.yq(a,b);for(k in e)if(e.hasOwnProperty(k))for(a=this.hh(k),b=0;b<a.length;b+=1)h=a[b].event,g=a[b].ib,void 0===this.Cb&&(this.Cb=[]),void 0===this.Cb[h]&&(this.Cb[h]=[]),this.Cb[h].push({Bb:e[k],context:c,ib:g,Sf:!0,fired:!1,Gg:f});return this};a.H.hA=function(a){return a.Sf?a.fired?!1:a.fired=!0:!0};a.H.ub=function(d,b){var c=this.hh(b),f,h,g,e,k,n;e=[];for(f=0;f<c.length;f+=1)h=c[f].event,g=c[f].ib,e.push({event:h,ib:g});for(f=0;f<e.length;f+=
1){k=this.mn(this.Cb,a.H.q.ALL);c=a.H.mn(this.Cb,e[f].event,!1);for(h=0;h<(c?c.length:0);h+=1)c[h].ib===e[f].ib&&c[h].Bb&&(g=Array.prototype.slice.call(arguments),c&&(c[h]&&c[h].Sf)&&this.sz(a.H.mn(this.Cb,e[f].event,!0),c[h]),c&&(c[h]&&this.hA(c[h]))&&(n=c[h].Bb,d&&!c[h].JB||n.apply(c[h].context||this,g.slice(2))));for(h=0;h<(k?k.length:0);h+=1)g=Array.prototype.slice.call(arguments),0<g.length&&(g[1]=e[f].ib?e[f].event+":"+e[f].ib:e[f].event),k&&(k[h]&&k[h].Bb&&this.hA(k[h]))&&(n=k[h].Bb,d&&!k[h].JB||
n.apply(k[h].context||this,g.slice(1))),k&&(k[h]&&k[h].Sf)&&this.sz(this.mn(this.Cb,a.H.q.ALL,!0),k[h])}return this};a.H.sf=function(d,b,c,f,h){var g,e,k,n;d=this.yq(d,b);for(g in d)if(d.hasOwnProperty(g))for(b=this.hh(g),e=0;e<b.length;e+=1)k=b[e].event,n=b[e].ib,void 0===this.Cb&&(this.Cb=[]),void 0===this.Cb[k]&&(this.Cb[k]=[]),n={Bb:d[g],context:c,ib:n,Gg:f,JB:h},-1===this.Np(this.Cb[k],n,a.H.EI)&&this.Cb[k].push(n);return this};a.H.rr=function(a,b,c,f){var h,g;if(null==arguments||0==arguments.length)return this.Cb=
{},this;if(null==a)return this.rz(a,b,c,f),this;h=this.yq(a,b);for(g in h)h.hasOwnProperty(g)&&this.rz(g,h[g],c,f);return this};a.H.yq=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};a.H.rz=function(d,b,c,f){var h=[],g,e,k,n,m,p,q,r;if(d)h=a.H.hh(d);else if(void 0!==this.Cb)for(e in this.Cb)this.Cb.hasOwnProperty(e)&&h.push({event:e});for(d=0;d<h.length;d+=1)if(e=h[d].event,k=h[d].ib,void 0!==this.Cb&&this.Cb[e]instanceof Array){n=this.Cb[e];for(g=n.length-1;0<=g;g-=1)m=void 0===
b||null===b||n[g].Bb==b,p=void 0===c||null===c||n[g].context==c,q=void 0===k||null===k||n[g].ib==k,r=void 0===f||null===f||n[g].Gg==f,m&&(p&&q&&r)&&n.splice(g,1);0===n.length&&delete this.Cb[e]}};a.H.sz=function(a,b){var c,f,h,g,e,k;for(c=a.length-1;0<=c;c-=1)f=void 0===b.Bb||null===b.Bb||a[c].Bb==b.Bb,h=void 0===b.context||null===b.context||a[c].context==b.context,g=void 0===b.ib||null===b.ib||a[c].ib==b.ib,e=void 0===b.Gg||null===b.Gg||a[c].Gg==b.Gg,k=void 0===b.Sf||null===b.Sf||a[c].Sf==b.Sf,f&&
(h&&g&&e&&k)&&a.splice(c,1)};a.H.hh=function(a){a=a?a.split(" "):[];var b=[],c,f,h;for(c=0;c<a.length;c+=1)f=a[c].split(":"),h=f[0],f=1<f.length?f[1]:null,b.push({event:h,ib:f});return b};a.H.EI=function(a,b){return a.Bb===b.Bb&&a.ib===b.ib&&a.context===b.context&&a.Gg===b.Gg&&a.Sf===b.Sf};a.H.qy=function(a,b){return a.event===b.event&&a.ib===b.ib&&a.context===b.context&&a.object===b.object};a.H.Np=function(a,b,c){var f;if(void 0===a)return-1;for(f=0;f<a.length;f+=1)if(c(a[f],b))return f;return-1};
a.H.mn=function(a,b,c){if(a&&a[b]instanceof Array){if(c)return a[b];c=[];var f;for(f=0;f<a[b].length;f++)c.push(a[b][f]);return c}return null};a.i=function(d,b){a.i._init(this,d,b,null)};o_("Model",a.i,a);a.a.aa(a.i,a.a,"Model.Model");a.i.prototype.h=function(){a.i.j.h.call(this)};a.i.prototype.attributes={};a.a.b("Model.prototype.attributes",{attributes:a.i.prototype.attributes});a.i.prototype.Pc={};a.a.b("Model.prototype.defaults",{Pc:a.i.prototype.Pc});a.i.prototype.id=null;a.a.b("Model.prototype.id",
{id:a.i.prototype.id});a.i.prototype.Kd=null;a.a.b("Model.prototype.idAttribute",{Kd:a.i.prototype.Kd});a.i.prototype.xC=null;a.a.b("Model.prototype.urlRoot",{xC:a.i.prototype.xC});a.i.prototype.Ke=null;a.a.b("Model.prototype.customURL",{Ke:a.i.prototype.Ke});a.i.ar=0;a.i._init=function(d,b,c,f){var h=null,g;if(!a.i.yk){d.h();a.H.Wl(d);d.gi();d.Ho={};d.Eo=!1;d.index=-1;c=c||{};d.attributes={};d.defaults&&(d.attributes=a.i.gg(a.i.vc(d.defaults)?d.defaults():d.defaults,null));for(h in f)f.hasOwnProperty(h)&&
(d[h]=f[h]);if(b)if(f=c.parse,a.i.vc(f)&&(d.parse=f),g=a.i.gg(b,d.attributes),g=f?d.parse(g):g,null==g||void 0===g)d.attributes={};else for(h in g)g.hasOwnProperty(h)&&d.Ri(h,g[h],c);d.Yl();d.Aj(c.collection);c.customURL&&(d.customURL=c.customURL);c.url&&(d.url=c.url);c.urlRoot&&(d.urlRoot=c.urlRoot);d.initialize&&d.initialize(b,c);d.af()}};a.i.extend=function(d,b){a.i.yk=!0;var c,f;c=new a.i;a.i.yk=!1;a.H.Wl(c,this.prototype);d=d||{};for(f in d)d.hasOwnProperty(f)&&(c[f]=d[f]);var h;h=d&&d.constructor&&
d.hasOwnProperty("constructor")?d.constructor:function(b,c){a.i._init(this,b,c,d)};h.prototype=c;h.extend=a.i.extend;h.prototype.constructor=h;a.H.Wl(h,this);if(b)for(f in b)b.hasOwnProperty(f)&&(h[f]=b[f]);return h};o_("Model.extend",a.i.extend,a);a.i.prototype.ub=o_a();a.i.prototype.Yl=function(){this.Ye()||(this.cid="id"+a.i.ar,a.i.ar+=1)};a.i.prototype.Ye=o_c("cid");a.i.prototype.To=o_b("index");a.i.prototype.Uo=o_b("next");a.i.prototype.KC=o_c("next");a.i.prototype.Zl=function(a){var b=this.previous;
this.previous=a;return b};a.i.prototype.zt=o_c("previous");a.i.prototype.rn=function(d){return a.i.vc(this[d])?this[d]():this[d]};a.i.prototype.QC=function(d,b){var c,f=!1,h=a.$a.je(b),g;for(c in d.attributes)d.attributes.hasOwnProperty(c)&&(g=this.attributes[c]!=d.attributes[c],h?c===b&&g&&(f=!0):g&&(f=!0),g&&(this.attributes[c]=d.attributes[c],this.qp(c,d.attributes[c])));this.af();return f};a.i.ph=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;return!1};
a.i.prototype.Aj=function(a){null==a?delete this.collection:this.collection=a};a.i.prototype.wj=o_c("collection");a.i.prototype.bn=function(d,b,c,f){null!=d&&this.ub(f,a.H.q.CHANGE+":"+d,this,b,c)};a.i.prototype.cn=function(d,b){var c;this.ub(b,a.H.q.CHANGE,this,d,null);(c=this.wj())&&c.ub(b,a.H.q.CHANGE,this,c,d,null)};a.i.prototype.af=function(){this.id=this.attributes[this.Cq()]};a.i.prototype.Kr=function(d,b){return a.a.Ph(this.attributes[d],b)?!1:(this.attributes[d]=b,this.af(),!0)};a.i.prototype.gi=
function(){this.changed={}};a.i.prototype.qp=function(a,b){this.changed[a]=b};a.i.prototype.Ri=function(d,b,c){if(null==d)return!0;var f={},h,g=this.Eo,e,k;k=a.i.Qm(c);if(2<arguments.length)f[d]=b;else{for(h in d)d.hasOwnProperty(h)&&(f[h]=d[h]);k=b}k=k||{};e=[];if(!this.Nj(f,{validate:k.validate},!1))return!1;g||this.gi();this.Eo||(this.Ho=a.i.gg(this.attributes,null));this.Eo=!0;for(h in f)f.hasOwnProperty(h)&&(this.Kr(h,f[h])?(this.qp(h,f[h]),e.push(h)):delete f[h]);var n=k.silent;for(h in f)f.hasOwnProperty(h)&&
(e.length&&!n&&(this.XB=!0),this.bn(h,f[h],k,n));if(g)return!0;if(!n)for(;this.XB;)this.XB=!1,this.cn(k,n);this.Eo=!1;return!0};a.i.prototype.clear=function(d){var b,c={silent:!0},f;d=d||{};f=d.silent;c.validate=d.validate;this.gi();for(b in this.attributes)if(this.attributes.hasOwnProperty(b)){if(!this.mo(b,c,!0))return!1;this.ub(f,a.H.q.CHANGE+":"+b,this,void 0,null)}this.attributes={};this.af();this.bn(null,null,null,f);this.cn(null,f);return this};a.a.b("Model.prototype.clear",{clear:a.i.prototype.clear});
a.i.gg=function(d,b){var c;b=b||{};for(c in d)d.hasOwnProperty(c)&&("object"!==typeof d[c]?b.hasOwnProperty(c)?void 0!==d[c]&&(b[c]=d[c]):b[c]=d[c]:b[c]=a.i.gg(d[c],null));return b};a.i.prototype.clone=function(){var d=new this.constructor,b;for(b in this)this.hasOwnProperty(b)&&this[b]!==this.attributes&&(d[b]=this[b]);d.attributes=a.i.gg(this.attributes,null);delete d.cid;d.Yl();d.af();return d};a.a.b("Model.prototype.clone",{clone:a.i.prototype.clone});a.i.prototype.yj=function(a,b){var c=this.se();
if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};a.i.prototype.set=function(d,b,c){var f={},h=!1,g,e=!0;if(arguments&&0<arguments.length)if(1<arguments.length&&arguments[arguments.length-1]&&(h=!0,f=arguments[arguments.length-1]||{}),a.i.ph(d))if(f.unset)for(g in d)d.hasOwnProperty(g)&&this.mo(g,null,!1);else this.Ri(d,f)||(e=!1);else for(g=0;g<arguments.length;g+=2)if(void 0!==arguments[g]||g<arguments.length-1||!h&&g===arguments.length-1)f.unset?this.mo(arguments[g],null,!1):
this.Ri(arguments[g],arguments[g+1],f)||(e=!1);return e?this:!1};a.a.b("Model.prototype.set",{set:a.i.prototype.set});a.i.prototype.vC=function(a,b){return this.mo(a,b,!1)};a.a.b("Model.prototype.unset",{vC:a.i.prototype.vC});a.i.prototype.mo=function(a,b,c){b=b||{};var f=b.silent,h={};if(this.has(a)){if(!this.Nj(h,b,!1))return!1;c||this.gi();delete this.attributes[a];this.qp(a,void 0);this.bn(a,null,null,f);this.cn(null,f)}this.af();return!0};a.i.prototype.get=function(a){return this.attributes[a]};
a.a.b("Model.prototype.get",{get:a.i.prototype.get});a.i.prototype.has=function(a){return void 0!==this.attributes[a]&&null!==this.attributes[a]};a.a.b("Model.prototype.has",{has:a.i.prototype.has});a.i.prototype.fetch=function(d){d=d||{};var b=d.success,c=d.error,f=this,h;h=a.i.Qm(d);h.error=function(b,h,e){f.ub(!1,a.H.q.ERROR,f,b,d);c&&c.call(f,arguments)};h.success=function(c){a.i.dn(f,c,h);a.i.vc(this.parse)&&this.set(this.parse(c),h);b&&b.call(f,this,c,d)};a.i.vk("read",this,h)};a.a.b("Model.prototype.fetch",
{fetch:a.i.prototype.fetch});a.i.prototype.parse=function(a){this.attributes=a;this.af();return this.attributes};a.i.prototype.url=function(){var d=this.Ix(),b=this.se();if(d)return b?d+"/"+encodeURIComponent(b):d;if(d=this.collection)return d=a.i.vc(d.url)?d.url():d.url,b&&d?(b="/"==a.i.nH(d)?"":"/",d+b+encodeURIComponent(this.se())):d;throw"No URL defined";};a.a.b("Model.prototype.url",{url:a.i.prototype.url});a.i.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
b.push(a);return b};a.a.b("Model.prototype.keys",{keys:a.i.prototype.keys});a.i.prototype.re=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};a.a.b("Model.prototype.values",{re:a.i.prototype.re});a.i.prototype.Cc=function(){var a,b={};for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(b[a]=this.get(a));return b};a.a.b("Model.prototype.pairs",{Cc:a.i.prototype.Cc});a.i.prototype.WB=function(a){var b=[],c,f,h={};if(a instanceof
Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Cc();for(f in this.attributes)this.attributes.hasOwnProperty(f)&&-1==b.indexOf(f)&&(h[f]=this.get(f));return h};a.a.b("Model.prototype.omit",{WB:a.i.prototype.WB});a.i.prototype.YB=function(a){var b=[],c,f={};if(a instanceof Array)b=a;else if(arguments)for(c=0;c<arguments.length;c++)b.push(arguments[c]);else return this.Cc();for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(f[b[c]]=this.get(b[c]));
return f};a.a.b("Model.prototype.pick",{YB:a.i.prototype.YB});a.i.prototype.MB=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=this.get(a),b[c]=a);return b};a.a.b("Model.prototype.invert",{MB:a.i.prototype.MB});a.i.nH=function(a){return a.charAt(a.length-1)};a.i.prototype.UK=function(){var a=this.Ix();return a?a:this.wj()?this.wj().url:null};a.i.prototype.Ix=function(){return a.i.vc(this.urlRoot)?this.urlRoot():this.urlRoot};a.i.prototype.parseSave=function(a){return a};
a.i.prototype.isValid=function(){var a={};a.validate=this.validate;return this.Nj(this.attributes,a,!1)};a.a.b("Model.prototype.isValid",{isValid:a.i.prototype.isValid});a.i.oJ=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};a.i.prototype.Nj=function(d,b,c){var f=this.validate;return f&&a.i.oJ(b,c)&&(this.validationError=f.call(this,d,b))?(this.ub(!1,a.H.q.INVALID,this,this.validationError,b),!1):!0};a.i.dK=function(d){var b=!1,c={},f,h={};if(d&&0<d.length){1<d.length&&
(d[d.length-1]&&a.i.ph(d[d.length-1]))&&(b=!0,c=d[d.length-1]||{});if(null==d[0])return{attributes:null,options:c};if(a.i.ph(d[0]))for(f in d[0])d[0].hasOwnProperty(f)&&(h[f]=d[0][f]);else for(f=0;f<d.length;f+=2)if(void 0!==d[f]||f<d.length-1||!b&&f===d.length-1)h[d[f]]=d[f+1]}return{attributes:h,options:c}};a.i.Qm=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.i.prototype.save=function(d,b){var c,f,h,g,e,k;c=a.i.dK(arguments);var n,m,p;p=void 0===d?void 0:
c.attributes;n=a.i.Qm(c.options);n.wait||this.set(p);if(!this.Nj(this.attributes,n,!0))return!1;c=void 0===n.forceNew?!1:n.forceNew;g=this;e=n.error;k=n.patch;n.error=function(c,d,f){g.ub(!1,a.H.q.ERROR,g,c,b);e&&e.call(g,arguments)};n.saveAttrs=n.wait?this.aF(p):this.attributes;m=this.attributes;this.attributes=n.saveAttrs;n.saveAttrs=this.toJSON();this.attributes=m;if(!c&&!this.yo())return f=n.success,n.success=function(c){var d;c&&(d=a.i.vc(this.parse)?this.parse(c):c,g.attributes=d,g.af());a.i.dn(g,
c,n);f&&f.call(a.i.qf(n,g),g,c,b);g.gi()},n.attrs=void 0===p?void 0:k?p:n.saveAttrs,a.i.vk(k?"patch":"update",this,n);h=a.i.yx(n);n.success=function(c){var d;if(c){d=a.i.vc(g.parse)?g.parse(c):c;if(!g.Nj(d,n,!0))return;g.attributes=d;g.af()}n.wait&&g.set(p);a.i.dn(g,c,n);h&&h.call(a.i.qf(n,g),g,c,b);g.gi()};n.attrs=n.saveAttrs;n.parse=!0;return a.i.vk("create",this,n)};a.a.b("Model.prototype.save",{save:a.i.prototype.save});a.i.prototype.aF=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&
(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.i.Ul=function(a){return a.constructor===Array};a.i.vc=function(a){return a instanceof Function};a.i.Bt=function(a){return a&&a.hasOwnProperty("value")&&a.hasOwnProperty("comparator")};a.i.prototype.FI=function(d){for(var b in d)if(d.hasOwnProperty(b)){if(!this.attributes.hasOwnProperty(b))return!1;for(var c=a.i.Ul(d[b])?d[b]:[d[b]],f=0;f<c.length;f++)if(a.i.Bt(c[f])){var h=c[f].comparator,g=c[f].value;if(a.$a.je(h))throw Error("String comparator invalid for local where/findWhere");
if(!h(this,b,g))return!1}else if(d[b]!==this.attributes[b])return!1}return!0};a.i.prototype.DC=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.FI(a[b]))return!0;return!1};a.i.yx=function(a){return null!=a&&a.success?a.success:null};a.i.qf=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};a.i.prototype.yo=function(){return void 0==this.se()};a.a.b("Model.prototype.isNew",{yo:a.i.prototype.yo});a.i.prototype.Cq=function(){return this.idAttribute||"id"};
a.i.prototype.se=o_c("id");a.i.prototype.hs=function(d){if(d){var b={},c;for(c in d)d.hasOwnProperty(c)&&(a.a.Ph(d[c],this.attributes[c])||(b[c]=d[c]));return a.a.ob(b)?!1:b}return a.a.ob(this.changed)?!1:this.changed};a.a.b("Model.prototype.changedAttributes",{hs:a.i.prototype.hs});a.i.prototype.Es=function(d){return void 0!==d?a.i.ph(this.changed)&&this.changed.hasOwnProperty(d):a.i.ph(this.changed)};a.a.b("Model.prototype.hasChanged",{Es:a.i.prototype.Es});a.i.prototype.change=function(){for(var a in this.changed)this.changed.hasOwnProperty(a)&&
(this.bn(a,this.get(a),null,!1),this.cn(null,!1))};a.a.b("Model.prototype.change",{change:a.i.prototype.change});a.i.prototype.destroy=function(d){d=d||{};var b=d.wait,c,f=d.error,h=this,g,e;e=a.i.Qm(d);c=a.i.yx(e);e.success=function(f){b&&h.qq();a.i.dn(h,f,e);c&&c.call(a.i.qf(e,h),h,f,d)};e.error=function(b,c,d){h.ub(!1,a.H.q.ERROR,h,b,e);f&&f.call(h,arguments)};if(!this.yo())return g=a.i.vk("delete",this,e),b||this.qq(),g;b||this.qq();c&&c.call(a.i.qf(e,h),h,null,d);return!1};a.a.b("Model.prototype.destroy",
{destroy:a.i.prototype.destroy});a.i.prototype.qq=function(){this.ub(!1,a.H.q.DESTROY,this,this.collection,null)};a.i.dn=function(d,b,c){d.ub(!1,a.H.q.SYNC,d,b,c)};a.i.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};a.a.b("Model.prototype.toJSON",{toJSON:a.i.prototype.toJSON});a.i.prototype.previous=function(a){return this.Ho[a]};a.a.b("Model.prototype.previous",
{previous:a.i.prototype.previous});a.i.prototype.$B=o_c("Ho");a.a.b("Model.prototype.previousAttributes",{$B:a.i.prototype.$B});a.i.prototype.aC=o_c("Ho");a.a.b("Model.prototype.previousChanges",{aC:a.i.prototype.aC});a.i.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.i.vk=function(a,b,c){c=c||{};b.oauth&&(c.oauthHeader=b.oauth.getHeader());!c.dataType&&b.dataType&&(c.dataType=b.dataType);!c.jsonpCallback&&b.jsonpCallback&&(c.jsonpCallback=b.jsonpCallback);if("create"===a||"patch"===
a||"update"===a)c.$s=b.parseSave.call(b,"patch"===a?b.changed:c.saveAttrs);return b.sync(a,b,c)};a.NN=function(d,b,c){c=c||{};var f,h=c.success,g=c.error;f=b.customURL;if("create"===d.valueOf())return f=new a.Xa(b.UK(),f),f.cM(c.$s,g,c,b);if("read"===d.valueOf()){if(b instanceof a.i)return f=new a.Xa(b.url(),f),f.IM(h,g,b.se(),c,a.i.qf(c,b));f=new a.Xa(b.JC(c),f);return f.JM(h,g,c,b)}f=new a.Xa(b.url(),f);var e=null;b instanceof a.i&&(e=b.se());return"update"===d.valueOf()?f.wC(h,e,c.$s,g,c,b,!1):
"patch"===d.valueOf()?f.wC(h,e,c.$s,g,c,b,!0):"delete"===d.valueOf()?f.tM(e,g,c,b):null};o_("sync",a.NN,a);a.ajax=function(){return e.ajax.apply(window.oj,arguments)};a.g=function(d,b){a.g.yk||a.g._init(this,d,b,null)};o_("Collection",a.g,a);a.g.prototype.Vc=null;a.a.b("Collection.prototype.model",{Vc:a.g.prototype.Vc});a.g.prototype.length=0;a.a.b("Collection.prototype.length",{length:a.g.prototype.length});a.g.prototype.VB=[];a.a.b("Collection.prototype.models",{VB:a.g.prototype.VB});a.g.prototype.url=
null;a.a.b("Collection.prototype.url",{url:a.g.prototype.url});a.g.prototype.Ke=o_d(null);a.a.b("Collection.prototype.customURL",{Ke:a.g.prototype.Ke});a.g.prototype.cB=o_d(null);a.a.b("Collection.prototype.customPagingOptions",{cB:a.g.prototype.cB});a.g.prototype.RB=0;a.a.b("Collection.prototype.lastFetchSize",{RB:a.g.prototype.RB});a.g.prototype.hasMore=!1;a.a.b("Collection.prototype.hasMore",{hasMore:a.g.prototype.hasMore});a.g.prototype.Kl=0;a.a.b("Collection.prototype.totalResults",{Kl:a.g.prototype.Kl});
a.g.prototype.QB=0;a.a.b("Collection.prototype.lastFetchCount",{QB:a.g.prototype.QB});a.g.prototype.UB=-1;a.a.b("Collection.prototype.modelLimit",{UB:a.g.prototype.UB});a.g.prototype.offset=0;a.a.b("Collection.prototype.offset",{offset:a.g.prototype.offset});a.g.prototype.iB=-1;a.a.b("Collection.prototype.fetchSize",{iB:a.g.prototype.iB});a.g.prototype.oe=1;a.a.b("Collection.prototype.sortDirection",{oe:a.g.prototype.oe});a.g.prototype.ee=null;a.a.b("Collection.prototype.comparator",{ee:a.g.prototype.ee});
a.g.prototype.Se=!0;a.a.b("Collection.prototype.sortSupported",{Se:a.g.prototype.Se});a.a.aa(a.g,a.a,"Collection.Collection");a.g.prototype.h=function(){a.g.j.h.call(this)};a.g.extend=function(d){a.g.yk=!0;var b=new a.g;a.g.yk=!1;var c;c=d&&d.constructor&&d.hasOwnProperty("constructor")?d.constructor:function(b,c){a.g._init(this,b,c,d)};c.prototype=b;return c.prototype.constructor=c};o_("Collection.extend",a.g.extend,a);a.g._init=function(d,b,c,f){var h,g;d.h();a.H.Wl(d);if(f)for(h in f)f.hasOwnProperty(h)&&
(d[h]=f[h]);c=c||{};g=["url","comparator","model",a.g.kd,"modelLimit","customURL"];for(h=0;h<g.length;h++)c.hasOwnProperty(g[h])&&void 0!==c[g[h]]&&(d[g[h]]=c[g[h]]);void 0===d.bk(null)&&d.jC(-1);void 0===d.modelLimit&&d.ht(-1);d.hasMore=!1;d.ke=0;d.Ch([]);c.parse&&(b=d.parse(b));if(null!=b&&void 0!==b)for(g=b instanceof Array?b:[b],h=0;h<g.length;h+=1)d.add(g[h],c);d.Bh();f&&f.initialize&&f.initialize.call(d,b,c)};a.g.prototype.on=o_a();a.g.prototype.sf=o_a();a.g.prototype.ub=o_a();a.g.prototype.Ch=
o_b("models");a.g.prototype.Lc=o_c("models");a.g.prototype.Sa=function(){return this.Lc().length};a.g.prototype.SJ=function(a){return a<this.Sa()||this.Ea()&&!this.qk()?!1:!0};a.g.prototype.qk=function(){return void 0!==this.totalResults&&null!=this.totalResults};a.g.prototype.mK=function(a){this.mr(a);this.Lc().push(a);this.ke++;a.To(this.Sa()-1)};a.g.prototype.Zy=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.ke--};a.g.prototype.nA=function(a,b,c){for(var f=a;f<a+b;f++)this.zz(this.Lc()[f]);
void 0===c?this.Zy(this.Lc().splice(a,b)):(this.Zy(this.Lc().splice(a,b,c)),this.mr(c));0>this.ke&&(this.ke=0);this.Yy(a)};a.g.prototype.ja=function(a){return this.Lc()[a]};a.g.prototype.Yy=function(a){for(var b=a;b<this.Sa();b++)(a=this.ja(b))&&a.To(b)};a.g.prototype.zz=function(a){if(a){var b=a.zt();a=a.KC();b?b.Uo(a):this.head=a;a?a.Zl(b):this.tail=b}};a.g.prototype.mr=function(a){a.Uo(this.head);this.head?this.head.Zl(a):this.tail=a;a.Zl(null);this.head=a};a.g.prototype.lL=function(a,b){var c=
this.Lc()[a];this.zz(c);c||this.ke++;this.Lc()[a]=b;b.To(a);this.mr(b)};a.g.prototype.BF=function(a){var b=this.tail,c,f,h=0;for(this.tail=null;b&&h<a;)c=b.index,(f=this.Lc()[c])&&f.Es()?(this.tail||(this.tail=b),b=b.zt()):(this.ke--,-1<c&&(this.Lc()[c]=void 0),b.Uo(null),b=b.Zl(null),h++);this.tail||(this.tail=b);0>this.ke&&(this.ke=0);0===this.ke&&(this.tail=this.head=null)};a.g.prototype.Nk=function(){this.ke=0;this.tail=this.head=null};a.g.prototype.vh=function(a){if(this.Ea()){var b=this.vH();
-1<b&&this.ke+a>b&&this.BF(this.ke+a-b)}};a.g.prototype.clone=function(){return this.Pv(!0)};a.a.b("Collection.prototype.clone",{clone:a.g.prototype.clone});a.g.prototype.Pv=function(a){var b=new this.constructor,c;this.Ea()&&(b=this.HF(b),b.Ez());if(a)for(a=0;a<this.nc();a+=1)(c=this.Gm(a,null,!0,!1))&&b.dg(c.clone(),{at:a},!0,!1);return b};a.g.prototype.HF=function(d){var b=["totalResults","hasMore",a.g.kd],c,f;for(f=0;f<b.length;f++)c=b[f],d[c]=this[c];return d};a.g.prototype.nc=o_c("length");
a.g.prototype.Bh=function(){var a=this.Sa();this.length=a;this.Ea()||(this.totalResults=a)};a.g.prototype.Gk=function(d,b){var c=null,f,c=d instanceof a.i?d:this.model?a.i.vc(this.model)?new this.model(d,b):new this.model.constructor(d,b):new a.i(d,b);b=b||{};return b.validate&&c.validate&&(f=c.validate(c.attributes))?(b.validationError=f,this.ub(!1,a.H.q.INVALID,this,f,b),null):c};a.g.prototype.add=function(a,b){this.vh(1);return this.dg(a,b,!1,(b||{}).deferred)};a.a.b("Collection.prototype.add",
{add:a.g.prototype.add});a.g.prototype.dg=function(d,b,c,f){function h(f,d,h,g,e){var l;q&&h?s=h.QC(d,f.comparator):(l=f.ix(g),void 0===l&&(void 0===k?(f.mK(g),m=f.Sa()-1,f.ja(m).Yl()):(m=k,f.Ea()&&c?f.lL(m,g):f.nA(m,0,g),f.ja(m).Yl(),k+=1),void 0===g.wj()&&g.Aj(f),f.Bh(),f.tJ(g),t=!0));c&&(b=b||{},b.fillIn=!0);s&&(void 0===l&&!r&&void 0===k&&1<f.nc())&&(-1<m&&(p=f.ja(m).cid),f.sort(b),-1<m&&(m=f.indexOf(f.Lh(p),e)));t&&(g?g.ub(n,a.H.q.ADD,g,f,b):h.ub(n,a.H.q.ADD,h,f,b))}function g(f,d,g){var e=f.Gk(d,
b),l=null,p=null;if(null!=e){m=-1;e.af();l=d instanceof a.i?d:e;if(g)return f.ih(l,null,g,!0).done(function(a){p=a.m;return h(f,l,p,e,g)});p=c?f.ix(l):f.get(l);h(f,l,p,e,g)}}b=b||{};var l=[],k=b.at,n=b.silent,m,p,q=b.merge||!1,r=b.sort,s=!0,t=!1;d instanceof Array?l=d:l.push(d);if(!c&&(this.Ea()||f)){var v=this,u=function(a){var b=e.Deferred();g(v,l[a],!0).done(function(){b.resolve(a)});return b.promise()};f=u(0);var A=function(a){return u(a+1)};for(d=1;d<l.length;d++)f=f.then(A);return e.when(f).promise()}for(d=
0;d<l.length;d++)g(this,l[d],!1)};a.g.prototype.Cn=function(){var a=this.comparator;return void 0!==a&&null!==a};a.g.prototype.sort=function(d){d=d||{};d=d.silent;var b=this.comparator,c;this.Cn()&&(this.Ea()&&this.GI()?(d=this.totalResults,void 0!==d?this.Ch(Array(d)):(this.Ch([]),this.Nk(),this.Bh())):(c=this,this.Lc().sort(function(f,d){return a.g.Wo(f,d,b,c,c)}),this.Yy(0),this.ub(d,a.H.q.SORT,this,null,null)))};a.a.b("Collection.prototype.sort",{sort:a.g.prototype.sort});a.g.ek=function(d,b){return d instanceof
a.i?d.get(b):a.i.vc(d[b])?d[b]():d[b]};a.g.Wo=function(d,b,c,f,h){var g,e,k;if(a.i.vc(c)){if(1===c.length){g=c.call(h,d);e=c.call(h,b);g=a.$a.je(g)?g.split(","):[g];var n=a.$a.je(e)?e.split(","):[e];for(k=0;k<g.length;k++)if(e=a.g.Zg(g[k],n[k],f.sortDirection),0!==e)return e}return c.call(h,d,b)}if(a.$a.je(c))for(c=c.split(","),k=0;k<c.length;k++)if(g=a.g.ek(d,c[k]),e=a.g.ek(b,c[k]),e=a.g.Zg(g,e,f.sortDirection),0!==e)return e;return 0};a.g.prototype.mC=function(d){var b=this.comparator;if(!this.Cn())return-1;
this.Ed("sortedIndex");return a.g.NG(this.Lc(),d,b)};a.a.b("Collection.prototype.sortedIndex",{mC:a.g.prototype.mC});a.g.NG=function(a,b,c){function f(h,g){var e,k;if(h>g)return-1;e=b.Ye();k=b.se();if(a[h].yj(k,e))return h;if(a[g].yj(k,e))return g;e=Math.floor((g+h)/2);return-1===c(a[e],b)?f(h+1,e):1===c(a[e],b)?f(e,g-1):e}return f(0,a.length-1)};a.g.Zg=function(a,b,c){if(-1===c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};a.g.prototype.unshift=function(d,b){var c=
{};a.ac.Jf(c,b||{});c.at||(c.at=0);this.vh(1);return this.dg(d,c,!1,c.deferred)};a.a.b("Collection.prototype.unshift",{unshift:a.g.prototype.unshift});a.g.prototype.shift=function(a){var b=this.ad(a);if(this.Ea()||b){var c=this;return this.at(0,a).then(function(b){return c.Ah(b,0,a)})}return this.Ah(this.at(0),0,a)};a.a.b("Collection.prototype.shift",{shift:a.g.prototype.shift});a.g.prototype.KB=function(a){void 0===a&&(a=1);var b=[],c;for(c=0;c<this.nc()-a;c+=1)b.push(this.at(c));return b};a.a.b("Collection.prototype.initial",
{KB:a.g.prototype.KB});a.g.prototype.ad=function(a){return(a||{}).deferred};a.g.prototype.last=function(a,b){var c=this.ad(b);void 0===a&&(a=1);if(1===a){var f=this.Sa();0===f&&(f=a);return 0<f?this.at(f-1,c):null}var h=[],f=this.nc();if(c||this.Ea())return h=f-a,0>h&&(h=0),0===f&&(f=a),this.Ln(h,f);for(c=f-a;c<f;c+=1)h.push(this.at(c));return h};a.a.b("Collection.prototype.last",{last:a.g.prototype.last});a.g.prototype.Ln=function(a,b){function c(a){return f(a+1)}function f(a){var b=e.Deferred();
l.$p(a,null).done(function(c){h.push(c);b.resolve(a)});return b.promise()}var h=[],g,l=this,k=f(a);for(g=a+1;g<b;g++)k=k.then(c);return e.when(k).then(function(){return h})};a.g.prototype.Yw=function(d){return void 0===d||null===d?this[a.g.kd]:d};a.g.prototype.sF=function(){var d=this.lastFetchCount;if(void 0===d||null===d)d=this[a.g.kd];return void 0===this.offset||null===this.offset?d:this.offset+d};a.g.prototype.next=function(d,b){b=b||{};b[a.g.kd]=this.Yw(d);var c=this.sF(),f=this.nc();if(0===
f&&0<b[a.g.kd])c=0;else if(c>=f)return b.success&&b.success.call(a.i.qf(b,this),this,null,b),null;b.startIndex=c;return this.fetch(b)};a.a.b("Collection.prototype.next",{next:a.g.prototype.next});a.g.prototype.tF=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};a.g.prototype.previous=function(d,b){b=b||{};if(0===this.offset)return b.success&&this.lastFetchCount&&b.success.call(a.i.qf(b,this),this,null,b),null;b[a.g.kd]=this.Yw(d);var c=this.tF(b[a.g.kd]);0>c&&(b[a.g.kd]=
this.offset,c=0);b.startIndex=c;return this.fetch(b)};a.a.b("Collection.prototype.previous",{previous:a.g.prototype.previous});a.g.prototype.ht=function(a){this.modelLimit=a;this.vh(0)};a.a.b("Collection.prototype.setModelLimit",{ht:a.g.prototype.ht});a.g.prototype.vH=o_c("modelLimit");a.g.prototype.jC=function(d){this[a.g.kd]=d};a.g.prototype.eC=function(a,b){var c=this.ad(b);void 0===a&&(a=1);var f=[];if(this.Ea()||c)return this.Ln(a,this.nc());for(c=a;c<this.nc();c+=1)f.push(this.at(c));return f};
a.a.b("Collection.prototype.rest",{eC:a.g.prototype.eC});a.g.prototype.remove=function(a,b){b=b||{};var c=[],f;a instanceof Array?c=a:c.push(a);for(f=c.length-1;0<=f;f-=1)this.Ah(c[f],-1,b)};a.a.b("Collection.prototype.remove",{remove:a.g.prototype.remove});a.g.prototype.Ah=function(d,b,c){c=c||{};d=-1==b?this.ih(d):a.g.kh(b,d);var f=c.silent;b=d.index;if(-1<b){var h=d.m;void 0!==h&&h.wj()===this&&h.Aj(null);this.nA(b,1);this.Bh();var g={};a.ac.Jf(g,c);g.index=b;void 0!==h&&h.ub(f,a.H.q.REMOVE,h,
this,g);this.EA(h)}return d.m};a.g.prototype.EA=function(a){void 0!==a&&a.off(null,null,this)};a.g.prototype.tJ=function(d){d.sf(a.H.q.ALL,this.HJ,this,!1,!0)};a.g.prototype.HJ=function(d,b,c,f){d===a.H.q.DESTROY&&this.remove(b);if(void 0===c||c===this)Array.prototype.slice.call(arguments),this.ub(f&&f.silent,d,b,c,f)};a.g.prototype.reset=function(d,b){var c;b=b||{};b.previousModels=this.Lc();if(void 0===d||null==d||d instanceof Array&&0==d.length){for(c=0;c<this.Sa();c+=1)this.ja(c)&&this.ja(c).Aj(null);
this.Ch([]);this.Nk()}else if(this.Ch([]),this.Nk(),b.parse&&(d=this.parse(d)),d instanceof Array)for(this.vh(d.length),c=0;c<d.length;c+=1)this.dg(d[c],b,!0,!1);else this.vh(1),this.dg(d,b,!0,!1);this.Bh();this.ub(void 0!==b.silent&&b.silent,a.H.q.RESET,this,b,null)};a.a.b("Collection.prototype.reset",{reset:a.g.prototype.reset});a.g.prototype.at=function(a,b){return this.Gm(a,b,!1,this.ad(b))};a.a.b("Collection.prototype.at",{at:a.g.prototype.at});a.g.prototype.Gm=function(a,b,c,f){return 0>a||
this.SJ(a)?null:c||!this.Ea()&&!f?this.ja(a):this.$p(a,b).promise()};a.g.prototype.$p=function(d,b){function c(){h.resolve(f.ja(d))}var f=this,h=e.Deferred(),g=this.ja(d);return void 0===g?(g={},a.ac.Jf(g,b||{}),g.context=this,g.startIndex=d,this.an(g,!1).then(c),h):e.Deferred().resolve(g)};a.g.prototype.Lh=function(a){var b,c;for(b=0;b<this.Sa();b+=1)if(c=this.ja(b),void 0!==c&&a===c.cid)return c;if(this.Ea())throw Error("Not found locally and not supported by server for virtual collections");return null};
a.a.b("Collection.prototype.getByCid",{Lh:a.g.prototype.Lh});a.g.prototype.get=function(a,b){var c=this.ih(a,b,this.ad(b));if(c){if(e.isFunction(c.promise))return c.then(function(a){return a.m});if(c.hasOwnProperty("m"))return c.m}return null};a.a.b("Collection.prototype.get",{get:a.g.prototype.get});a.g.prototype.ix=function(a){return(a=this.jx(a))?a.m:null};a.g.prototype.jx=function(d){var b,c=d,f=this.Sa(),h;d instanceof a.i?(c=d.Ye(),d=d.se()):void 0!==d&&(null!=d&&void 0!==d.id)&&(d=d.id);for(b=
0;b<f;b+=1)if(h=this.ja(b),void 0!==h&&h.yj(d,c))return a.g.kh(b,h);return a.g.kh(-1,void 0)};a.g.prototype.ih=function(d,b,c,f){var h,g=d;void 0===f&&(f=!1);d instanceof a.i?(g=d.Ye(),d=d.se()):void 0!==d&&(null!=d&&void 0!==d.id)&&(d=d.id);var l;for(h=0;h<this.Sa();h+=1)if(l=this.ja(h),void 0!==l&&l.yj(d,g))return d=a.g.kh(h,l),c?e.Deferred().resolve(d):d;if(this.Ea()){if(void 0===d&&void 0!==g)throw Error("cid not supported on virtual get by ID: only id supported");var k=e.Deferred(),n=this;c=
{};a.ac.Jf(c,b||{});c.context=this;c.startID=d;this.an(c,f).then(function(b){null!=b?(b=n.lx(),k.resolve(a.g.kh(b,n.ja(b)))):k.resolve(a.g.kh(-1,void 0))});return k}d=a.g.kh(-1,void 0);return c?e.Deferred().resolve(d):d};a.g.kh=function(a,b){return{index:a,m:b}};a.g.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};a.g.prototype.Ko=function(a,b){var c=e.Deferred();if(this.Ks(a,b))return e.Deferred().resolve();
var f=this.kx(a,b);!this.qk()&&f<a+b&&(f=a+b);this.an(this.Ea()?{context:this,startIndex:a,fetchSize:f-a}:{context:this},!1).then(function(){c.resolve()});return c};a.a.b("Collection.prototype.setRangeLocal",{Ko:a.g.prototype.Ko});a.g.prototype.kx=function(a,b){var c=this.Sa();return a+b>c?c:a+b};a.g.prototype.Ks=function(a,b){if(!this.Ea())return 0<this.Sa();var c=this.kx(a,b);if(!this.qk()&&c<a+b)return!1;for(var f=a;f<c;f++)if(void 0===this.ja(f))return!1;return!0};a.a.b("Collection.prototype.isRangeLocal",
{Ks:a.g.prototype.Ks});a.g.prototype.fetch=function(a){return this.an(a,!1)};a.a.b("Collection.prototype.fetch",{fetch:a.g.prototype.fetch});a.g.prototype.an=function(d,b){var c=d||{},f=c.success,h,g;void 0===c.parse&&(c.parse=!0);g=this;c.success=function(e){var k,n;g.mL(e,d);k=g.parse(e,d);var m=null;if(c.add||g.model){if(g.Ea()?b||g.Ez():c.add||g.reset(),n=a.g.$v(g),k){var m=k instanceof Array?k:[k],p={},q=g.lx();g.vh(m.length);for(k=0;k<m.length;k+=1)h=n&&c.parse?n.parse(m[k]):m[k],g.Ea()&&(p=
{at:q+k}),p.silent=!0,g.dg(h,p,!0,!1)}}else m=k instanceof Array?k:[k],b||g.reset(k);g.Ea()&&m&&(g.lastFetchCount=m.length);g.ub(!1,a.H.q.SYNC,g,e,c);f&&f.call(a.i.qf(d,g),g,e,c)};return this.Fw(c)};a.g.prototype.KG=function(d){var b=d||{},c=b.success,f,h;void 0===b.parse&&(b.parse=!0);h=this;b.success=function(g){var e,k;e=h.parse(g,d);var n=null,m=[];if(b.add||h.model)if(k=a.g.$v(h),e)for(n=e instanceof Array?e:[e],e=0;e<n.length;e+=1)f=k&&b.parse?k.parse(n[e]):n[e],m.push(h.Gk(f));h.ub(!1,a.H.q.SYNC,
h,g,b);c&&c.call(a.i.qf(d,h),h,m,b)};this.Fw(b)};a.g.$v=function(d){if(d.model)return a.i.vc(d.model)?new d.model:new d.model.constructor};a.g.prototype.Fw=function(d){try{return a.i.vk("read",this,d)}catch(b){throw this.ub(!1,a.H.q.ERROR,this,null,d),b;}};a.g.prototype.Ez=function(){var a=this.totalResults;void 0!==a&&this.Sa()!==a&&(this.Ch(Array(a)),this.Nk())};a.g.prototype.bk=function(d){d=d||{};return d[a.g.kd]||this[a.g.kd]};a.g.prototype.GI=function(){return void 0!==this.hasMore&&this.hasMore};
a.g.prototype.Ea=function(){return-1<this.bk(null)};a.g.prototype.tn=function(d,b,c,f,h){d=parseInt(a.g.rn(d,b,c),10);return void 0===d||null===d||isNaN(d)?f?f:h:d};a.g.prototype.mL=function(d,b){var c={};this.customPagingOptions&&((c=this.customPagingOptions.call(this,d))||(c={}));b=b||{};this.lastFetchSize=this.tn(c,d,"limit",b.fetchSize,this.fetchSize);this.offset=this.tn(c,d,"offset",b.startIndex,0);this.lastFetchCount=this.tn(c,d,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=
this.tn(c,d,"totalResults",this.totalResults,this.totalResults);this.hasMore=this.jH(a.g.rn(c,d,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);!this.Ea()&&this.lastFetchSize&&this.jC(this.lastFetchSize)};a.g.prototype.jH=function(a,b,c,f){return a&&void 0!==a?a:b+c>f?!1:!0};a.g.rn=function(a,b,c){return a[c]?a[c]:b?b[c]:void 0};a.g.prototype.lx=function(){return void 0!==this.offset?this.offset:0};a.g.prototype.create=function(d,b){function c(c,f,h,g){return!1===f.save(d instanceof a.i?
null:d,g)&&(b.validationError=f.validationError,c.ub(!1,a.H.q.INVALID,c,f.validationError,g),h)?(c.EA(f),c.remove(f),!1):f}var f=this.ad(b);b=b||{};var h=this.Gk(d,b),g=b.success,l=b.context,k=b.validate;b.context=this;b.success=function(a,b,c){g&&g.call(null!=l?l:this,a,b,c)};if(null==h)return!1;b.forceNew=null!=h.se();h.Aj(this);var n=this;if(f||this.Ea()){var m=e.Deferred();this.add(h,{merge:!0,deferred:!0}).done(function(){b.success=function(a,b,c){g&&g.call(null!=l?l:this,a,b,c);m.resolve(a)};
var a=c(n,h,k,b);a||m.resolve(a)});return m.promise()}this.add(h,{merge:!0});return c(this,h,k,b)};a.a.b("Collection.prototype.create",{create:a.g.prototype.create});a.g.prototype.ZB=function(a){var b=[],c;this.Ed("pluck");for(c=0;c<this.nc();c+=1)b.push(this.at(c).get(a));return b};a.a.b("Collection.prototype.pluck",{ZB:a.g.prototype.ZB});a.g.prototype.sj=function(a,b){b=b||{};var c=this.ad(b);if(this.Ea()){var f=e.Deferred();this.KG({query:a,all:!0,success:function(a,b){f.resolve(b)}});return f.promise()}var h=
[],g,l;for(g=0;g<this.nc();g+=1)l=this.at(g),l.DC(a)&&h.push(l);return c?e.Deferred().resolve(h):h};a.a.b("Collection.prototype.where",{sj:a.g.prototype.sj});a.g.prototype.yC=function(d,b){b=b||{};var c=this.ad(b),f=this;if(this.Ea()||c){var h=e.Deferred();this.sj(d,b).done(function(a){a=f.xy(a);h.resolve(a)});return h.promise()}c=this.sj(d,b);c=this.xy(c);c[a.g.kd]=-1;c.Bh();return c};a.a.b("Collection.prototype.whereToCollection",{yC:a.g.prototype.yC});a.g.prototype.xy=function(a){var b=this.Pv(!1);
b.Ch(a);b.Nk();b.Bh();return b};a.g.prototype.Ed=function(a){if(this.Ea())throw Error(a+" not valid on a virtual Collection");};a.g.prototype.map=function(a,b){var c=[],f,h;this.Ed("map");for(h=0;h<this.Sa();h+=1)f=a.call(b||this,this.ja(h)),c.push(f);return c};a.a.b("Collection.prototype.map",{map:a.g.prototype.map});a.g.prototype.each=function(a,b){this.Ed("each");this.Lc().forEach(a,b)};a.a.b("Collection.prototype.each",{each:a.g.prototype.each});a.g.prototype.size=function(){return this.nc()};
a.a.b("Collection.prototype.size",{size:a.g.prototype.size});a.g.prototype.lC=function(d,b){var c,f=[],h;this.Ed("sortBy");for(c=0;c<this.Sa();c+=1)f.push(this.ja(c));h=this;f.sort(function(c,f){var e,n;if(a.i.vc(d))return e=d.call(b||h,c),n=d.call(b||h,f),a.g.Zg(e,n,h.sortDirection);e=c.get(d);n=f.get(d);return a.g.Zg(e,n,h.sortDirection)});return f};a.a.b("Collection.prototype.sortBy",{lC:a.g.prototype.lC});a.g.prototype.FB=function(d,b){var c,f={},h;this.Ed("groupBy");for(c=0;c<this.Sa();c+=1)h=
a.i.vc(d)?d.call(b||this,this.ja(c)):this.ja(c).get(d),void 0===f[h]&&(f[h]=[]),f[h].push(this.ja(c));return f};a.a.b("Collection.prototype.groupBy",{FB:a.g.prototype.FB});a.g.prototype.min=function(a,b){var c,f={},h,g;this.Ed("min");if(0==this.Sa())return null;f=this.ja(0);h=a.call(b||this,this.ja(0));for(c=1;c<this.Sa();c+=1)g=a.call(b||this,this.ja(c)),g<h&&(f=this.ja(c),h=g);return f};a.a.b("Collection.prototype.min",{min:a.g.prototype.min});a.g.prototype.max=function(a,b){var c,f={},h,g;this.Ed("max");
if(0==this.Sa())return null;f=this.ja(0);h=a.call(b,this.ja(0));for(c=1;c<this.Sa();c+=1)g=a.call(b||this,this.ja(c)),g>h&&(f=this.ja(c),h=g);return f};a.a.b("Collection.prototype.max",{max:a.g.prototype.max});a.g.prototype.filter=function(a,b){var c,f=[];this.Ed("filter");for(c=0;c<this.Sa();c+=1)a.call(b||this,this.ja(c))&&f.push(this.ja(c));return f};a.a.b("Collection.prototype.filter",{filter:a.g.prototype.filter});a.g.prototype.zC=function(a){var b=[],c,f,h;this.Ed("without");if(arguments){for(c=
0;c<this.Sa();c+=1){h=!0;for(f=0;f<arguments.length;f+=1)if(this.ja(c).yj(arguments[f].se(),arguments[f].Ye())){h=!1;break}h&&b.push(this.ja(c))}return b}return this.Lc()};a.a.b("Collection.prototype.without",{zC:a.g.prototype.zC});a.g.prototype.ob=function(){return 0===this.nc()};a.a.b("Collection.prototype.isEmpty",{ob:a.g.prototype.ob});a.g.prototype.RA=function(a,b){var c;this.Ed("any");for(c=0;c<this.Sa();c+=1)if(a.call(b||this,this.ja(c)))return!0;return!1};a.a.b("Collection.prototype.any",
{RA:a.g.prototype.RA});a.g.prototype.jB=function(a,b){var c=this.ad(b);if(this.Ea()||c){var f=e.Deferred();this.sj(a,b).done(function(a){a&&0<a.length&&f.resolve(a[0]);f.resolve(null)});return f.promise()}c=this.sj(a);return 0<c.length?c[0]:null};a.a.b("Collection.prototype.findWhere",{jB:a.g.prototype.jB});a.g.prototype.slice=function(a,b,c){var f=this.ad(c);c=[];if(void 0===b){if(this.Ea&&!this.qk())throw Error("End must be set for virtual collections with no totalResults");b=this.Sa()}if(f||this.Ea())return this.Ln(a,
b);for(;a<b;a+=1)c.push(this.ja(a));return c};a.a.b("Collection.prototype.slice",{slice:a.g.prototype.slice});a.g.prototype.set=function(a,b){return this.eL(a,b,this.ad(b))};a.a.b("Collection.prototype.set",{set:a.g.prototype.set});a.g.pz=function(a,b,c,f){if(b)for(b=a.Sa()-1;0<=b;b-=1)-1==c.indexOf(b)&&a.Ah(a.ja(b),b,f)};a.g.prototype.eL=function(d,b,c){b=b||{};var f=void 0===b.add?!0:b.add,h=void 0===b.remove?!0:b.remove,g=void 0===b.merge?!0:b.merge,e=[],k=null,n;b.parse&&(d=this.parse(d));n=a.i.Ul(d)?
d:[d];if(this.Ea()||c)return this.tG(n,b,h,f,g);for(d=0;d<n.length;d+=1)k=this.JA(this.Gk(n[d],b),f,g,c),-1!==k&&e.push(k);a.g.pz(this,h,e,b)};a.g.prototype.tG=function(d,b,c,f,h){function g(a){return l(a+1)}function l(a){var c=e.Deferred();m.JA(m.Gk(d[a],b),f,h,!0).done(function(b){-1!==b&&k.push(b);c.resolve(a)});return c.promise()}var k=[],n,m=this,p=l(0);for(n=1;n<d.length;n+=1)p=p.then(g);return e.when(p).then(function(){a.g.pz(m,c,k,b)})};a.g.prototype.JA=function(a,b,c,f){function h(f,h,g){var l=
h?h.index:-1;if(h&&h.m){if(c){h={merge:c};if(g){var q=e.Deferred();f.dg(a,h,!1,!0).done(function(){q.resolve(l)});return q.promise()}f.add(a,h)}}else if(b){if(g)return q=e.Deferred(),f.add(a,{deferred:!0}).done(function(){q.resolve(f.nc()-1)}),q.promise();f.add(a);l=f.nc()-1}return l}if(f||this.Ea()){var g=this,l=e.Deferred();this.ih(a,null,f).done(function(a){h(g,a,!0).done(function(a){l.resolve(a)})});return l.promise()}f=this.ih(a);return h(this,f,!1)};a.g.prototype.toJSON=function(){var a=[],
b;this.Ed("toJSON");for(b=0;b<this.Sa();b+=1)a.push(this.ja(b).toJSON());return a};a.a.b("Collection.prototype.toJSON",{toJSON:a.g.prototype.toJSON});a.g.prototype.first=function(a,b){var c=this.ad(b),f=this.nc(),h=[];a?f=a:a=1;c=this.Ea()||c;if(1===a)return c?this.$p(0,null).promise():0<this.Sa()?this.ja(0):null;f>this.Sa()&&(!this.Ea()||this.qk())&&(f=this.Sa());if(c)return this.Ln(0,f);for(c=0;c<f;c+=1)h.push(this.ja(c));return h};a.a.b("Collection.prototype.first",{first:a.g.prototype.first});
a.g.prototype.indexOf=function(a,b){var c=this.ad(b);return this.Ea()||c?this.ih(a,null,!0).then(function(a){return a.index}):this.ih(a).index};a.a.b("Collection.prototype.indexOf",{indexOf:a.g.prototype.indexOf});a.g.prototype.CJ=function(a){a=this.jx(a);return void 0!==a?a.index:-1};a.g.prototype.pop=function(a){var b=this.ad(a);if(this.Ea()||b){var c=this;return this.at(this.nc()-1,{deferred:b}).then(function(b){c.remove(b,a);return b})}b=this.at(this.nc()-1);this.remove(b,a);return b};a.a.b("Collection.prototype.pop",
{pop:a.g.prototype.pop});a.g.prototype.push=function(a,b){var c=this.ad(b);this.vh(1);return this.dg(a,b,!1,c)};a.a.b("Collection.prototype.push",{push:a.g.prototype.push});a.g.prototype.lastIndexOf=function(d,b){var c;this.Ed("lastIndexOf");void 0===b&&(b=0);for(c=this.nc()-1;c>=b;c-=1)if(a.a.Ph(d,this.at(c)))return c;return-1};a.a.b("Collection.prototype.lastIndexOf",{lastIndexOf:a.g.prototype.lastIndexOf});a.g.prototype.Kq=function(a){return void 0===a?[]:a.split(",")};a.g.FH=function(d){d=a.i.Ul(d)?
d:[d];var b="",c,f,h,g;for(h=0;h<d.length;h++){c=d[h];for(g in c)if(c.hasOwnProperty(g))for(var e=a.i.Ul(c[g])?c[g]:[c[g]],k=0;k<e.length;k++){if(a.i.Bt(e[k])){f=e[k].value;var n=null,n=e[k].comparator,n=a.i.vc(n)?n(null,g,f):n;f=g+n+f}else f=g+"\x3d"+c[g];b+=f+"+"}b=b.substring(0,b.length-1)+","}return","===b.substring(b.length-1)?b.substring(0,b.length-1):b};a.g.prototype.UC=function(d){var b={},c;for(c in d)d.hasOwnProperty(c)&&(b[c]=d[c]);if(d=this.comparator){d=this.Kq(d);for(c=0;c<d.length;c++)b.sort=
0===c?d[c]:b.sort+(","+d[c]);b.sortDir=this.Lq()}this.Ea()&&(b[a.g.kd]=this.bk(null));return b};a.g.prototype.JC=function(d){var b=a.i.vc(this.url)?this.url():this.url;if(this.Ea()){var c=d.all,f=null;f=c?(f=this.totalResults)?f:this.bk(d):this.bk(d);b+="?limit\x3d"+f;c||(d.startIndex&&(b+="\x26offset\x3d"+d.startIndex),d.startID&&(b+="\x26fromID\x3d"+d.startID),d.since&&(b+="\x26since\x3d"+d.since),d.until&&(b+="\x26until\x3d"+d.until));d.query&&(d=a.g.FH(d.query))&&0<d.length&&(b+="\x26q\x3d"+d);
if(d=this.comparator)for(d=this.Kq(d),c=this.Lq(),f=0;f<d.length;f++)b=0===f?b+("\x26orderBy\x3d"+d[f]+":"+c):b+(","+d[f]+":"+c);b+="\x26totalResults\x3dtrue"}return b};a.g.prototype.Lq=function(){return-1===this.sortDirection?"dsc":"asc"};a.g.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.g.kd="fetchSize";a.Xa=function(a,b){this.Gl=a;this.Ke=b;jQuery.support.cors=!0};a.Xa.$h="headers";a.Xa.Yk=function(d,b,c){var f;d=e.extend(!0,d,c);for(f in b)b.hasOwnProperty(f)&&"oauthHeader"!==
f&&(d.hasOwnProperty(f)||(d[f]=b[f]),f===a.Xa.$h&&(d[f]=e.extend(!0,d[f],b[f])));if(b.oauthHeader)for(f in d[a.Xa.$h]||(d[a.Xa.$h]={}),b.oauthHeader)b.oauthHeader.hasOwnProperty(f)&&(d[a.Xa.$h].hasOwnProperty(f)||(d[a.Xa.$h][f]=b.oauthHeader[f]));return d};a.Xa.prototype.JM=function(d,b,c,f){c=c||{};var h="jsonp"===c.dataType,g=this.ok("read",this.Gl,this.Ke,null,f,c);d={crossDomain:c.crossDomain||!h,dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,context:null!==f?f:this,success:d,error:b};
d=this.Cm(d);d=a.Xa.Yk(d,c,g);c.xhr=this.ajax(d);return c.xhr};a.Xa.prototype.Cm=function(d){d[a.Xa.$h]={"Accept-Language":this.ud()};return d};a.Xa.prototype.IM=function(d,b,c,f,h){f=f||{};var g="jsonp"===f.dataType;c=this.ok("read",this.Gl,this.Ke,c,h,f);d={crossDomain:f.crossDomain||!g,dataType:f.dataType||"json",jsonpCallback:f.jsonpCallback,context:null!==h?h:this,success:d,error:b};d=this.Cm(d);d=a.Xa.Yk(d,f,c);f.xhr=this.ajax(d);return f.xhr};a.Xa.prototype.wC=function(d,b,c,f,h,g,e){h=h||
{};var k="jsonp"===h.dataType;b=this.ok(e?"patch":"update",this.Gl,this.Ke,b,g,h);d={crossDomain:h.crossDomain||!k,contentType:h.contentType||"application/json",dataType:h.dataType||"json",jsonpCallback:h.jsonpCallback,data:JSON.stringify(c),success:d,error:f,context:null!==g?g:this};d=this.Cm(d);d=a.Xa.Yk(d,h,b);h.xhr=this.ajax(d);return h.xhr};a.Xa.prototype.zq=function(a,b){return b.type?b.type:"create"===a?"POST":"delete"===a?"DELETE":"patch"===a?"PATCH":"update"===a?"PUT":"GET"};a.Xa.prototype.$K=
function(d,b,c){b=b instanceof a.g?b.UC(c):{};d&&(b.recordID=d);return b};a.Xa.prototype.ok=function(d,b,c,f,h,g){if(a.i.vc(c)){c=c.call(this,d,h,this.$K(f,h,g));if(a.$a.je(c))return{url:c,type:this.zq(d,g)};if(c)return c.url=c.hasOwnProperty("url")?c.url:b,c.type=c.hasOwnProperty("type")?c.type:this.zq(d,g),c}return{url:b,type:this.zq(d,g)}};a.Xa.prototype.tM=function(d,b,c,f){c=c||{};var h="jsonp"===c.dataType;d=this.ok("delete",this.Gl,this.Ke,d,f,c);b={crossDomain:c.crossDomain||!h,success:c.success,
error:b,context:null!==f?f:this};b=a.Xa.Yk(b,c,d);c.xhr=this.ajax(b);return c.xhr};a.Xa.prototype.cM=function(d,b,c,f){c=c||{};var h=JSON.stringify(d),g="jsonp"===c.dataType;d=this.ok("create",this.Gl,this.Ke,null,f,c);b={crossDomain:c.crossDomain||!g,contentType:c.contentType||"application/json",dataType:c.dataType||"json",jsonpCallback:c.jsonpCallback,data:h,success:c.success,error:b,context:null!==f?f:this};b=this.Cm(b);b=a.Xa.Yk(b,c,d);c.xhr=this.ajax(b);return c.xhr};a.Xa.prototype.ud=function(){return a.Ka.ud()};
a.Xa.prototype.ajax=function(a){return window.oj.ajax(a)};a.Ba=function(d,b){b=b||{};a.Ba._init(this,b,d||"Authorization")};o_("OAuth",a.Ba,a);a.a.aa(a.Ba,a.a,"OAuth.OAuth");a.Ba.prototype.h=function(){a.Ba.j.h.call(this)};a.Ba.prototype.getHeader=function(){var a={};this.Bg.access_token||this.ls();a[this.hf.XA]="Bearer "+this.Bg.access_token;return a};a.a.b("OAuth.prototype.getHeader",{getHeader:a.Ba.prototype.getHeader});a.Ba.prototype.NB=function(){return this.Bg.YO?!0:!1};a.a.b("OAuth.prototype.isInitialized",
{NB:a.Ba.prototype.NB});a.Ba.prototype.ls=function(){var d={},b=this;d[b.hf.XA]="Basic "+a.Ba.eF(b.hf.client_id+":"+b.hf.client_secret);e.ajax({type:"POST",async:!1,url:this.hf.bearer_url,data:"grant_type\x3dclient_credentials",headers:d,success:function(c){a.Ba.sk(b.Bg,c)},error:function(a){throw Error(a.responseText);}})};a.a.b("OAuth.prototype.clientCredentialGrant",{ls:a.Ba.prototype.ls});a.Ba.prototype.hC=function(d){a.Ba.sk(this.Bg,d)};a.a.b("OAuth.prototype.setAccessTokenResponse",{hC:a.Ba.prototype.hC});
a.Ba.prototype.mB=o_c("Bg");a.a.b("OAuth.prototype.getAccessTokenResponse",{mB:a.Ba.prototype.mB});a.Ba.prototype.$A=function(){a.Ba.Gv(this.Bg)};a.a.b("OAuth.prototype.cleanAccessTokenResponse",{$A:a.Ba.prototype.$A});a.Ba.prototype.gC=function(d){a.Ba.sk(this.hf,d)};a.a.b("OAuth.prototype.setAccessTokenRequest",{gC:a.Ba.prototype.gC});a.Ba.prototype.lB=o_c("hf");a.a.b("OAuth.prototype.getAccessTokenRequest",{lB:a.Ba.prototype.lB});a.Ba.prototype.ZA=function(){a.Ba.Gv(this.hf)};a.a.b("OAuth.prototype.cleanAccessTokenRequest",
{ZA:a.Ba.prototype.ZA});a.Ba._init=function(d,b,c){d.h();d.hf={};d.Bg={};b.access_token?a.Ba.sk(d.Bg,b):b.client_id&&(b.client_secret&&b.bearer_url)&&a.Ba.sk(d.hf,b);d.hf.XA=c};a.Ba.sk=function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};a.Ba.Gv=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};a.Ba.eF=function(a){var b,c,f,h,g=0,e=0,k=[];do b=a.charCodeAt(g++),c=a.charCodeAt(g++),f=a.charCodeAt(g++),h=b<<16|c<<8|f,b=h>>18&63,c=h>>12&63,f=h>>6&63,h&=63,k[e++]=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(h);while(g<a.length);k=k.join("");b=a.length%3;return(b?k.slice(0,b-3):k)+"\x3d\x3d\x3d".slice(b||3)}});
//# sourceMappingURL=oj-modular.map